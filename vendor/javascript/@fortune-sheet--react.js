import{defaultContext as e,defaultSettings as t,getSheetIndex as n,colLocationByIndex as l,fixPositionOnFrozenCells as o,colLocation as a,getFlowdata as r,isAllowEdit as i,handleColumnHeaderMouseDown as c,handleColSizeHandleMouseDown as u,handleColFreezeHandleMouseDown as s,handleContextMenu as d,selectTitlesMap as v,selectTitlesRange as m,fixColumnStyleOverflowInFreeze as f,rowLocationByIndex as h,rowLocation as p,handleRowHeaderMouseDown as y,handleRowSizeHandleMouseDown as g,handleRowFreezeHandleMouseDown as k,fixRowStyleOverflowInFreeze as E,locale as C,getStyleByCell as b,getCellValue as w,createRangeHightlight as x,isInlineStringCell as _,getInlineStringHTML as N,valueShowEs as M,escapeScriptTag as R,escapeHTMLTag as L,moveToEnd as S,isShowHidenCR as V,cancelNormalSelected as H,moveHighlightCell as T,updateCell as D,israngeseleciton as I,handleFormulaInput as z,onSearchDialogMoveStart as A,replaceAll as B,replace as F,searchAll as W,searchNext as P,normalizeSelection as O,scrollToHighlightCell as U,isLinkValid as j,getRangetxt as K,goToLink as Z,replaceHtml as q,removeHyperlink as X,onRangeSelectionModalMoveStart as Y,saveHyperlink as G,createFilterOptions as $,onImageMoveStart as J,onImageResizeStart as Q,showComments as ee,setEditingComment as te,onCommentBoxMoveStart as ne,onCommentBoxResizeStart as le,confirmMessage as oe,getRangeByTxt as ae,getDropdownList as re,setCellValue as ie,setConditionRules as ce,mergeBorder as ue,setDropcownValue as se,handleCellAreaMouseDown as de,handleCellAreaDoubleClick as ve,selectAll as me,showLinkCard as fe,getCellRowColumn as he,getCellHyperlink as pe,handleOverlayMouseMove as ye,handleOverlayMouseUp as ge,handleKeydownForZoom as ke,handleOverlayTouchStart as Ee,handleOverlayTouchMove as Ce,handleOverlayTouchEnd as be,insertRowCol as we,drawArrow as xe,onCellsMoveStart as _e,createDropCellRange as Ne,updateContextWithSheetData as Me,updateContextWithCanvas as Re,initFreeze as Le,Canvas as Se,handleGlobalWheel as Ve,setCaretPosition as He,getDataArr as Te,updateMoreCell as De,getRegStr as Ie,getOptionValue as ze,getSelectRange as Ae,applyLocation as Be,updateItem as Fe,update as We,handleTextColor as Pe,handleTextBackground as Oe,normalizedCellAttr as Ue,updateFormat as je,handleTextSize as Ke,handleHorizontalAlign as Ze,handleVerticalAlign as qe,handleScreenShot as Xe,showImgChooser as Ye,insertImage as Ge,editComment as $e,deleteComment as Je,showHideComment as Qe,showHideAllComments as et,newComment as tt,handleSum as nt,autoSelectionFormula as lt,handleMerge as ot,handleBorder as at,handleFreeze as rt,handleSort as it,createFilter as ct,clearFilter as ut,toolbarItemSelectedFunc as st,toolbarItemClickHandler as dt,getInlineStringNoStyle as vt,rangeHightlightselected as mt,editSheetName as ft,cancelActiveImgItem as ht,MAX_ZOOM_RATIO as pt,MIN_ZOOM_RATIO as yt,addSheet as gt,indexToColumnChar as kt,sortSelection as Et,handleCopy as Ct,handlePasteByClick as bt,deleteRowCol as wt,hideSelected as xt,showSelected as _t,api as Nt,removeActiveImage as Mt,deleteSelectedCellText as Rt,jfrefreshgrid as Lt,handleLink as St,deleteSheet as Vt,opToPatch as Ht,orderbydatafiler as Tt,getFilterColumnValues as Dt,getFilterColumnColors as It,saveFilter as zt,groupValuesRefresh as At,calcSelectionInfo as Bt,patchToOp as Ft,filterPatch as Wt,inverseRowColOptions as Pt,ensureSheetIndex as Ot,initSheetIndex as Ut,handleGlobalKeyDown as jt,handlePaste as Kt}from"@fortune-sheet/core";import Zt,{useContext as qt,useRef as Xt,useState as Yt,useMemo as Gt,useCallback as $t,useEffect as Jt,useLayoutEffect as Qt,useImperativeHandle as en}from"react";import tn,{applyPatches as nn,enablePatches as ln,produceWithPatches as on}from"immer";import an from"lodash";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function asyncGeneratorStep(e,t,n,l,o,a,r){try{var i=e[a](r);var c=i.value}catch(e){n(e);return}i.done?t(c):Promise.resolve(c).then(l,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(l,o){var a=e.apply(t,n);function _next(e){asyncGeneratorStep(a,l,o,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(a,l,o,_next,_throw,"throw",e)}_next(void 0)}))}}function _defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true}):e[t]=n;return e}function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e};return _extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(e,t){if(e==null)return{};var n={};var l=Object.keys(e);var o,a;for(a=0;a<l.length;a++){o=l[a];t.indexOf(o)>=0||(n[o]=e[o])}return n}function _objectWithoutProperties(e,t){if(e==null)return{};var n=_objectWithoutPropertiesLoose(e,t);var l,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++){l=a[o];t.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(n[l]=e[l])}}return n}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _iterableToArrayLimit(e,t){var n=e==null?null:typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var l=[];var o=true;var a=false;var r,i;try{for(n=n.call(e);!(o=(r=n.next()).done);o=true){l.push(r.value);if(t&&l.length===t)break}}catch(e){a=true;i=e}finally{try{o||n.return==null||n.return()}finally{if(a)throw i}}return l}}function _unsupportedIterableToArray(e,t){if(e){if(typeof e==="string")return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);n==="Object"&&e.constructor&&(n=e.constructor.name);return n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var rn={globalCache:{undoList:[],redoList:[]},cellInput:Zt.createRef(),fxInput:Zt.createRef(),canvas:Zt.createRef(),cellArea:Zt.createRef(),workbookContainer:Zt.createRef()};var cn=Zt.createContext({context:e(rn),setContext:function setContext(){},settings:t,handleUndo:function handleUndo(){},handleRedo:function handleRedo(){},refs:{globalCache:{undoList:[],redoList:[]},cellInput:Zt.createRef(),fxInput:Zt.createRef(),canvas:Zt.createRef(),scrollbarX:Zt.createRef(),scrollbarY:Zt.createRef(),cellArea:Zt.createRef(),workbookContainer:Zt.createRef()}});var un=function SVGIcon(e){var t=e.width,n=t===void 0?24:t,l=e.height,o=l===void 0?24:l,a=e.name,r=e.style;return Zt.createElement("svg",{width:n,height:o,style:r},Zt.createElement("use",{xlinkHref:"#".concat(a)}))};var sn=function ColumnHeader(){var e;var t=qt(cn),h=t.context,p=t.setContext,y=t.settings,g=t.refs;var k=Xt(null);var E=Xt(null);var C=Yt({col:-1,col_pre:-1,col_index:-1}),b=_slicedToArray(C,2),w=b[0],x=b[1];var _=Yt(false),N=_slicedToArray(_,2),M=N[0],R=N[1];var L=Yt([]),S=_slicedToArray(L,2),V=S[0],H=S[1];var T=Xt(true);var D=n(h,h.currentSheetId);var I=D==null?null:h.luckysheetfile[D];var z=Gt((function(){var e,t,n,o;if((I===null||I===void 0||(e=I.frozen)===null||e===void 0?void 0:e.type)==="column"||(I===null||I===void 0||(t=I.frozen)===null||t===void 0?void 0:t.type)==="rangeColumn"||(I===null||I===void 0||(n=I.frozen)===null||n===void 0?void 0:n.type)==="rangeBoth"||(I===null||I===void 0||(o=I.frozen)===null||o===void 0?void 0:o.type)==="both"){var a,r;return l((I===null||I===void 0||(a=I.frozen)===null||a===void 0||(r=a.range)===null||r===void 0?void 0:r.column_focus)||0,h.visibledatacolumn)[1]-2+h.scrollLeft}return h.scrollLeft}),[h.visibledatacolumn,I===null||I===void 0?void 0:I.frozen,h.scrollLeft]);var A=$t((function(e){var t;if(!h.luckysheet_cols_change_size){var n=e.pageX-k.current.getBoundingClientRect().left-window.scrollX;var l=n+k.current.scrollLeft;var c=(t=g.globalCache.freezen)===null||t===void 0?void 0:t[h.currentSheetId];var u=o(c,l,0,n,0),s=u.x,d=u.inVerticalFreeze;var v=a(s,h.visibledatacolumn);var m=_slicedToArray(v,3),f=m[0],p=m[1],y=m[2];if(y!==w.col_index){x({col_pre:f,col:p,col_index:y});R(d)}var E=r(h);an.isNil(E)||(T.current=i(h)&&i(h,[{row:[0,E.length-1],column:v}]))}}),[h,w.col_index,g.globalCache.freezen]);var B=$t((function(e){var t=e.nativeEvent;p((function(e){c(e,g.globalCache,t,k.current,g.cellInput.current,g.fxInput.current)}))}),[g.globalCache,g.cellInput,g.fxInput,p]);var F=$t((function(){h.luckysheet_cols_change_size||x({col:-1,col_pre:-1,col_index:-1})}),[h.luckysheet_cols_change_size]);var W=$t((function(e){var t=e.nativeEvent;p((function(e){u(e,g.globalCache,t,k.current,g.workbookContainer.current,g.cellArea.current)}));e.stopPropagation()}),[g.cellArea,g.globalCache,g.workbookContainer,p]);var P=$t((function(e){var t=e.nativeEvent;p((function(e){s(e,g.globalCache,t,k.current,g.workbookContainer.current,g.cellArea.current)}));e.stopPropagation()}),[g.cellArea,g.globalCache,g.workbookContainer,p]);var O=$t((function(e){var t=e.nativeEvent;p((function(e){d(e,y,t,g.workbookContainer.current,g.cellArea.current,"columnHeader")}))}),[g.workbookContainer,p,y,g.cellArea]);Jt((function(){var e=h.luckysheet_select_save;if(!an.isNil(e)){var t={};for(var n=0;n<e.length;n+=1){var o=e[n].column[0];var a=e[n].column[1];t=v(t,o,a)}var r=m(t);var i=[];for(var c=0;c<r.length;c+=1){var u=r[c][0];var s=r[c][r[c].length-1];var d=l(s,h.visibledatacolumn)[1];var f=l(u,h.visibledatacolumn)[0];an.isNumber(d)&&an.isNumber(f)&&i.push({col:d,col_pre:f,c1:u,c2:s})}H(i)}}),[h.luckysheet_select_save,h.visibledatacolumn]);Jt((function(){k.current.scrollLeft=h.scrollLeft}),[h.scrollLeft]);return Zt.createElement("div",{ref:k,className:"fortune-col-header",style:{height:h.columnHeaderHeight-1.5},onMouseMove:A,onMouseDown:B,onMouseLeave:F,onContextMenu:O},Zt.createElement("div",{className:"fortune-cols-freeze-handle",onMouseDown:P,style:{left:z}}),Zt.createElement("div",{className:"fortune-cols-change-size",ref:E,id:"fortune-cols-change-size",onMouseDown:W,style:{left:w.col-5+(M?h.scrollLeft:0),opacity:h.luckysheet_cols_change_size?1:0}}),!h.luckysheet_cols_change_size&&w.col_index>=0?Zt.createElement("div",{className:"fortune-col-header-hover",style:an.assign({left:w.col_pre,width:w.col-w.col_pre-1,display:"block"},f(h,w.col_index,w.col_index,(e=g.globalCache.freezen)===null||e===void 0?void 0:e[h.currentSheetId]))},T.current&&Zt.createElement("span",{className:"header-arrow",onClick:function onClick(e){p((function(t){t.contextMenu={x:e.pageX,y:90,headerMenu:true}}))}},Zt.createElement(un,{name:"headDownArrow",width:12}))):null,V.map((function(e,t){var n;var l=e.col,o=e.col_pre,a=e.c1,r=e.c2;return Zt.createElement("div",{className:"fortune-col-header-selected",key:t,style:an.assign({left:o,width:l-o-1,display:"block",backgroundColor:"rgba(76, 76, 76, 0.1)"},f(h,a,r,(n=g.globalCache.freezen)===null||n===void 0?void 0:n[h.currentSheetId]))})})),Zt.createElement("div",{className:"luckysheet-cols-h-cells luckysheetsheetchange",id:"luckysheet-cols-h-cells_0",style:{width:h.ch_width,height:1}},Zt.createElement("div",{className:"luckysheet-cols-h-cells-c"},Zt.createElement("div",{className:"luckysheet-grdblkpush"}))))};var dn=function RowHeader(){var e;var t=qt(cn),l=t.context,a=t.setContext,r=t.settings,i=t.refs;var c=Xt(null);var u=Xt(null);var s=Yt({row:-1,row_pre:-1,row_index:-1}),f=_slicedToArray(s,2),C=f[0],b=f[1];var w=Yt(false),x=_slicedToArray(w,2),_=x[0],N=x[1];var M=Yt([]),R=_slicedToArray(M,2),L=R[0],S=R[1];var V=n(l,l.currentSheetId);var H=V==null?null:l.luckysheetfile[V];var T=Gt((function(){var e,t,n,o;if((H===null||H===void 0||(e=H.frozen)===null||e===void 0?void 0:e.type)==="row"||(H===null||H===void 0||(t=H.frozen)===null||t===void 0?void 0:t.type)==="rangeRow"||(H===null||H===void 0||(n=H.frozen)===null||n===void 0?void 0:n.type)==="rangeBoth"||(H===null||H===void 0||(o=H.frozen)===null||o===void 0?void 0:o.type)==="both"){var a,r;return h((H===null||H===void 0||(a=H.frozen)===null||a===void 0||(r=a.range)===null||r===void 0?void 0:r.row_focus)||0,l.visibledatarow)[1]+l.scrollTop}return l.scrollTop}),[l.visibledatarow,H===null||H===void 0?void 0:H.frozen,l.scrollTop]);var D=$t((function(e){var t;if(!l.luckysheet_rows_change_size){var n=e.pageY-u.current.getBoundingClientRect().top-window.scrollY;var a=n+u.current.scrollTop;var r=(t=i.globalCache.freezen)===null||t===void 0?void 0:t[l.currentSheetId];var c=o(r,0,a,0,n),s=c.y,d=c.inHorizontalFreeze;var v=p(s,l.visibledatarow);var m=_slicedToArray(v,3),f=m[0],h=m[1],y=m[2];if(f!==C.row_pre||h!==C.row){b({row_pre:f,row:h,row_index:y});N(d)}}}),[l.luckysheet_rows_change_size,l.visibledatarow,C.row,C.row_pre,i.globalCache.freezen,l.currentSheetId]);var I=$t((function(e){var t=e.nativeEvent;a((function(e){y(e,i.globalCache,t,u.current,i.cellInput.current,i.fxInput.current)}))}),[i.globalCache,i.cellInput,i.fxInput,a]);var z=$t((function(){l.luckysheet_rows_change_size||b({row:-1,row_pre:-1,row_index:-1})}),[l.luckysheet_rows_change_size]);var A=$t((function(e){var t=e.nativeEvent;a((function(e){g(e,i.globalCache,t,u.current,i.workbookContainer.current,i.cellArea.current)}));e.stopPropagation()}),[i.cellArea,i.globalCache,i.workbookContainer,a]);var B=$t((function(e){var t=e.nativeEvent;a((function(e){k(e,i.globalCache,t,u.current,i.workbookContainer.current,i.cellArea.current)}));e.stopPropagation()}),[i.cellArea,i.globalCache,i.workbookContainer,a]);var F=$t((function(e){var t=e.nativeEvent;a((function(e){d(e,r,t,i.workbookContainer.current,i.cellArea.current,"rowHeader")}))}),[i.workbookContainer,a,r,i.cellArea]);Jt((function(){var e=l.luckysheet_select_save||[];var t={};for(var n=0;n<e.length;n+=1){var o=e[n].row[0];var a=e[n].row[1];t=v(t,o,a)}var r=m(t);var i=[];for(var c=0;c<r.length;c+=1){var u=r[c][0];var s=r[c][r[c].length-1];var d=h(s,l.visibledatarow)[1];var f=h(u,l.visibledatarow)[0];an.isNumber(f)&&an.isNumber(d)&&i.push({row:d,row_pre:f,r1:u,r2:s})}S(i)}),[l.luckysheet_select_save,l.visibledatarow]);Jt((function(){u.current.scrollTop=l.scrollTop}),[l.scrollTop]);return Zt.createElement("div",{ref:u,className:"fortune-row-header",style:{width:l.rowHeaderWidth-1.5,height:l.cellmainHeight},onMouseMove:D,onMouseDown:I,onMouseLeave:z,onContextMenu:F},Zt.createElement("div",{className:"fortune-rows-freeze-handle",onMouseDown:B,style:{top:T}}),Zt.createElement("div",{className:"fortune-rows-change-size",ref:c,onMouseDown:A,style:{top:C.row-3+(_?l.scrollTop:0),opacity:l.luckysheet_rows_change_size?1:0}}),!l.luckysheet_rows_change_size&&C.row_index>=0?Zt.createElement("div",{className:"fortune-row-header-hover",style:an.assign({top:C.row_pre,height:C.row-C.row_pre-1,display:"block"},E(l,C.row_index,C.row_index,(e=i.globalCache.freezen)===null||e===void 0?void 0:e[l.currentSheetId]))}):null,L.map((function(e,t){var n;var o=e.row,a=e.row_pre,r=e.r1,c=e.r2;return Zt.createElement("div",{className:"fortune-row-header-selected",key:t,style:an.assign({top:a,height:o-a-1,display:"block",backgroundColor:"rgba(76, 76, 76, 0.1)"},E(l,r,c,(n=i.globalCache.freezen)===null||n===void 0?void 0:n[l.currentSheetId]))})})),Zt.createElement("div",{style:{height:l.rh_height,width:1},id:"luckysheetrowHeader_0",className:"luckysheetsheetchange"}))};var vn=function ContentEditable(e){var t=_extends({},e);var n=Xt("");var l=Xt(null);var o=t.autoFocus,a=t.initialContent,r=t.onChange;Jt((function(){if(o){var e;(e=l.current)===null||e===void 0?void 0:e.focus()}}),[o]);Jt((function(){a&&l.current!=null&&(l.current.innerHTML=a)}),[a]);var i=$t((function(e,t){var o;l.current!=null&&(o=l.current.innerHTML);r&&o!==n.current&&r(o||"",t);n.current=o||""}),[l,r]);var c=t.innerRef,u=t.onBlur;var s=t.allowEdit;an.isNil(s)&&(s=true);return Zt.createElement("div",_objectSpread2(_objectSpread2({onDoubleClick:function onDoubleClick(e){return e.stopPropagation()},onClick:function onClick(e){return e.stopPropagation()}},an.omit(t,"innerRef","onChange","html","onBlur","autoFocus","allowEdit","initialContent")),{},{ref:function ref(e){l.current=e;c===null||c===void 0?void 0:c(e)},tabIndex:0,onInput:i,onBlur:function onBlur(e){i(null,true);u===null||u===void 0?void 0:u(e)},contentEditable:s}))};var mn=function FormulaSearch(e){var t=qt(cn),n=t.context;return an.isEmpty(n.functionCandidates)?null:Zt.createElement("div",_objectSpread2(_objectSpread2({},e),{},{id:"luckysheet-formula-search-c",className:"luckysheet-formula-search-c"}),n.functionCandidates.map((function(e){return Zt.createElement("div",{key:e.n,"data-func":e.n,className:"luckysheet-formula-search-item"},Zt.createElement("div",{className:"luckysheet-formula-search-func"},e.n),Zt.createElement("div",{className:"luckysheet-formula-search-detail"},e.d))})))};var fn=function FormulaHint(e){var t=qt(cn),n=t.context;var l=C(n),o=l.formulaMore;if(!n.functionHint)return null;var a=n.formulaCache.functionlistMap[n.functionHint];return a?Zt.createElement("div",_objectSpread2(_objectSpread2({},e),{},{id:"luckysheet-formula-help-c",className:"luckysheet-formula-help-c"}),Zt.createElement("div",{className:"luckysheet-formula-help-close",title:"关闭"},Zt.createElement("i",{className:"fa fa-times","aria-hidden":"true"})),Zt.createElement("div",{className:"luckysheet-formula-help-collapse",title:"收起"},Zt.createElement("i",{className:"fa fa-angle-up","aria-hidden":"true"})),Zt.createElement("div",{className:"luckysheet-formula-help-title"},Zt.createElement("div",{className:"luckysheet-formula-help-title-formula"},Zt.createElement("span",{className:"luckysheet-arguments-help-function-name"},a.n),Zt.createElement("span",{className:"luckysheet-arguments-paren"},"("),Zt.createElement("span",{className:"luckysheet-arguments-parameter-holder"},a.p.map((function(e,t){var n=e.name;e.repeat==="y"&&(n+=", ...");e.require==="o"&&(n="[".concat(n,"]"));return Zt.createElement("span",{className:"luckysheet-arguments-help-parameter",dir:"auto",key:n},n,t!==a.p.length-1&&", ")}))),Zt.createElement("span",{className:"luckysheet-arguments-paren"},")"))),Zt.createElement("div",{className:"luckysheet-formula-help-content"},Zt.createElement("div",{className:"luckysheet-formula-help-content-example"},Zt.createElement("div",{className:"luckysheet-arguments-help-section-title"},o.helpExample),Zt.createElement("div",{className:"luckysheet-arguments-help-formula"},Zt.createElement("span",{className:"luckysheet-arguments-help-function-name"},a.n),Zt.createElement("span",{className:"luckysheet-arguments-paren"},"("),Zt.createElement("span",{className:"luckysheet-arguments-parameter-holder"},a.p.map((function(e,t){return Zt.createElement("span",{key:e.name,className:"luckysheet-arguments-help-parameter",dir:"auto"},e.example,t!==a.p.length-1&&", ")}))),Zt.createElement("span",{className:"luckysheet-arguments-paren"},")"))),Zt.createElement("div",{className:"luckysheet-formula-help-content-detail"},Zt.createElement("div",{className:"luckysheet-arguments-help-section"},Zt.createElement("div",{className:"luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name"},o.helpAbstract),Zt.createElement("span",{className:"luckysheet-arguments-help-parameter-content"},a.d))),Zt.createElement("div",{className:"luckysheet-formula-help-content-param"},a.p.map((function(e){return Zt.createElement("div",{className:"luckysheet-arguments-help-section",key:e.name},Zt.createElement("div",{className:"luckysheet-arguments-help-section-title"},e.name,e.repeat==="y"&&Zt.createElement("span",{className:"luckysheet-arguments-help-argument-info"},"...-",o.allowRepeatText),e.require==="o"&&Zt.createElement("span",{className:"luckysheet-arguments-help-argument-info"},"-[",o.allowOptionText,"]")),Zt.createElement("span",{className:"luckysheet-arguments-help-parameter-content"},e.detail))})))),Zt.createElement("div",{className:"luckysheet-formula-help-foot"})):null};function usePrevious(e){var t=Xt();Jt((function(){t.current=e}),[e]);return t.current}var hn=function InputBox(){var e,t;var n=qt(cn),l=n.context,o=n.setContext,a=n.refs;var c=Xt(null);var u=Xt();var s=usePrevious(l.luckysheetCellUpdate);var d=usePrevious(l.currentSheetId);var v=Yt(false),m=_slicedToArray(v,2),f=m[0],h=m[1];var p=(e=l.luckysheet_select_save)===null||e===void 0?void 0:e[0];var y=p===null||p===void 0?void 0:p.row_focus;var g=p===null||p===void 0?void 0:p.column_focus;var k=Xt("");var E=Gt((function(){if(p&&l.luckysheetCellUpdate.length>0){var e=r(l);return e?b(l,e,p.row_focus,p.column_focus):{}}return{}}),[l.luckysheetfile,l.currentSheetId,l.luckysheetCellUpdate,p]);Qt((function(){l.allowEdit||o((function(e){var t=r(e);if(!an.isNil(t)&&e.forceFormulaRef){var n=w(y,g,t,"f");x(e,n)}}));if(p&&l.luckysheetCellUpdate.length>0){var e;if(a.globalCache.doNotUpdateCell){delete a.globalCache.doNotUpdateCell;return}if(an.isEqual(s,l.luckysheetCellUpdate)&&d===l.currentSheetId)return;var t=r(l);var n=t===null||t===void 0||(e=t[y])===null||e===void 0?void 0:e[g];var i="";if(n&&!a.globalCache.overwriteCell)if(_(n))i=N(y,g,t);else if(n.f){i=w(y,g,t,"f");o((function(e){x(e,i)}))}else{i=M(y,g,t);Number(n.qp)===1&&(i=i?"".concat(i):i)}a.globalCache.overwriteCell=false;a.globalCache.ignoreWriteCell||(c.current.innerHTML=L(R(i)));a.globalCache.ignoreWriteCell=false;a.globalCache.doNotFocus||setTimeout((function(){S(c.current)}));delete a.globalCache.doNotFocus}}),[l.luckysheetCellUpdate,l.luckysheetfile,l.currentSheetId,p]);Jt((function(){an.isEmpty(l.luckysheetCellUpdate)&&c.current&&(c.current.innerHTML="")}),[l.luckysheetCellUpdate]);Jt((function(){h(V(l))}),[l.luckysheet_select_save]);var C=$t((function(e){u.current=new KeyboardEvent(e.type,e.nativeEvent);k.current=c.current.innerText;if(e.key==="Escape"&&l.luckysheetCellUpdate.length>0){o((function(e){H(e);T(e,"down",0,"rangeOfSelect")}));e.preventDefault()}else if(e.key==="Enter"&&l.luckysheetCellUpdate.length>0){if(e.altKey||e.metaKey){document.execCommand("insertHTML",false,"\n ");document.execCommand("delete",false);e.stopPropagation()}}else if(e.key==="Tab"&&l.luckysheetCellUpdate.length>0){o((function(e){D(e,e.luckysheetCellUpdate[0],e.luckysheetCellUpdate[1],a.cellInput.current);T(e,"right",1,"rangeOfSelect")}));e.preventDefault();e.stopPropagation()}else e.key==="F4"&&l.luckysheetCellUpdate.length>0&&e.preventDefault()}),[l.luckysheetCellUpdate.length,a.cellInput,o]);var A=$t((function(e,t){var n=u.current;if(n){var l=n.keyCode;l&&(!(l>=112&&l<=123||l<=46||l===144||l===108||n.ctrlKey||n.altKey||n.shiftKey&&(l===37||l===38||l===39||l===40))||l===8||l===32||l===46||n.ctrlKey&&l===86)&&o((function(e){(e.formulaCache.rangestart||e.formulaCache.rangedrag_column_start||e.formulaCache.rangedrag_row_start||I(e))&&t||i(e,e.luckysheet_select_save)&&z(e,a.fxInput.current,a.cellInput.current,l,k.current)}))}}),[a.cellInput,a.fxInput,o]);var B=$t((function(e){an.isEmpty(l.luckysheetCellUpdate)&&e.preventDefault()}),[l.luckysheetCellUpdate]);var F=l.config||{};var W=F.rowReadOnly||{};var P=F.colReadOnly||{};var O=!((P[g]||W[y])&&l.allowEdit===true);return Zt.createElement("div",{className:"luckysheet-input-box",style:p&&!((t=l.rangeDialog)===null||t===void 0?void 0:t.show)?{left:p.left,top:p.top,zIndex:an.isEmpty(l.luckysheetCellUpdate)?-1:19,display:"block"}:{left:-1e4,top:-1e4,display:"block"},onMouseDown:function onMouseDown(e){return e.stopPropagation()},onMouseUp:function onMouseUp(e){return e.stopPropagation()}},Zt.createElement("div",{className:"luckysheet-input-box-inner",style:p?_objectSpread2({minWidth:p.width,minHeight:p.height},E):{}},Zt.createElement(vn,{innerRef:function innerRef(e){c.current=e;a.cellInput.current=e},className:"luckysheet-cell-input",id:"luckysheet-rich-text-editor",style:{transform:"scale(".concat(l.zoomRatio,")"),transformOrigin:"left top",width:"".concat(100/l.zoomRatio,"%"),height:"".concat(100/l.zoomRatio,"%")},"aria-autocomplete":"list",onChange:A,onKeyDown:C,onPaste:B,allowEdit:O?!f:O})),document.activeElement===c.current&&Zt.createElement(Zt.Fragment,null,Zt.createElement(mn,{style:{top:((p===null||p===void 0?void 0:p.height_move)||0)+4}}),Zt.createElement(fn,{style:{top:((p===null||p===void 0?void 0:p.height_move)||0)+4}})))};var pn=function ScrollBar(e){var t=e.axis;var n=qt(cn),l=n.context,o=n.refs,a=n.setContext;Jt((function(){t==="x"?o.scrollbarX.current.scrollLeft=l.scrollLeft:o.scrollbarY.current.scrollTop=l.scrollTop}),[t==="x"?l.scrollLeft:l.scrollTop]);return Zt.createElement("div",{ref:t==="x"?o.scrollbarX:o.scrollbarY,style:t==="x"?{left:l.rowHeaderWidth,width:"calc(100% - ".concat(l.rowHeaderWidth,"px)")}:{height:"100%"},className:"luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-".concat(t),onScroll:function onScroll(){a(t==="x"?function(e){e.scrollLeft=o.scrollbarX.current.scrollLeft}:function(e){e.scrollTop=o.scrollbarY.current.scrollTop})}},Zt.createElement("div",{style:t==="x"?{width:l.ch_width,height:10}:{width:10,height:l.rh_height}}))};var yn=function Dialog(e){var t=e.type,n=e.onOk,l=e.onCancel,o=e.children,a=e.containerStyle,r=e.contentStyle;var i=qt(cn),c=i.context;var u=C(c),s=u.button;return Zt.createElement("div",{className:"fortune-dialog",style:a},Zt.createElement("div",{className:"fortune-modal-dialog-header"},Zt.createElement("div",{className:"fortune-modal-dialog-icon-close",onClick:l},Zt.createElement(un,{name:"close",style:{padding:7,cursor:"pointer"}}))),Zt.createElement("div",{className:"fortune-dialog-box-content",style:r},o),t!=null&&Zt.createElement("div",{className:"fortune-dialog-box-button-container"},t==="ok"?Zt.createElement("div",{className:"fortune-message-box-button button-default",onClick:n},s.confirm):Zt.createElement(Zt.Fragment,null,Zt.createElement("div",{className:"fortune-message-box-button button-primary",onClick:n},s.confirm),Zt.createElement("div",{className:"fortune-message-box-button button-default",onClick:l},s.cancel))))};var gn=function MessageBox(e){var t=e.type,n=t===void 0?"yesno":t,l=e.onOk,o=e.onCancel,a=e.children;return Zt.createElement(yn,{type:n,onOk:l,onCancel:o,contentStyle:{width:300,paddingTop:20,paddingBottom:30,display:"flex",justifyContent:"center",alignItems:"center"}},a)};var kn=Zt.createContext({component:null,showModal:function showModal(){},hideModal:function hideModal(){}});var En=function ModalProvider(e){var t=e.children;var n=Yt(null),l=_slicedToArray(n,2),o=l[0],a=l[1];var r=$t((function(e){a(e)}),[]);var i=$t((function(){a(null)}),[]);var c=Gt((function(){return{component:null,showModal:r,hideModal:i}}),[i,r]);return Zt.createElement(kn.Provider,{value:c},t,o&&Zt.createElement("div",{onMouseDown:function onMouseDown(e){return e.stopPropagation()},onMouseMove:function onMouseMove(e){return e.stopPropagation()},onMouseUp:function onMouseUp(e){return e.stopPropagation()},onContextMenu:function onContextMenu(e){return e.stopPropagation()},className:"fortune-popover-backdrop fortune-modal-container"},o))};function useAlert(){var e=qt(kn),t=e.showModal,n=e.hideModal;var l=$t((function(e){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ok";var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;t(Zt.createElement(gn,{type:l,onOk:o,onCancel:a},e))}),[n,t]);return{showAlert:l,hideAlert:n}}var Cn=function SearchReplace(e){var t=e.getContainer;var n=qt(cn),l=n.context,o=n.setContext,a=n.refs;var r=C(l),i=r.findAndReplace,c=r.button;var u=Yt(""),s=_slicedToArray(u,2),d=s[0],v=s[1];var m=Yt(""),f=_slicedToArray(m,2),h=f[0],p=f[1];var y=Yt(l.showReplace),g=_slicedToArray(y,2),k=g[0],E=g[1];var b=Yt([]),w=_slicedToArray(b,2),x=w[0],_=w[1];var N=Yt(),M=_slicedToArray(N,2),R=M[0],L=M[1];var S=useAlert(),V=S.showAlert;var H=Yt({regCheck:false,wordCheck:false,caseCheck:false}),T=_slicedToArray(H,2),D=T[0],I=T[1];var z=$t((function(){an.set(a.globalCache,"searchDialog.mouseEnter",false);o((function(e){e.showSearch=false;e.showReplace=false}))}),[a.globalCache,o]);var j=$t((function(e,t){return I(tn((function(n){an.set(n,e,t)})))}),[]);var K=$t((function(e){var t=e.getBoundingClientRect();return{left:(t.width-500)/2,top:(t.height-200)/3}}),[]);return Zt.createElement("div",{id:"fortune-search-replace",className:"fortune-search-replace fortune-dialog",style:K(t()),onMouseEnter:function onMouseEnter(){an.set(a.globalCache,"searchDialog.mouseEnter",true)},onMouseLeave:function onMouseLeave(){an.set(a.globalCache,"searchDialog.mouseEnter",false)},onMouseDown:function onMouseDown(e){var n=e.nativeEvent;A(a.globalCache,n,t());e.stopPropagation()}},Zt.createElement("div",{className:"container",onMouseDown:function onMouseDown(e){return e.stopPropagation()}},Zt.createElement("div",{className:"icon-close fortune-modal-dialog-icon-close",onClick:z},Zt.createElement(un,{name:"close",style:{padding:7,cursor:"pointer"}})),Zt.createElement("div",{className:"tabBox"},Zt.createElement("span",{id:"searchTab",className:k?"":"on",onClick:function onClick(){return E(false)}},i.find),Zt.createElement("span",{id:"replaceTab",className:k?"on":"",onClick:function onClick(){return E(true)}},i.replace)),Zt.createElement("div",{className:"ctBox"},Zt.createElement("div",{className:"row"},Zt.createElement("div",{className:"inputBox"},Zt.createElement("div",{className:"textboxs",id:"searchInput"},i.findTextbox,"：",Zt.createElement("input",{className:"formulaInputFocus",autoFocus:true,spellCheck:"false",onKeyDown:function onKeyDown(e){return e.stopPropagation()},value:d,onChange:function onChange(e){return v(e.target.value)}})),k&&Zt.createElement("div",{className:"textboxs",id:"replaceInput"},i.replaceTextbox,"：",Zt.createElement("input",{className:"formulaInputFocus",spellCheck:"false",onKeyDown:function onKeyDown(e){return e.stopPropagation()},value:h,onChange:function onChange(e){return p(e.target.value)}}))),Zt.createElement("div",{className:"checkboxs"},Zt.createElement("div",{id:"regCheck"},Zt.createElement("input",{type:"checkbox",onChange:function onChange(e){return j("regCheck",e.target.checked)}}),Zt.createElement("span",null,i.regexTextbox)),Zt.createElement("div",{id:"wordCheck"},Zt.createElement("input",{type:"checkbox",onChange:function onChange(e){return j("wordCheck",e.target.checked)}}),Zt.createElement("span",null,i.wholeTextbox)),Zt.createElement("div",{id:"caseCheck"},Zt.createElement("input",{type:"checkbox",onChange:function onChange(e){return j("caseCheck",e.target.checked)}}),Zt.createElement("span",null,i.distinguishTextbox)))),Zt.createElement("div",{className:"btnBox"},k&&Zt.createElement(Zt.Fragment,null,Zt.createElement("div",{id:"replaceAllBtn",className:"fortune-message-box-button button-default",onClick:function onClick(){o((function(e){L(void 0);var t=B(e,d,h,D);V(t)}))}},i.allReplaceBtn),Zt.createElement("div",{id:"replaceBtn",className:"fortune-message-box-button button-default",onClick:function onClick(){return o((function(e){L(void 0);var t=F(e,d,h,D);t!=null&&V(t)}))}},i.replaceBtn)),Zt.createElement("div",{id:"searchAllBtn",className:"fortune-message-box-button button-default",onClick:function onClick(){return o((function(e){L(void 0);if(d){var t=W(e,d,D);_(t);an.isEmpty(t)&&V(i.noFindTip)}}))}},i.allFindBtn),Zt.createElement("div",{id:"searchNextBtn",className:"fortune-message-box-button button-default",onClick:function onClick(){return o((function(e){_([]);var t=P(e,d,D);t!=null&&V(t)}))}},i.findBtn))),Zt.createElement("div",{className:"close-button fortune-message-box-button button-default",onClick:z},c.close),x.length>0&&Zt.createElement("div",{id:"searchAllbox"},Zt.createElement("div",{className:"boxTitle"},Zt.createElement("span",null,i.searchTargetSheet),Zt.createElement("span",null,i.searchTargetCell),Zt.createElement("span",null,i.searchTargetValue)),Zt.createElement("div",{className:"boxMain"},x.map((function(e){return Zt.createElement("div",{className:"boxItem ".concat(an.isEqual(R,{r:e.r,c:e.c})?"on":""),key:e.cellPosition,onClick:function onClick(){o((function(t){t.luckysheet_select_save=O(t,[{row:[e.r,e.r],column:[e.c,e.c]}]);U(t,e.r,e.c)}));L({r:e.r,c:e.c})}},Zt.createElement("span",null,e.sheetName),Zt.createElement("span",null,e.cellPosition),Zt.createElement("span",null,e.value))}))))))};var bn=function LinkEditCard(e){var t=e.r,n=e.c,l=e.rc,o=e.originText,a=e.originType,r=e.originAddress,i=e.isEditing,c=e.position,u=e.selectingCellRange;var s=qt(cn),d=s.context,v=s.setContext,m=s.refs;var f=Yt(o),h=_slicedToArray(f,2),p=h[0],y=h[1];var g=Yt(r),k=_slicedToArray(g,2),E=k[0],b=k[1];var w=Yt(a),x=_slicedToArray(w,2),_=x[0],N=x[1];var M=C(d),R=M.insertLink,L=M.linkTypeList,S=M.button;var V=Xt(O(d,[{row:[t,t],column:[n,n]}]));var H=Xt(true);var T=j(d,_,E);var D=Zt.createElement("div",{className:"validation-input-tip"},T.tooltip);var I=$t((function(){an.set(m.globalCache,"linkCard.mouseEnter",false);v((function(e){e.linkCard=void 0}))}),[m.globalCache,v]);var z=$t((function(e){return v((function(t){t.luckysheet_select_save=V.current;t.linkCard!=null&&(t.linkCard.selectingCellRange=e)}))}),[v]);var A=Gt((function(){return{onMouseEnter:function onMouseEnter(){return an.set(m.globalCache,"linkCard.mouseEnter",true)},onMouseLeave:function onMouseLeave(){return an.set(m.globalCache,"linkCard.mouseEnter",false)},onMouseDown:function onMouseDown(e){return e.stopPropagation()},onMouseMove:function onMouseMove(e){return e.stopPropagation()},onMouseUp:function onMouseUp(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},onDoubleClick:function onDoubleClick(e){return e.stopPropagation()}}}),[m.globalCache]);var B=$t((function(e,t){return Zt.createElement("div",{className:"button-group"},Zt.createElement("div",{className:"button-basic button-default",onClick:t},S.cancel),Zt.createElement("div",{className:"button-basic button-primary",onClick:e},S.confirm))}),[S]);var F=$t((function(e,t){return Zt.createElement("div",{className:"fortune-toolbar-button",onClick:t},Zt.createElement(un,{name:e,style:{width:18,height:18}}))}),[]);Qt((function(){b(r);y(o);N(a)}),[l,r,o,a]);Qt((function(){u&&(H.current=true)}),[u]);Qt((function(){if(H.current)H.current=false;else if(u){var e=an.size(d.luckysheet_select_save);e>0&&b(K(d,d.currentSheetId,d.luckysheet_select_save[e-1],""))}}),[d,u]);return i?u?Zt.createElement("div",_objectSpread2(_objectSpread2({className:"fortune-link-modify-modal range-selection-modal",style:{left:c.cellLeft,top:c.cellBottom+5}},an.omit(A,["onMouseDown","onMouseMove","onMouseUp"])),{},{onMouseDown:function onMouseDown(e){var t=e.nativeEvent;Y(d,m.globalCache,t);e.stopPropagation()}}),Zt.createElement("div",{className:"modal-icon-close",onClick:function onClick(){return z(false)}},Zt.createElement(un,{name:"close"})),Zt.createElement("div",{className:"modal-title"},R.selectCellRange),Zt.createElement("input",_objectSpread2(_objectSpread2({},A),{},{className:"range-selection-input ".concat(!E||T.isValid?"":"error-input"),placeholder:R.cellRangePlaceholder,onChange:function onChange(e){return b(e.target.value)},value:E})),D,Zt.createElement("div",{className:"modal-footer"},B((function(){T.isValid&&z(false)}),(function(){b(r);z(false)})))):Zt.createElement("div",_objectSpread2({className:"fortune-link-modify-modal",style:{left:c.cellLeft+20,top:c.cellBottom}},A),Zt.createElement("div",{className:"fortune-link-modify-line"},Zt.createElement("div",{className:"fortune-link-modify-title"},R.linkText),Zt.createElement("input",{className:"fortune-link-modify-input",spellCheck:"false",autoFocus:true,value:p,onChange:function onChange(e){return y(e.target.value)}})),Zt.createElement("div",{className:"fortune-link-modify-line"},Zt.createElement("div",{className:"fortune-link-modify-title"},R.linkType),Zt.createElement("select",{className:"fortune-link-modify-select",value:_,onChange:function onChange(e){if(e.target.value==="sheet"){p||y(d.luckysheetfile[0].name);b(d.luckysheetfile[0].name)}else b("");e.target.value==="cellrange"&&z(true);N(e.target.value)}},L.map((function(e){return Zt.createElement("option",{key:e.value,value:e.value},e.text)})))),Zt.createElement("div",{className:"fortune-link-modify-line"},_==="webpage"&&Zt.createElement(Zt.Fragment,null,Zt.createElement("div",{className:"fortune-link-modify-title"},R.linkAddress),Zt.createElement("input",{className:"fortune-link-modify-input ".concat(!E||T.isValid?"":"error-input"),spellCheck:"false",value:E,onChange:function onChange(e){return b(e.target.value)}}),D),_==="cellrange"&&Zt.createElement(Zt.Fragment,null,Zt.createElement("div",{className:"fortune-link-modify-title"},R.linkCell),Zt.createElement("input",{className:"fortune-link-modify-input ".concat(!E||T.isValid?"":"error-input"),spellCheck:"false",value:E,onChange:function onChange(e){return b(e.target.value)}}),Zt.createElement("div",{className:"fortune-link-modify-cell-selector",onClick:function onClick(){return z(true)}},Zt.createElement(un,{name:"border-all"})),D),_==="sheet"&&Zt.createElement(Zt.Fragment,null,Zt.createElement("div",{className:"fortune-link-modify-title"},R.linkSheet),Zt.createElement("select",{className:"fortune-link-modify-select",onChange:function onChange(e){p||y(e.target.value);b(e.target.value)},value:E},d.luckysheetfile.map((function(e){return Zt.createElement("option",{key:e.id,value:e.name},e.name)}))),D)),Zt.createElement("div",{className:"modal-footer"},B((function(){if(T.isValid){an.set(m.globalCache,"linkCard.mouseEnter",false);v((function(e){return G(e,t,n,p,_,E)}))}}),I))):Zt.createElement("div",_objectSpread2(_objectSpread2({},A),{},{onKeyDown:function onKeyDown(e){e.stopPropagation()},className:"fortune-link-modify-modal link-toolbar",style:{left:c.cellLeft+20,top:c.cellBottom}}),Zt.createElement("div",{className:"link-content",onClick:function onClick(){v((function(e){return Z(e,t,n,_,E,m.scrollbarX.current,m.scrollbarY.current)}))}},_==="webpage"?R.openLink:q(R.goTo,{linkAddress:E})),d.allowEdit===true&&Zt.createElement("div",{className:"divider"}),d.allowEdit===true&&_==="webpage"&&F("copy",(function(){navigator.clipboard.writeText(r);I()})),d.allowEdit===true&&F("pencil",(function(){return v((function(e){e.linkCard!=null&&e.allowEdit&&(e.linkCard.isEditing=true)}))})),d.allowEdit===true&&Zt.createElement("div",{className:"divider"}),d.allowEdit===true&&F("unlink",(function(){return v((function(e){an.set(m.globalCache,"linkCard.mouseEnter",false);X(e,t,n)}))})))};var wn=function FilterOptions(e){var t,l;var o=e.getContainer;var a=qt(cn),r=a.context,i=a.setContext,c=a.refs;var u=r.filterOptions,s=r.currentSheetId,d=r.filter,v=r.visibledatarow,m=r.visibledatacolumn;var h=n(r,r.currentSheetId);var p=r.luckysheetfile[h],y=p.filter_select,g=p.frozen;Jt((function(){i((function(e){var t=n(e,e.currentSheetId);if(t!=null){e.luckysheet_filter_save=e.luckysheetfile[t].filter_select;e.filter=e.luckysheetfile[t].filter||{};$(e,e.luckysheet_filter_save,void 0)}}))}),[v,m,i,s,y]);var k=$t((function(e,t){u!=null&&i((function(n){var l,o;((l=n.filterContextMenu)===null||l===void 0?void 0:l.col)!==u.startCol+t&&(n.filterContextMenu={x:e.left+n.rowHeaderWidth-c.scrollbarX.current.scrollLeft,y:e.top+23+n.toolbarHeight+n.calculatebarHeight+n.columnHeaderHeight-c.scrollbarY.current.scrollTop,col:u.startCol+t,startRow:u.startRow,endRow:u.endRow,startCol:u.startCol,endCol:u.endCol,hiddenRows:an.keys((o=n.filter[t])===null||o===void 0?void 0:o.rowhidden).map((function(e){return parseInt(e,10)})),listBoxMaxHeight:400})}))}),[u,o,c.scrollbarX,c.scrollbarY,c.workbookContainer,i]);var C=g===null||g===void 0?void 0:g.type;var b=-1;var w=-1;if(C==="row")w=0;else if(C==="column")b=0;else if(C==="both"){b=0;w=0}else{var x,_;b=(g===null||g===void 0||(x=g.range)===null||x===void 0?void 0:x.column_focus)||-1;w=(g===null||g===void 0||(_=g.range)===null||_===void 0?void 0:_.row_focus)||-1}return u==null?Zt.createElement("div",null):Zt.createElement(Zt.Fragment,null,Zt.createElement("div",{id:"luckysheet-filter-selected-sheet",className:"luckysheet-cell-selected luckysheet-filter-selected",style:an.assign({left:u.left,width:u.width,top:u.top,height:u.height,display:"block"},E(r,u.startRow,u.endRow,(t=c.globalCache.freezen)===null||t===void 0?void 0:t[r.currentSheetId]),f(r,u.startCol,u.endCol,(l=c.globalCache.freezen)===null||l===void 0?void 0:l[r.currentSheetId]))}),u.items.map((function(e,t){var n,l;var o=d[t];var a=f(r,t+u.startCol,t+u.startCol,(n=c.globalCache.freezen)===null||n===void 0?void 0:n[r.currentSheetId]);var i=E(r,u.startRow,u.startRow,(l=c.globalCache.freezen)===null||l===void 0?void 0:l[r.currentSheetId]);var s=m[e.col];var v=e.col>0?m[e.col-1]:0;var h=e.col<=b&&a.left?a.left+s-v-20:e.left;var p=u.startRow<=w&&i.top?i.top:e.top;var y=_objectSpread2(_objectSpread2({},e),{},{left:h,top:p});return Zt.createElement("div",{onMouseDown:function onMouseDown(e){return e.stopPropagation()},onClick:function onClick(e){e.stopPropagation();k(y,t)},onDoubleClick:function onDoubleClick(e){return e.stopPropagation()},key:t,style:an.assign(i,a,{left:h,top:p,height:void 0,width:void 0}),className:"luckysheet-filter-options ".concat(o==null?"":"luckysheet-filter-options-active")},o==null?Zt.createElement("div",{className:"caret down"}):Zt.createElement(un,{name:"filter-fill-white",style:{width:15,height:15}}))})))};var xn=function ImgBoxs(){var e;var t=qt(cn),n=t.context,l=t.setContext,o=t.refs;var a=Gt((function(){return an.find(n.insertedImgs,{id:n.activeImg})}),[n.activeImg,n.insertedImgs]);return Zt.createElement("div",{id:"luckysheet-image-showBoxs"},a&&Zt.createElement("div",{id:"luckysheet-modal-dialog-activeImage",className:"luckysheet-modal-dialog",style:{padding:0,position:"absolute",zIndex:300,width:a.width*n.zoomRatio,height:a.height*n.zoomRatio,left:a.left*n.zoomRatio,top:a.top*n.zoomRatio}},Zt.createElement("div",{className:"luckysheet-modal-dialog-border",style:{position:"absolute"}}),Zt.createElement("div",{className:"luckysheet-modal-dialog-content",style:{width:a.width*n.zoomRatio,height:a.height*n.zoomRatio,backgroundImage:"url(".concat(a.src,")"),backgroundSize:"".concat(a.width*n.zoomRatio,"px ").concat(a.height*n.zoomRatio,"px"),backgroundRepeat:"no-repeat"},onMouseDown:function onMouseDown(e){var t=e.nativeEvent;J(n,o.globalCache,t);e.stopPropagation()}}),Zt.createElement("div",{className:"luckysheet-modal-dialog-resize"},["lt","mt","lm","rm","rt","lb","mb","rb"].map((function(e){return Zt.createElement("div",{key:e,className:"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-".concat(e),"data-type":e,onMouseDown:function onMouseDown(t){var n=t.nativeEvent;Q(o.globalCache,n,e);t.stopPropagation()}})}))),Zt.createElement("div",{className:"luckysheet-modal-dialog-controll"},Zt.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-crop",role:"button",tabIndex:0,"aria-label":"裁剪",title:"裁剪"},Zt.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})),Zt.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-restore",role:"button",tabIndex:0,"aria-label":"恢复原图",title:"恢复原图"},Zt.createElement("i",{className:"fa fa-window-maximize","aria-hidden":"true"})),Zt.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-del",role:"button",tabIndex:0,"aria-label":"删除",title:"删除"},Zt.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})))),Zt.createElement("div",{className:"img-list"},(e=n.insertedImgs)===null||e===void 0?void 0:e.map((function(e){var t=e.id,o=e.left,a=e.top,r=e.width,i=e.height,c=e.src;return e.id===n.activeImg?null:Zt.createElement("div",{id:t,key:t,className:"luckysheet-modal-dialog luckysheet-modal-dialog-image",style:{width:r*n.zoomRatio,height:i*n.zoomRatio,padding:0,position:"absolute",left:o*n.zoomRatio,top:a*n.zoomRatio,zIndex:200},onMouseDown:function onMouseDown(e){return e.stopPropagation()},onClick:function onClick(e){l((function(e){e.activeImg=t}));e.stopPropagation()}},Zt.createElement("div",{className:"luckysheet-modal-dialog-content",style:{width:"100%",height:"100%",overflow:"hidden",position:"relative"}},Zt.createElement("img",{src:c,alt:"",style:{width:r*n.zoomRatio,height:i*n.zoomRatio}})),Zt.createElement("div",{className:"luckysheet-modal-dialog-border"}))}))),Zt.createElement("div",{id:"luckysheet-modal-dialog-cropping",className:"luckysheet-modal-dialog",style:{display:"none",padding:0,position:"absolute",zIndex:300}},Zt.createElement("div",{className:"cropping-mask"}),Zt.createElement("div",{className:"cropping-content"}),Zt.createElement("div",{className:"luckysheet-modal-dialog-border",style:{position:"absolute"}}),Zt.createElement("div",{className:"luckysheet-modal-dialog-resize"},Zt.createElement("div",{className:"resize-item lt","data-type":"lt"}),Zt.createElement("div",{className:"resize-item mt","data-type":"mt"}),Zt.createElement("div",{className:"resize-item lm","data-type":"lm"}),Zt.createElement("div",{className:"resize-item rm","data-type":"rm"}),Zt.createElement("div",{className:"resize-item rt","data-type":"rt"}),Zt.createElement("div",{className:"resize-item lb","data-type":"lb"}),Zt.createElement("div",{className:"resize-item mb","data-type":"mb"}),Zt.createElement("div",{className:"resize-item rb","data-type":"rb"})),Zt.createElement("div",{className:"luckysheet-modal-dialog-controll"},Zt.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-crop",role:"button",tabIndex:0,"aria-label":"裁剪",title:"裁剪"},Zt.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})),Zt.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-restore",role:"button",tabIndex:0,"aria-label":"恢复原图",title:"恢复原图"},Zt.createElement("i",{className:"fa fa-window-maximize","aria-hidden":"true"})),Zt.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-del",role:"button",tabIndex:0,"aria-label":"删除",title:"删除"},Zt.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})))),Zt.createElement("div",{className:"cell-date-picker"}))};var _n=function NotationBoxes(){var e;var t=qt(cn),n=t.context,l=t.setContext,o=t.refs;var a=r(n);Jt((function(){if(a){var e=[];for(var t=0;t<a.length;t+=1)for(var n=0;n<a[t].length;n+=1){var o;var r=a[t][n];r&&(((o=r.ps)===null||o===void 0?void 0:o.isShow)&&e.push({r:t,c:n}))}l((function(t){return ee(t,e)}))}}),[a,l]);return Zt.createElement("div",{id:"luckysheet-postil-showBoxs"},an.concat((e=n.commentBoxes)===null||e===void 0?void 0:e.filter((function(e){var t;return(e===null||e===void 0?void 0:e.rc)!==((t=n.editingCommentBox)===null||t===void 0?void 0:t.rc)})),[n.editingCommentBox,n.hoveredCommentBox]).map((function(e){var t;if(!e)return null;var r=e.r,i=e.c,c=e.rc,u=e.left,s=e.top,d=e.width,v=e.height,m=e.value,f=e.autoFocus,h=e.size;var p=((t=n.editingCommentBox)===null||t===void 0?void 0:t.rc)===c;var y="comment-box-".concat(c);return Zt.createElement("div",{key:c},Zt.createElement("canvas",{id:"arrowCanvas-".concat(c),className:"arrowCanvas",width:h.width,height:h.height,style:{position:"absolute",left:h.left,top:h.top,zIndex:100,pointerEvents:"none"}}),Zt.createElement("div",{id:y,className:"luckysheet-postil-show-main",style:{width:d,height:v,color:"#000",padding:5,border:"1px solid #000",backgroundColor:"rgb(255,255,225)",position:"absolute",left:u,top:s,boxSizing:"border-box",zIndex:p?200:100},onMouseDown:function onMouseDown(e){var t=e.nativeEvent;l((function(e){a&&te(e,a,r,i)}));ne(n,o.globalCache,t,{r:r,c:i,rc:c},y);e.stopPropagation()}},Zt.createElement("div",{className:"luckysheet-postil-dialog-move"},["t","r","b","l"].map((function(e){return Zt.createElement("div",{key:e,className:"luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-".concat(e),"data-type":e})}))),p&&Zt.createElement("div",{className:"luckysheet-postil-dialog-resize"},["lt","mt","lm","rm","rt","lb","mb","rb"].map((function(e){return Zt.createElement("div",{key:e,className:"luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-".concat(e),"data-type":e,onMouseDown:function onMouseDown(t){var l=t.nativeEvent;le(n,o.globalCache,l,{r:r,c:i,rc:c},y,e);t.stopPropagation()}})}))),Zt.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden"}},Zt.createElement(vn,{id:"comment-editor-".concat(c),autoFocus:f,style:{width:"100%",height:"100%",lineHeight:"20px",boxSizing:"border-box",textAlign:"center",wordBreak:"break-all",outline:"none"},allowEdit:n.allowEdit,spellCheck:false,"data-r":r,"data-c":i,onKeyDown:function onKeyDown(e){return e.stopPropagation()},onFocus:function onFocus(e){n.allowEdit!==false&&(o.globalCache.editingCommentBoxEle=e.target)},onMouseDown:function onMouseDown(e){l((function(e){a&&te(e,a,r,i)}));e.stopPropagation()},onDoubleClick:function onDoubleClick(e){e.stopPropagation()},initialContent:m}))))})))};function useDialog(){var e=qt(kn),t=e.showModal,n=e.hideModal;var l=$t((function(e,l){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;t(Zt.createElement(yn,{type:l,onOk:o,onCancel:a},e))}),[n,t]);return{showDialog:l,hideDialog:n}}var Nn=function DataVerification(){var e,t,l,o,a,i,c,u,s,d,v,m,f,h,p,y,g,k,E,b,w,x,_,N,M;var R=qt(cn),L=R.context,S=R.setContext;var V=useDialog(),H=V.showDialog,T=V.hideDialog;var D=C(L),I=D.dataVerification,z=D.toolbar,A=D.button,B=D.generalDialog;var F=Yt(["between","notBetween","equal","notEqualTo","moreThanThe","lessThan","greaterOrEqualTo","lessThanOrEqualTo"]),W=_slicedToArray(F,1),P=W[0];var O=Yt(["between","notBetween","equal","notEqualTo","earlierThan","noEarlierThan","laterThan","noLaterThan"]),U=_slicedToArray(O,1),j=U[0];var Z=$t((function(e,t){T();S((function(n){n.rangeDialog.show=true;n.rangeDialog.type=e;n.rangeDialog.rangeTxt=t}))}),[T,S]);var q=$t((function(e){e==="confirm"?S((function(e){var t=oe(e,B,I);if(t){var l,o,a;var i=ae(e,(l=e.dataVerification)===null||l===void 0||(o=l.dataRegulation)===null||o===void 0?void 0:o.rangeTxt);if(i.length===0)return;var c=e.dataVerification.dataRegulation;var u=c===null||c===void 0?void 0:c.type;var s=c.value1;var d=_objectSpread2(_objectSpread2({},c),{},{checked:false});if(u==="dropdown"){var v=re(e,s);d.value1=v.join(",")}var m=(a=e.luckysheetfile[n(e,e.currentSheetId)].dataVerification)!==null&&a!==void 0?a:{};var f=i[i.length-1].row[0];var h=i[i.length-1].row[1];var p=i[i.length-1].column[0];var y=i[i.length-1].column[1];var g=r(e);if(!g)return;for(var k=f;k<=h;k+=1)for(var E=p;E<=y;E+=1){var C="".concat(k,"_").concat(E);m[C]=d;c.type==="checkbox"&&ie(e,k,E,g,d.value2)}e.luckysheetfile[n(e,e.currentSheetId)].dataVerification=m}})):e==="delete"&&S((function(e){var t,l,o;var a=ae(e,(t=e.dataVerification)===null||t===void 0||(l=t.dataRegulation)===null||l===void 0?void 0:l.rangeTxt);if(a.length!==0){var r=(o=e.luckysheetfile[n(e,e.currentSheetId)].dataVerification)!==null&&o!==void 0?o:{};var i=a[a.length-1].row[0];var c=a[a.length-1].row[1];var u=a[a.length-1].column[0];var s=a[a.length-1].column[1];for(var d=i;d<=c;d+=1)for(var v=u;v<=s;v+=1)delete r["".concat(d,"_").concat(v)]}else H(B.noSeletionError,"ok")}));T()}),[I,B,T,S,H]);Jt((function(){S((function(e){var t="";if(e.luckysheet_select_save){var l=e.luckysheet_select_save[e.luckysheet_select_save.length-1];t=K(L,L.currentSheetId,l,L.currentSheetId)}var o=n(e,e.currentSheetId);var a=e.luckysheetfile[o].dataVerification;if(a){var r,i,c;if(!e.luckysheet_select_save)return;var u=e.luckysheet_select_save[e.luckysheet_select_save.length-1];var s=u.row_focus;var d=u.column_focus;if(s==null||d==null)return;var v=a["".concat(s,"_").concat(d)];var m=v!==null&&v!==void 0?v:{};var f=(r=m.value1)!==null&&r!==void 0?r:"";if(((i=e.rangeDialog)===null||i===void 0?void 0:i.type)==="dropDown"&&e.dataVerification&&e.dataVerification.dataRegulation&&e.dataVerification.dataRegulation.rangeTxt){t=e.dataVerification.dataRegulation.rangeTxt;f=e.rangeDialog.rangeTxt}else if(((c=e.rangeDialog)===null||c===void 0?void 0:c.type)==="rangeTxt"&&e.dataVerification&&e.dataVerification.dataRegulation&&e.dataVerification.dataRegulation.value1){f=e.dataVerification.dataRegulation.value1;t=e.rangeDialog.rangeTxt}e.rangeDialog.type="";e.dataVerification.dataRegulation=v?_objectSpread2(_objectSpread2({},v),{},{value1:f,rangeTxt:t}):{type:"dropdown",type2:"",rangeTxt:t,value1:f,value2:"",validity:"",remote:false,prohibitInput:false,hintShow:false,hintValue:""}}else e.dataVerification.dataRegulation={type:"dropdown",type2:"",rangeTxt:t,value1:"",value2:"",validity:"",remote:false,prohibitInput:false,hintShow:false,hintValue:""}}))}),[]);return Zt.createElement("div",{id:"fortune-data-verification"},Zt.createElement("div",{className:"title"},z.dataVerification),Zt.createElement("div",{className:"box"},Zt.createElement("div",{className:"box-item",style:{borderTop:"1px solid #E1E4E8"}},Zt.createElement("div",{className:"box-item-title"},I.cellRange),Zt.createElement("div",{className:"data-verification-range"},Zt.createElement("input",{className:"formulaInputFocus",spellCheck:"false",value:(e=L.dataVerification.dataRegulation)===null||e===void 0?void 0:e.rangeTxt,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.rangeTxt=t}))}}),Zt.createElement("i",{className:"icon","aria-hidden":"true",onClick:function onClick(){T();Z("rangeTxt",L.dataVerification.dataRegulation.value1)}},Zt.createElement(un,{name:"tab",width:18})))),Zt.createElement("div",{className:"box-item"},Zt.createElement("div",{className:"box-item-title"},I.verificationCondition),Zt.createElement("select",{className:"data-verification-type-select",value:L.dataVerification.dataRegulation.type,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.type=t;t==="dropdown"||t==="checkbox"?e.dataVerification.dataRegulation.type2="":t==="number"||t==="number_integer"||t==="number_decimal"||t==="text_length"||t==="date"?e.dataVerification.dataRegulation.type2="between":t==="text_content"?e.dataVerification.dataRegulation.type2="include":t==="validity"&&(e.dataVerification.dataRegulation.type2="identificationNumber");e.dataVerification.dataRegulation.value1="";e.dataVerification.dataRegulation.value2=""}))}},["dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity"].map((function(e){return Zt.createElement("option",{value:e,key:e},I[e])}))),((t=L.dataVerification)===null||t===void 0||(l=t.dataRegulation)===null||l===void 0?void 0:l.type)==="dropdown"&&Zt.createElement("div",{className:"show-box-item"},Zt.createElement("div",{className:"data-verification-range"},Zt.createElement("input",{className:"formulaInputFocus",spellCheck:"false",value:L.dataVerification.dataRegulation.value1,placeholder:I.placeholder1,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value1=t}))}}),Zt.createElement("i",{className:"icon","aria-hidden":"true",onClick:function onClick(){return Z("dropDown",L.dataVerification.dataRegulation.value1)}},Zt.createElement(un,{name:"tab",width:18}))),Zt.createElement("div",{className:"check"},Zt.createElement("input",{type:"checkbox",checked:L.dataVerification.dataRegulation.type2==="true",id:"mul",onChange:function onChange(e){var t=e.target.checked;S((function(e){e.dataVerification.dataRegulation.type2="".concat(t)}))}}),Zt.createElement("label",{htmlFor:"mul"},I.allowMultiSelect))),((o=L.dataVerification)===null||o===void 0||(a=o.dataRegulation)===null||a===void 0?void 0:a.type)==="checkbox"&&Zt.createElement("div",{className:"show-box-item"},Zt.createElement("div",{className:"check-box"},Zt.createElement("span",null,I.selected," —— "),Zt.createElement("input",{type:"text",className:"data-verification-value1",placeholder:I.placeholder2,value:(i=L.dataVerification)===null||i===void 0||(c=i.dataRegulation)===null||c===void 0?void 0:c.value1,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value1=t}))}})),Zt.createElement("div",{className:"check-box"},Zt.createElement("span",null,I.notSelected," —— "),Zt.createElement("input",{type:"text",className:"data-verification-value2",placeholder:I.placeholder2,value:(u=L.dataVerification)===null||u===void 0||(s=u.dataRegulation)===null||s===void 0?void 0:s.value2,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value2=t}))}}))),(((d=L.dataVerification)===null||d===void 0||(v=d.dataRegulation)===null||v===void 0?void 0:v.type)==="number"||((m=L.dataVerification)===null||m===void 0||(f=m.dataRegulation)===null||f===void 0?void 0:f.type)==="number_integer"||((h=L.dataVerification)===null||h===void 0||(p=h.dataRegulation)===null||p===void 0?void 0:p.type)==="number_decimal"||((y=L.dataVerification)===null||y===void 0||(g=y.dataRegulation)===null||g===void 0?void 0:g.type)==="text_length")&&Zt.createElement("div",{className:"show-box-item"},Zt.createElement("select",{className:"data-verification-type-select",value:L.dataVerification.dataRegulation.type2,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.type2=t;e.dataVerification.dataRegulation.value1="";e.dataVerification.dataRegulation.value2=""}))}},P.map((function(e){return Zt.createElement("option",{value:e,key:e},I[e])}))),L.dataVerification.dataRegulation.type2==="between"||L.dataVerification.dataRegulation.type2==="notBetween"?Zt.createElement("div",{className:"input-box"},Zt.createElement("input",{type:"number",placeholder:"1",value:L.dataVerification.dataRegulation.value1,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value1=t}))}}),Zt.createElement("span",null,"-"),Zt.createElement("input",{type:"number",placeholder:"100",value:L.dataVerification.dataRegulation.value2,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value2=t}))}})):Zt.createElement("div",{className:"input-box"},Zt.createElement("input",{type:"number",style:{width:"100%"},placeholder:I.placeholder3,value:L.dataVerification.dataRegulation.value1,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value1=t}))}}))),((k=L.dataVerification)===null||k===void 0||(E=k.dataRegulation)===null||E===void 0?void 0:E.type)==="text_content"&&Zt.createElement("div",{className:"show-box-item"},Zt.createElement("select",{className:"data-verification-type-select",value:L.dataVerification.dataRegulation.type2,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.type2=t;e.dataVerification.dataRegulation.value1="";e.dataVerification.dataRegulation.value2=""}))}},["include","exclude","equal"].map((function(e){return Zt.createElement("option",{value:e,key:e},I[e])}))),Zt.createElement("div",{className:"input-box"},Zt.createElement("input",{type:"text",style:{width:"100%"},placeholder:I.placeholder4,value:L.dataVerification.dataRegulation.value1,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value1=t}))}}))),((b=L.dataVerification)===null||b===void 0||(w=b.dataRegulation)===null||w===void 0?void 0:w.type)==="date"&&Zt.createElement("div",{className:"show-box-item"},Zt.createElement("select",{className:"data-verification-type-select",value:L.dataVerification.dataRegulation.type2,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.type2=t;e.dataVerification.dataRegulation.value1="";e.dataVerification.dataRegulation.value2=""}))}},j.map((function(e){return Zt.createElement("option",{value:e,key:e},I[e])}))),L.dataVerification.dataRegulation.type2==="between"||L.dataVerification.dataRegulation.type2==="notBetween"?Zt.createElement("div",{className:"input-box"},Zt.createElement("input",{type:"date",placeholder:"1",value:L.dataVerification.dataRegulation.value1,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value1=t}))}}),Zt.createElement("span",null,"-"),Zt.createElement("input",{type:"date",placeholder:"100",value:L.dataVerification.dataRegulation.value2,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value2=t}))}})):Zt.createElement("div",{className:"input-box"},Zt.createElement("input",{type:"date",style:{width:"100%"},placeholder:I.placeholder3,value:L.dataVerification.dataRegulation.value1,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.value1=t}))}}))),((x=L.dataVerification)===null||x===void 0||(_=x.dataRegulation)===null||_===void 0?void 0:_.type)==="validity"&&Zt.createElement("div",{className:"show-box-item"},Zt.createElement("select",{className:"data-verification-type-select",value:L.dataVerification.dataRegulation.type2,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.type2=t;e.dataVerification.dataRegulation.value1="";e.dataVerification.dataRegulation.value2=""}))}},["identificationNumber","phoneNumber"].map((function(e){return Zt.createElement("option",{value:e,key:e},I[e])}))))),Zt.createElement("div",{className:"box-item"},["prohibitInput","hintShow"].map((function(e){return Zt.createElement("div",{className:"check",key:"div".concat(e)},Zt.createElement("input",{type:"checkbox",id:e,key:"input".concat(e),checked:L.dataVerification.dataRegulation[e],onChange:function onChange(){S((function(t){var n;var l=(n=t.dataVerification)===null||n===void 0?void 0:n.dataRegulation;e==="prohibitInput"?l.prohibitInput=!l.prohibitInput:e==="hintShow"&&(l.hintShow=!l.hintShow)}))}}),Zt.createElement("label",{htmlFor:e,key:"label".concat(e)},I[e]))})),((N=L.dataVerification)===null||N===void 0||(M=N.dataRegulation)===null||M===void 0?void 0:M.hintShow)&&Zt.createElement("div",{className:"input-box"},Zt.createElement("input",{type:"text",style:{width:"100%"},placeholder:I.placeholder5,value:L.dataVerification.dataRegulation.hintValue,onChange:function onChange(e){var t=e.target.value;S((function(e){e.dataVerification.dataRegulation.hintValue=t}))}})))),Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){q("confirm")}},A.confirm),Zt.createElement("div",{className:"button-basic button-close",onClick:function onClick(){q("delete")}},I.deleteVerification),Zt.createElement("div",{className:"button-basic button-close",onClick:function onClick(){q("close")}},A.cancel))};var Mn=function ConditionRules(e){var t=e.type;var n=qt(cn),l=n.context,o=n.setContext;var a=useDialog(),r=a.hideDialog;var i=C(l),c=i.conditionformat,u=i.button,s=i.protection,d=i.generalDialog;var v=Yt({textColor:"#000000",cellColor:"#000000"}),m=_slicedToArray(v,2),f=m[0],h=m[1];var p=$t((function(e){e==="confirm"&&o((function(e){e.conditionRules.textColor.color=f.textColor;e.conditionRules.cellColor.color=f.cellColor;ce(e,s,d,c,e.conditionRules)}));o((function(e){e.conditionRules={rulesType:"",rulesValue:"",textColor:{check:true,color:"#000000"},cellColor:{check:true,color:"#000000"},betweenValue:{value1:"",value2:""},dateValue:"",repeatValue:"0",projectValue:"10"}}));r()}),[f,c,d,r,s,o]);Jt((function(){o((function(e){e.conditionRules.rulesType=t;if(e.rangeDialog){var n=e.rangeDialog.type;var l=e.rangeDialog.rangeTxt;n==="conditionRulesbetween1"?e.conditionRules.betweenValue.value1=l:n==="conditionRulesbetween2"?e.conditionRules.betweenValue.value2=l:n.indexOf("conditionRules")>=0?e.conditionRules.rulesValue=l:n===""&&(e.conditionRules={rulesType:t,rulesValue:"",textColor:{check:true,color:"#000000"},cellColor:{check:true,color:"#000000"},betweenValue:{value1:"",value2:""},dateValue:"",repeatValue:"0",projectValue:"10"});e.rangeDialog.type="";e.rangeDialog.rangeTxt=""}}))}),[]);return Zt.createElement("div",{className:"condition-rules"},Zt.createElement("div",{className:"condition-rules-title"},c["conditionformat_".concat(t)]),Zt.createElement("div",{className:"conditin-rules-value"},c["conditionformat_".concat(t,"_title")]),(t==="greaterThan"||t==="lessThan"||t==="equal"||t==="textContains")&&Zt.createElement("div",{className:"condition-rules-inpbox"},Zt.createElement("input",{className:"condition-rules-input",type:"text",value:l.conditionRules.rulesValue,onChange:function onChange(e){var t=e.target.value;o((function(e){e.conditionRules.rulesValue=t}))}})),t==="between"&&Zt.createElement("div",{className:"condition-rules-between-box"},Zt.createElement("div",{className:"condition-rules-between-inpbox"},Zt.createElement("input",{className:"condition-rules-between-input",type:"text",value:l.conditionRules.betweenValue.value1,onChange:function onChange(e){var t=e.target.value;o((function(e){e.conditionRules.betweenValue.value1=t}))}})),Zt.createElement("span",{style:{margin:"0px 4px"}},c.to),Zt.createElement("div",{className:"condition-rules-between-inpbox"},Zt.createElement("input",{className:"condition-rules-between-input",type:"text",value:l.conditionRules.betweenValue.value2,onChange:function onChange(e){var t=e.target.value;o((function(e){e.conditionRules.betweenValue.value2=t}))}}))),t==="occurrenceDate"&&Zt.createElement("div",{className:"condition-rules-inpbox"},Zt.createElement("input",{type:"date",className:"condition-rules-date",value:l.conditionRules.dateValue,onChange:function onChange(e){var t=e.target.value;o((function(e){e.conditionRules.dateValue=t}))}})),t==="duplicateValue"&&Zt.createElement("select",{className:"condition-rules-select",onChange:function onChange(e){var t=e.target.value;o((function(e){e.conditionRules.repeatValue=t}))}},Zt.createElement("option",{value:"0"},c.duplicateValue),Zt.createElement("option",{value:"1"},c.uniqueValue)),(t==="top10"||t==="top10_percent"||t==="last10"||t==="last10_percent")&&Zt.createElement("div",{className:"condition-rules-project-box"},t==="top10"||t==="top10_percent"?c.top:c.last,Zt.createElement("input",{className:"condition-rules-project-input",type:"number",value:l.conditionRules.projectValue,onChange:function onChange(e){var t=e.target.value;o((function(e){e.conditionRules.projectValue=t}))}}),t==="top10"||t==="last10"?c.oneself:"%"),Zt.createElement("div",{className:"condition-rules-set-title"},"".concat(c.setAs,"：")),Zt.createElement("div",{className:"condition-rules-setbox"},Zt.createElement("div",{className:"condition-rules-set"},Zt.createElement("div",{className:"condition-rules-color"},Zt.createElement("input",{id:"checkTextColor",type:"checkbox",className:"condition-rules-check",checked:l.conditionRules.textColor.check,onChange:function onChange(e){var t=e.target.checked;o((function(e){e.conditionRules.textColor.check=t}))}}),Zt.createElement("label",{htmlFor:"checkTextColor",className:"condition-rules-label"},c.textColor),Zt.createElement("input",{type:"color",className:"condition-rules-select-color",value:f.textColor,onChange:function onChange(e){var t=e.target.value;h(tn((function(e){e.textColor=t})))}}))),Zt.createElement("div",{className:"condition-rules-set"},Zt.createElement("div",{className:"condition-rules-color"},Zt.createElement("input",{id:"checkCellColor",type:"checkbox",className:"condition-rules-check",checked:l.conditionRules.cellColor.check,onChange:function onChange(e){var t=e.target.checked;o((function(e){e.conditionRules.cellColor.check=t}))}}),Zt.createElement("label",{htmlFor:"checkCellColor",className:"condition-rules-label"},c.cellColor),Zt.createElement("input",{type:"color",className:"condition-rules-select-color",value:f.cellColor,onChange:function onChange(e){var t=e.target.value;h(tn((function(e){e.cellColor=t})))}})))),Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){p("confirm")}},u.confirm),Zt.createElement("div",{className:"button-basic button-close",onClick:function onClick(){p("close")}},u.cancel))};var Rn=function RangeDialog(){var e,t;var n=qt(cn),l=n.context,o=n.setContext;var a=useDialog(),r=a.showDialog;var i=C(l),c=i.dataVerification,u=i.button;var s=Yt((e=(t=l.rangeDialog)===null||t===void 0?void 0:t.rangeTxt)!==null&&e!==void 0?e:""),d=_slicedToArray(s,2),v=d[0],m=d[1];var f=$t((function(){o((function(e){e.rangeDialog.show=false;e.rangeDialog.singleSelect=false}));if(l.rangeDialog){var e=l.rangeDialog.type;if(e.indexOf("between")>=0)r(Zt.createElement(Mn,{type:"between"}));else if(e.indexOf("conditionRules")>=0){var t=e.substring(14,e.length);r(Zt.createElement(Mn,{type:t}))}else r(Zt.createElement(Nn,null))}}),[l.rangeDialog,o,r]);Jt((function(){m((function(e){if(l.luckysheet_select_save){var t=l.luckysheet_select_save[l.luckysheet_select_save.length-1];e=K(l,l.currentSheetId,t,l.currentSheetId);return e}return""}))}),[l,l.luckysheet_select_save]);return Zt.createElement("div",{id:"range-dialog",onClick:function onClick(e){return e.stopPropagation()},onChange:function onChange(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},onMouseDown:function onMouseDown(e){return e.stopPropagation()},onMouseUp:function onMouseUp(e){return e.stopPropagation()}},Zt.createElement("div",{className:"dialog-title"},c.selectCellRange),Zt.createElement("input",{readOnly:true,placeholder:c.selectCellRange2,value:v}),Zt.createElement("div",{className:"button-basic button-primary",style:{marginLeft:"6px"},onClick:function onClick(){o((function(e){e.rangeDialog.rangeTxt=v}));f()}},u.confirm),Zt.createElement("div",{className:"button-basic button-close",onClick:function onClick(){f()}},u.close))};function useOutsideClick(e,t,n){Jt((function(){function handleClickOutside(n){e.current&&!e.current.contains(n.target)&&t()}document.addEventListener("mousedown",handleClickOutside);return function(){document.removeEventListener("mousedown",handleClickOutside)}}),n)}var Ln=function DropDownList(){var e=qt(cn),t=e.context,l=e.setContext;var o=Xt(null);var a=Yt([]),i=_slicedToArray(a,2),c=i[0],u=i[1];var s=Yt(false),d=_slicedToArray(s,2),v=d[0],m=d[1];var f=Yt(),h=_slicedToArray(f,2),p=h[0],y=h[1];var g=Yt([]),k=_slicedToArray(g,2),E=k[0],C=k[1];var b=$t((function(){l((function(e){e.dataVerificationDropDownList=false}))}),[l]);useOutsideClick(o,b,[b]);Jt((function(){if(t.luckysheet_select_save){var e=t.luckysheet_select_save[t.luckysheet_select_save.length-1];var l=e.row_focus;var o=e.column_focus;if(l!=null&&o!=null){var a=t.visibledatarow[l];var i=o===0?0:t.visibledatacolumn[o-1];var c=r(t);if(c){var s=ue(t,c,l,o);if(s){var d=_slicedToArray(s.row,2);a=d[1];var v=_slicedToArray(s.column,2);i=v[0]}var f=n(t,t.currentSheetId);var h=t.luckysheetfile[f].dataVerification;var p=h["".concat(l,"_").concat(o)];var g=re(t,p.value1);var k=w(l,o,c);k&&C(k.toString().split(","));u(g);y({left:i,top:a});m(p.type2==="true")}}}}),[]);Jt((function(){if(t.luckysheet_select_save){var e=t.luckysheet_select_save[t.luckysheet_select_save.length-1];var l=e.row_focus;var o=e.column_focus;if(l!=null&&o!=null){var a=n(t,t.currentSheetId);var i=t.luckysheetfile[a].dataVerification;var c=i["".concat(l,"_").concat(o)];if(c.type2==="true"){var u=r(t);if(u){var s=w(l,o,u);s&&C(s.toString().split(","))}}}}}),[t.luckysheetfile]);return Zt.createElement("div",{id:"luckysheet-dataVerification-dropdown-List",style:p,ref:o,onClick:function onClick(e){return e.stopPropagation()},onChange:function onChange(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},onMouseDown:function onMouseDown(e){return e.stopPropagation()},onMouseUp:function onMouseUp(e){return e.stopPropagation()}},c.map((function(e,t){return Zt.createElement("div",{className:"dropdown-List-item",key:t,onClick:function onClick(){l((function(t){var n=E;var l=n.indexOf(e);l<0?n.push(e):n.splice(l,1);C(n);se(t,e,n)}))}},Zt.createElement(un,{name:"check",width:12,style:{verticalAlign:"middle",display:v&&E.indexOf(e)>=0?"inline":"none"}}),e)})))};var Sn=function SheetOverlay(){var e,t,l,o,a,r,i,c,u,s,v,m;var h=qt(cn),p=h.context,y=h.setContext,g=h.settings,k=h.refs;var b=C(p),w=b.info,x=b.rightclick;var _=useDialog(),N=_.showDialog;var M=Xt(null);var R=Xt(null);var L=Xt(null);var S=useAlert(),V=S.showAlert;var H=$t((function(e){var t=e.nativeEvent;e.button!==2&&y((function(e){var n;de(e,k.globalCache,t,k.cellInput.current,k.cellArea.current,k.fxInput.current,k.canvas.current.getContext("2d"));!an.isEmpty((n=e.luckysheet_select_save)===null||n===void 0?void 0:n[0])&&k.cellInput.current&&setTimeout((function(){var e;(e=k.cellInput.current)===null||e===void 0?void 0:e.focus()}))}))}),[y,k.globalCache,k.cellInput,k.cellArea,k.fxInput,k.canvas]);var T=$t((function(e){var t=e.nativeEvent;y((function(e){d(e,g,t,k.workbookContainer.current,k.cellArea.current,"cell")}))}),[k.workbookContainer,y,g,k.cellArea]);var D=$t((function(e){var t=e.nativeEvent;y((function(e){ve(e,k.globalCache,g,t,k.cellArea.current)}))}),[k.cellArea,k.globalCache,y,g]);var I=$t((function(){y((function(e){me(e)}))}),[y]);var z=Gt((function(){return an.debounce((function(e,t,n,l){var o;var a=arguments.length>4&&arguments[4]!==void 0&&arguments[4];a||((o=e.linkCard)===null||o===void 0?void 0:o.mouseEnter)||y((function(e){fe(e,t,n,l)}))}),800)}),[y]);var A=$t((function(e,t,n,l,o,a){var r=he(e,n,l,o,a);if(r!=null){var i=pe(e,r.r,r.c);if(i==null)z(t,r.r,r.c,false);else{fe(e,r.r,r.c,false);z(t,r.r,r.c,false,true)}}}),[z]);var B=$t((function(e){y((function(t){A(t,k.globalCache,e,M.current,k.scrollbarX.current,k.scrollbarY.current);ye(t,k.globalCache,e,k.cellInput.current,k.scrollbarX.current,k.scrollbarY.current,M.current,k.fxInput.current)}))}),[A,k.cellInput,k.fxInput,k.globalCache,k.scrollbarX,k.scrollbarY,y]);var F=$t((function(e){y((function(t){try{ge(t,k.globalCache,g,e,k.scrollbarX.current,k.scrollbarY.current,M.current,k.cellInput.current,k.fxInput.current)}catch(e){V(e.message)}}))}),[k.cellInput,k.fxInput,k.globalCache,k.scrollbarX,k.scrollbarY,y,g,V]);var W=$t((function(e){var t=ke(e,p.zoomRatio);t!==p.zoomRatio&&y((function(e){e.zoomRatio=t;e.luckysheetfile[n(e,e.currentSheetId)].zoomRatio=t}))}),[p.zoomRatio,y]);var P=$t((function(e){var t=e.nativeEvent;y((function(e){Ee(e,t,k.globalCache)}));e.stopPropagation()}),[k.globalCache,y]);var O=$t((function(e){var t=e.nativeEvent;y((function(e){Ce(e,t,k.globalCache,k.scrollbarX.current,k.scrollbarY.current)}))}),[k.globalCache,k.scrollbarX,k.scrollbarY,y]);var U=$t((function(){be(k.globalCache)}),[k.globalCache]);var j=$t((function(){var e;var t=((e=R.current)===null||e===void 0?void 0:e.value)||p.addDefaultRows.toString();var l=parseInt(t,10);if(!Number.isNaN(l)&&!(l<1)){var o={type:"row",index:p.luckysheetfile[n(p,p.currentSheetId)].data.length-1,count:l,direction:"rightbottom",id:p.currentSheetId};y((function(e){try{we(e,o,false)}catch(e){e.message==="maxExceeded"&&V(x.rowOverLimit)}}),{insertRowColOp:o})}}),[p,x.rowOverLimit,y,V]);Jt((function(){p.warnDialog&&setTimeout((function(){N(p.warnDialog,"ok")}),240)}),[p.warnDialog]);Jt((function(){k.cellArea.current.scrollLeft=p.scrollLeft;k.cellArea.current.scrollTop=p.scrollTop}),[p.scrollLeft,p.scrollTop,k.cellArea,(e=k.cellArea.current)===null||e===void 0?void 0:e.scrollLeft,(t=k.cellArea.current)===null||t===void 0?void 0:t.scrollTop]);Qt((function(){if(p.commentBoxes||p.hoveredCommentBox||p.editingCommentBox){var e;an.concat((e=p.commentBoxes)===null||e===void 0?void 0:e.filter((function(e){var t;return e.rc!==((t=p.editingCommentBox)===null||t===void 0?void 0:t.rc)})),[p.hoveredCommentBox,p.editingCommentBox]).forEach((function(e){e&&xe(e.rc,e.size)}))}}),[p.commentBoxes,p.hoveredCommentBox,p.editingCommentBox]);Jt((function(){document.addEventListener("mousemove",B);return function(){document.removeEventListener("mousemove",B)}}),[B]);Jt((function(){document.addEventListener("mouseup",F);return function(){document.removeEventListener("mouseup",F)}}),[F]);Jt((function(){document.addEventListener("keydown",W);return function(){document.removeEventListener("keydown",W)}}),[W]);return Zt.createElement("div",{className:"fortune-sheet-overlay",ref:M,onTouchStart:P,onTouchMove:O,onTouchEnd:U,tabIndex:-1,style:{width:p.luckysheetTableContentHW[0],height:p.luckysheetTableContentHW[1]}},Zt.createElement("div",{className:"fortune-col-header-wrap"},Zt.createElement("div",{className:"fortune-left-top",onClick:I,style:{width:p.rowHeaderWidth-1.5,height:p.columnHeaderHeight-1.5}}),Zt.createElement(sn,null)),(p.showSearch||p.showReplace)&&Zt.createElement(Cn,{getContainer:function getContainer(){return M.current}}),Zt.createElement("div",{className:"fortune-row-body"},Zt.createElement(dn,null),Zt.createElement(pn,{axis:"x"}),Zt.createElement(pn,{axis:"y"}),Zt.createElement("div",{ref:k.cellArea,className:"fortune-cell-area",onMouseDown:H,onDoubleClick:D,onContextMenu:T,style:{width:p.cellmainWidth,height:p.cellmainHeight,cursor:p.luckysheet_cell_selected_extend?"crosshair":"default"}},Zt.createElement("div",{id:"fortune-formula-functionrange"}),p.formulaRangeSelect&&Zt.createElement("div",{className:"fortune-selection-copy fortune-formula-functionrange-select",style:p.formulaRangeSelect},Zt.createElement("div",{className:"fortune-selection-copy-top fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-right fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-bottom fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-left fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-hc"})),p.formulaRangeHighlight.map((function(e){var t=e.rangeIndex,n=e.backgroundColor;return Zt.createElement("div",{key:t,id:"fortune-formula-functionrange-highlight",className:"fortune-selection-highlight fortune-formula-functionrange-highlight",style:an.omit(e,"backgroundColor")},["top","right","bottom","left"].map((function(e){return Zt.createElement("div",{key:e,"data-type":e,className:"fortune-selection-copy-".concat(e," fortune-copy"),style:{backgroundColor:n}})})),Zt.createElement("div",{className:"fortune-selection-copy-hc",style:{backgroundColor:n}}),["lt","rt","lb","rb"].map((function(e){return Zt.createElement("div",{key:e,"data-type":e,className:"fortune-selection-highlight-".concat(e," luckysheet-highlight"),style:{backgroundColor:n}})})))})),Zt.createElement("div",{className:"luckysheet-row-count-show luckysheet-count-show",id:"luckysheet-row-count-show"}),Zt.createElement("div",{className:"luckysheet-column-count-show luckysheet-count-show",id:"luckysheet-column-count-show"}),Zt.createElement("div",{className:"fortune-change-size-line",hidden:!p.luckysheet_cols_change_size&&!p.luckysheet_rows_change_size&&!p.luckysheet_cols_freeze_drag&&!p.luckysheet_rows_freeze_drag}),Zt.createElement("div",{className:"fortune-freeze-drag-line",hidden:!p.luckysheet_cols_freeze_drag&&!p.luckysheet_rows_freeze_drag}),Zt.createElement("div",{className:"luckysheet-cell-selected-focus",style:((l=(o=p.luckysheet_select_save)===null||o===void 0?void 0:o.length)!==null&&l!==void 0?l:0)>0?function(){var e,t;var n=an.last(p.luckysheet_select_save);return an.assign({left:n.left,top:n.top,width:n.width,height:n.height,display:"block"},E(p,n.row_focus||0,n.row_focus||0,(e=k.globalCache.freezen)===null||e===void 0?void 0:e[p.currentSheetId]),f(p,n.column_focus||0,n.column_focus||0,(t=k.globalCache.freezen)===null||t===void 0?void 0:t[p.currentSheetId]))}():{},onMouseDown:function onMouseDown(e){return e.preventDefault()}}),((a=(r=p.luckysheet_selection_range)===null||r===void 0?void 0:r.length)!==null&&a!==void 0?a:0)>0&&Zt.createElement("div",{id:"fortune-selection-copy"},p.luckysheet_selection_range.map((function(e){var t=e.row[0];var n=e.row[1];var l=e.column[0];var o=e.column[1];var a=p.visibledatarow[n];var r=t-1===-1?0:p.visibledatarow[t-1];var i=p.visibledatacolumn[o];var c=l-1===-1?0:p.visibledatacolumn[l-1];return Zt.createElement("div",{className:"fortune-selection-copy",key:"".concat(t,"-").concat(n,"-").concat(l,"-").concat(o),style:{left:c,width:i-c-1,top:r,height:a-r-1}},Zt.createElement("div",{className:"fortune-selection-copy-top fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-right fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-bottom fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-left fortune-copy"}),Zt.createElement("div",{className:"fortune-selection-copy-hc"}))}))),Zt.createElement("div",{id:"luckysheet-chart-rangeShow"}),Zt.createElement("div",{className:"fortune-cell-selected-extend"}),Zt.createElement("div",{className:"fortune-cell-selected-move",id:"fortune-cell-selected-move",onMouseDown:function onMouseDown(e){return e.preventDefault()}}),((i=(c=p.luckysheet_select_save)===null||c===void 0?void 0:c.length)!==null&&i!==void 0?i:0)>0&&Zt.createElement("div",{id:"luckysheet-cell-selected-boxs"},p.luckysheet_select_save.map((function(e,t){var n,l;return Zt.createElement("div",{key:t,id:"luckysheet-cell-selected",className:"luckysheet-cell-selected",style:an.assign({left:e.left_move,top:e.top_move,width:e.width_move,height:e.height_move,display:"block"},E(p,e.row[0],e.row[1],(n=k.globalCache.freezen)===null||n===void 0?void 0:n[p.currentSheetId]),f(p,e.column[0],e.column[1],(l=k.globalCache.freezen)===null||l===void 0?void 0:l[p.currentSheetId])),onMouseDown:function onMouseDown(e){e.stopPropagation();var t=e.nativeEvent;y((function(e){_e(e,k.globalCache,t,k.scrollbarX.current,k.scrollbarY.current,M.current)}))}},Zt.createElement("div",{className:"luckysheet-cs-inner-border"}),Zt.createElement("div",{className:"luckysheet-cs-fillhandle",onMouseDown:function onMouseDown(e){var t=e.nativeEvent;y((function(e){Ne(e,t,M.current)}));e.stopPropagation()}}),Zt.createElement("div",{className:"luckysheet-cs-inner-border"}),Zt.createElement("div",{className:"luckysheet-cs-draghandle-top luckysheet-cs-draghandle",onMouseDown:function onMouseDown(e){return e.preventDefault()}}),Zt.createElement("div",{className:"luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle",onMouseDown:function onMouseDown(e){return e.preventDefault()}}),Zt.createElement("div",{className:"luckysheet-cs-draghandle-left luckysheet-cs-draghandle",onMouseDown:function onMouseDown(e){return e.preventDefault()}}),Zt.createElement("div",{className:"luckysheet-cs-draghandle-right luckysheet-cs-draghandle",onMouseDown:function onMouseDown(e){return e.preventDefault()}}),Zt.createElement("div",{className:"luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"},Zt.createElement("div",{className:"luckysheet-cs-touchhandle-btn"})),Zt.createElement("div",{className:"luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"},Zt.createElement("div",{className:"luckysheet-cs-touchhandle-btn"})))}))),((u=(s=p.presences)===null||s===void 0?void 0:s.length)!==null&&u!==void 0?u:0)>0&&p.presences.map((function(e,t){if(e.sheetId!==p.currentSheetId)return null;var n=e.selection,l=n.r,o=n.c,a=e.color;var r=l-1===-1?0:p.visibledatarow[l-1];var i=o-1===-1?0:p.visibledatacolumn[o-1];var c=p.visibledatarow[l];var u=p.visibledatacolumn[o];var s=u-i-1;var d=c-r-1;var v={maxWidth:s+1,backgroundColor:a};an.set(v,l===0?"top":"bottom",d);return Zt.createElement("div",{key:(e===null||e===void 0?void 0:e.userId)||t,className:"fortune-presence-selection",style:{left:i,top:r-2,width:s,height:d,borderColor:a,borderWidth:1}},Zt.createElement("div",{className:"fortune-presence-username",style:v},e.username))})),((v=p.linkCard)===null||v===void 0?void 0:v.sheetId)===p.currentSheetId&&Zt.createElement(bn,_objectSpread2({},p.linkCard)),((m=p.rangeDialog)===null||m===void 0?void 0:m.show)&&Zt.createElement(Rn,null),Zt.createElement(wn,{getContainer:function getContainer(){return M.current}}),Zt.createElement(hn,null),Zt.createElement(_n,null),Zt.createElement("div",{id:"luckysheet-multipleRange-show"}),Zt.createElement("div",{id:"luckysheet-dynamicArray-hightShow"}),Zt.createElement(xn,null),Zt.createElement("div",{id:"luckysheet-dataVerification-dropdown-btn",onClick:function onClick(){y((function(e){e.dataVerificationDropDownList=true;L.current.style.display="none"}))}},Zt.createElement(un,{name:"combo-arrow",width:16})),p.dataVerificationDropDownList&&Zt.createElement(Ln,null),Zt.createElement("div",{id:"luckysheet-dataVerification-showHintBox",className:"luckysheet-mousedown-cancel",ref:L}),Zt.createElement("div",{className:"luckysheet-cell-copy"}),Zt.createElement("div",{className:"luckysheet-grdblkflowpush"}),Zt.createElement("div",{id:"luckysheet-cell-flow_0",className:"luckysheet-cell-flow luckysheetsheetchange"},Zt.createElement("div",{className:"luckysheet-cell-flow-clip"},Zt.createElement("div",{className:"luckysheet-grdblkpush"}),Zt.createElement("div",{id:"luckysheetcoltable_0",className:"luckysheet-cell-flow-col"},Zt.createElement("div",{id:"luckysheet-sheettable_0",className:"luckysheet-cell-sheettable",style:{height:p.rh_height,width:p.ch_width}}),Zt.createElement("div",{id:"luckysheet-bottom-controll-row",className:"luckysheet-bottom-controll-row",onMouseDown:function onMouseDown(e){return e.stopPropagation()},onMouseUp:function onMouseUp(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},onKeyUp:function onKeyUp(e){return e.stopPropagation()},onKeyPress:function onKeyPress(e){return e.stopPropagation()},onClick:function onClick(e){return e.stopPropagation()},onDoubleClick:function onDoubleClick(e){return e.stopPropagation()},style:{left:p.scrollLeft,display:p.allowEdit?"block":"none"}},Zt.createElement("div",{className:"fortune-add-row-button",onClick:function onClick(){j()}},w.add),Zt.createElement("input",{ref:R,type:"text",style:{width:50},placeholder:p.addDefaultRows.toString()})," ",Zt.createElement("span",{style:{fontSize:14}},w.row)," ",Zt.createElement("span",{style:{fontSize:14,color:"#9c9c9c"}},"(",w.addLast,")"),Zt.createElement("span",{className:"fortune-add-row-button",onClick:function onClick(){y((function(e){e.scrollTop=0}))}},w.backTop))))))))};var Vn=function Sheet(e){var t,n,l;var o=e.sheet;var a=o.data;var r=Xt(null);var i=Xt(null);var c=qt(cn),u=c.context,s=c.setContext,d=c.refs,v=c.settings;Jt((function(){function resize(){a&&s((function(e){v.devicePixelRatio===0&&(e.devicePixelRatio=(globalThis||window).devicePixelRatio);Me(e,a);Re(e,d.canvas.current,i.current)}))}window.addEventListener("resize",resize);return function(){window.removeEventListener("resize",resize)}}),[a,d.canvas,s,v.devicePixelRatio]);Jt((function(){a&&s((function(e){return Me(e,a)}))}),[(t=u.config)===null||t===void 0?void 0:t.rowlen,(n=u.config)===null||n===void 0?void 0:n.columnlen,(l=u.config)===null||l===void 0?void 0:l.rowhidden,u.config.colhidden,a,u.zoomRatio,s]);Jt((function(){s((function(e){return Re(e,d.canvas.current,i.current)}))}),[d.canvas,s,u.rowHeaderWidth,u.columnHeaderHeight,u.devicePixelRatio]);Jt((function(){Le(u,d.globalCache,u.currentSheetId)}),[d.globalCache,o.frozen,u.currentSheetId,u.visibledatacolumn,u.visibledatarow]);Jt((function(){var e,t,n;if(!(u.groupValuesRefreshData.length>0)){var l=new Se(d.canvas.current,u);if(l!=null){var a=(e=d.globalCache.freezen)===null||e===void 0?void 0:e[o.id];if((a===null||a===void 0||(t=a.horizontal)===null||t===void 0?void 0:t.freezenhorizontaldata)||(a===null||a===void 0||(n=a.vertical)===null||n===void 0?void 0:n.freezenverticaldata)){var r,i;var c=a===null||a===void 0||(r=a.horizontal)===null||r===void 0?void 0:r.freezenhorizontaldata;var s=a===null||a===void 0||(i=a.vertical)===null||i===void 0?void 0:i.freezenverticaldata;if(c&&s){var v=_slicedToArray(c,3),m=v[0],f=v[2];var h=_slicedToArray(s,3),p=h[0],y=h[2];l.drawMain({scrollWidth:u.scrollLeft+p-y,scrollHeight:u.scrollTop+m-f,offsetLeft:p-y+u.rowHeaderWidth,offsetTop:m-f+u.columnHeaderHeight,clear:true});l.drawMain({scrollWidth:u.scrollLeft+p-y,scrollHeight:f,drawHeight:m,offsetLeft:p-y+u.rowHeaderWidth});l.drawMain({scrollWidth:y,scrollHeight:u.scrollTop+m-f,drawWidth:p,offsetTop:m-f+u.columnHeaderHeight});l.drawMain({scrollWidth:y,scrollHeight:f,drawWidth:p,drawHeight:m});l.drawColumnHeader(u.scrollLeft+p-y,void 0,p-y+u.rowHeaderWidth);l.drawColumnHeader(y,p);l.drawRowHeader(u.scrollTop+m-f,void 0,m-f+u.columnHeaderHeight);l.drawRowHeader(f,m);l.drawFreezeLine({horizontalTop:m-f+u.columnHeaderHeight-2,verticalLeft:p-y+u.rowHeaderWidth-2})}else if(c){var g=_slicedToArray(c,3),k=g[0],E=g[2];l.drawMain({scrollWidth:u.scrollLeft,scrollHeight:u.scrollTop+k-E,offsetTop:k-E+u.columnHeaderHeight,clear:true});l.drawMain({scrollWidth:u.scrollLeft,scrollHeight:E,drawHeight:k});l.drawColumnHeader(u.scrollLeft);l.drawRowHeader(u.scrollTop+k-E,void 0,k-E+u.columnHeaderHeight);l.drawRowHeader(E,k);l.drawFreezeLine({horizontalTop:k-E+u.columnHeaderHeight-2})}else if(s){var C=_slicedToArray(s,3),b=C[0],w=C[2];l.drawMain({scrollWidth:u.scrollLeft+b-w,scrollHeight:u.scrollTop,offsetLeft:b-w+u.rowHeaderWidth});l.drawMain({scrollWidth:w,scrollHeight:u.scrollTop,drawWidth:b});l.drawRowHeader(u.scrollTop);l.drawColumnHeader(u.scrollLeft+b-w,void 0,b-w+u.rowHeaderWidth);l.drawColumnHeader(w,b);l.drawFreezeLine({verticalLeft:b-w+u.rowHeaderWidth-2})}}else{l.drawMain({scrollWidth:u.scrollLeft,scrollHeight:u.scrollTop,clear:true});l.drawColumnHeader(u.scrollLeft);l.drawRowHeader(u.scrollTop)}}}}),[u,d.canvas,d.globalCache.freezen,s,o.id]);var m=$t((function(e){s((function(t){Ve(t,e,d.globalCache,d.scrollbarX.current,d.scrollbarY.current)}));e.preventDefault()}),[d.globalCache,d.scrollbarX,d.scrollbarY,s]);Jt((function(){var e=r.current;e===null||e===void 0?void 0:e.addEventListener("wheel",m);return function(){e===null||e===void 0?void 0:e.removeEventListener("wheel",m)}}),[m]);return Zt.createElement("div",{ref:r,className:"fortune-sheet-container"},Zt.createElement("div",{ref:i,className:"fortune-sheet-canvas-placeholder"}),Zt.createElement("canvas",{className:"fortune-sheet-canvas",ref:d.canvas}),Zt.createElement(Sn,null))};var Hn=function Button(e){var t=e.tooltip,n=e.onClick,l=e.iconId,o=e.disabled,a=e.selected,r=e.children;return Zt.createElement("div",{className:"fortune-toolbar-button fortune-toolbar-item",onClick:n,"data-tips":t,role:"button",style:a?{backgroundColor:"#E7E5EB"}:{}},Zt.createElement(un,{name:l,style:o?{opacity:.3}:{}}),t&&Zt.createElement("div",{className:"fortune-tooltip"},t),r)};var Tn=function Divider(){return Zt.createElement("div",{className:"fortune-toolbar-divider fortune-toolbar-item"})};var Dn=function MenuDivider(){return Zt.createElement("div",{className:"fortune-toolbar-menu-divider"})};var In=function Combo(e){var t=e.tooltip,n=e.onClick,l=e.text,o=e.iconId,a=e.children;var r={userSelect:"none"};var i=Yt(false),c=_slicedToArray(i,2),u=c[0],s=c[1];var d=Yt({left:0}),v=_slicedToArray(d,2),m=v[0],f=v[1];var h=Xt(null);var p=Xt(null);useOutsideClick(h,(function(){s(false)}));Qt((function(){if(h.current){u||f({left:0});var e=window.innerWidth;var t=h.current.getBoundingClientRect();var n=t.width;var l=t.left;l+n>e&&f({left:-t.width+p.current.clientWidth})}}),[u]);return Zt.createElement("div",{className:"fortune-toobar-combo-container fortune-toolbar-item"},Zt.createElement("div",{ref:p,className:"fortune-toolbar-combo"},Zt.createElement("div",{className:"fortune-toolbar-combo-button",onClick:function onClick(e){n?n(e):s(!u)},"data-tips":t,role:"button",style:r},o?Zt.createElement(un,{name:o}):Zt.createElement("span",{className:"fortune-toolbar-combo-text"},l)),Zt.createElement("div",{className:"fortune-toolbar-combo-arrow",onClick:function onClick(){return s(!u)},"data-tips":t,role:"button",style:r},Zt.createElement(un,{name:"combo-arrow",width:10})),t&&Zt.createElement("div",{className:"fortune-tooltip"},t)),u&&Zt.createElement("div",{ref:h,className:"fortune-toolbar-combo-popup",style:m},a===null||a===void 0?void 0:a(s)))};var zn=function Select(e){var t=e.children,n=e.style;return Zt.createElement("div",{className:"fortune-toolbar-select",style:n},t)};var An=function Option(e){var t=e.iconId,n=e.onClick,l=e.children,o=e.onMouseLeave,a=e.onMouseEnter;return Zt.createElement("div",{onClick:n,className:"fortune-toolbar-select-option",onMouseLeave:function onMouseLeave(e){return o===null||o===void 0?void 0:o(e)},onMouseEnter:function onMouseEnter(e){return a===null||a===void 0?void 0:a(e)}},t&&Zt.createElement(un,{name:t}),Zt.createElement("div",{className:"fortuen-toolbar-text"},l))};var Bn=function FormulaSearch(e){var t=e.onCancel;var n=qt(cn),l=n.context,o=n.setContext,a=n.refs,r=a.cellInput,i=a.globalCache;var c=Yt(0),u=_slicedToArray(c,2),s=u[0],d=u[1];var v=Yt(0),m=_slicedToArray(v,2),f=m[0],h=m[1];var p=Yt(""),y=_slicedToArray(p,2),g=y[0],k=y[1];var E=C(l),b=E.formulaMore,w=E.functionlist,x=E.button;var _=Gt((function(){return[{t:0,n:b.Math},{t:1,n:b.Statistical},{t:2,n:b.Lookup},{t:3,n:b.luckysheet},{t:4,n:b.dataMining},{t:5,n:b.Database},{t:6,n:b.Date},{t:7,n:b.Filter},{t:8,n:b.Financial},{t:9,n:b.Engineering},{t:10,n:b.Logical},{t:11,n:b.Operator},{t:12,n:b.Text},{t:13,n:b.Parser},{t:14,n:b.Array},{t:-1,n:b.other}]}),[b]);var N=Gt((function(){if(g){var e=[];var t=an.cloneDeep(g.toUpperCase());for(var n=0;n<w.length;n+=1)/^[a-zA-Z]+$/.test(t)?w[n].n.indexOf(t)!==-1&&e.push(w[n]):w[n].a.indexOf(t)!==-1&&e.push(w[n]);return e}return an.filter(w,(function(e){return e.t===s}))}),[w,s,g]);var M=$t((function(){var e;var n=(e=l.luckysheet_select_save)===null||e===void 0?void 0:e[l.luckysheet_select_save.length-1];var a=n===null||n===void 0?void 0:n.row_focus;var c=n===null||n===void 0?void 0:n.column_focus;if(n){if(a==null){var u=_slicedToArray(n.row,1);a=u[0]}if(c==null){var s=_slicedToArray(n.column,1);c=s[0]}}else{a=0;c=0}var d='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'.concat(N[f].n.toUpperCase(),'</span><span dir="auto" class="luckysheet-formula-text-color">(</span>');o((function(e){if(r.current!=null){e.luckysheetCellUpdate=[a,c];i.doNotUpdateCell=true;r.current.innerHTML=d;var n=r.current.childNodes;an.isEmpty(n)||He(e,n[n.length-1],0,1);e.functionHint=N[f].n.toUpperCase();e.functionCandidates=[];if(an.isEmpty(e.formulaCache.functionlistMap))for(var l=0;l<w.length;l+=1)e.formulaCache.functionlistMap[w[l].n]=w[l];t()}}))}),[r,l.luckysheet_select_save,N,i,f,o,t,w]);var R=$t((function(){o((function(e){H(e);r.current&&(r.current.innerHTML="")}));t()}),[t,r,o]);return Zt.createElement("div",{id:"luckysheet-search-formula"},Zt.createElement("div",{className:"inpbox"},Zt.createElement("div",null,b.findFunctionTitle,"："),Zt.createElement("input",{className:"formulaInputFocus",id:"searchFormulaListInput",placeholder:b.tipInputFunctionName,spellCheck:"false",onChange:function onChange(e){return k(e.target.value)}})),Zt.createElement("div",{className:"selbox"},Zt.createElement("span",null,b.selectCategory,"："),Zt.createElement("select",{id:"formulaTypeSelect",onChange:function onChange(e){d(parseInt(e.target.value,10));h(0)}},_.map((function(e){return Zt.createElement("option",{key:e.t,value:e.t},e.n)})))),Zt.createElement("div",{className:"listbox",style:{height:200}},Zt.createElement("div",null,b.selectFunctionTitle,"："),Zt.createElement("div",{className:"formulaList"},N.map((function(e,t){return Zt.createElement("div",{className:"listBox".concat(t===f?" on":""),key:e.n,onClick:function onClick(){return h(t)}},Zt.createElement("div",null,e.n),Zt.createElement("div",null,e.a))})))),Zt.createElement("div",{className:"fortune-dialog-box-button-container"},Zt.createElement("div",{className:"fortune-message-box-button button-primary",onClick:M},x.confirm),Zt.createElement("div",{className:"fortune-message-box-button button-default",onClick:R},x.cancel)))};var Fn=function SplitColumn(){var e=qt(cn),t=e.context,n=e.setContext;var l=C(t),o=l.splitText,a=l.button;var i=Yt(""),c=_slicedToArray(i,2),u=c[0],s=c[1];var d=Yt(false),v=_slicedToArray(d,2),m=v[0],f=v[1];var h=Yt([]),p=_slicedToArray(h,2),y=p[0],g=p[1];var k=Xt(null);var E=useDialog(),b=E.showDialog,w=E.hideDialog;var x=$t((function(){w();var e=Te(u,t);var l=t.luckysheet_select_save[0].row[0];var a=t.luckysheet_select_save[0].column[0];if(e[0].length!==1){var i=false;var c=r(t);for(var s=0;s<e.length;s+=1)for(var d=1;d<e[0].length;d+=1){var v=c[l+s][a+d];if(!an.isNull(v)&&!an.isNull(v.v)){i=true;break}}i?b(o.splitConfirmToExe,"yesno",(function(){w();n((function(t){De(l,a,e,t)}))})):n((function(t){De(l,a,e,t)}))}}),[t,w,n,b,u,o.splitConfirmToExe]);Jt((function(){g((function(e){e=Te(u,t);return e}))}),[t,u]);return Zt.createElement("div",{id:"fortune-split-column"},Zt.createElement("div",{className:"title"},o.splitTextTitle),Zt.createElement("div",{className:"splitDelimiters"},o.splitDelimiters),Zt.createElement("div",{className:"splitSymbols",ref:k},o.splitSymbols.map((function(e){return Zt.createElement("div",{key:e.value,className:"splitSymbol"},Zt.createElement("input",{id:e.value,name:e.value,type:"checkbox",onClick:function onClick(){return s((function(e){var t;return Ie(e,(t=k.current)===null||t===void 0?void 0:t.childNodes)}))}}),Zt.createElement("label",{htmlFor:e.value},e.name))})),Zt.createElement("div",{className:"splitSymbol"},Zt.createElement("input",{id:"other",name:"other",type:"checkbox",onClick:function onClick(){f(!m);s((function(e){var t;return Ie(e,(t=k.current)===null||t===void 0?void 0:t.childNodes)}))}}),Zt.createElement("label",{htmlFor:"other"},o.splitOther),Zt.createElement("input",{id:"otherValue",name:"otherValue",type:"text",onBlur:function onBlur(){m&&s((function(e){var t;return Ie(e,(t=k.current)===null||t===void 0?void 0:t.childNodes)}))}})),Zt.createElement("div",{className:"splitSymbol splitSimple"},Zt.createElement("input",{id:"splitsimple",name:"splitsimple",type:"checkbox",onClick:function onClick(){s((function(e){var t;return Ie(e,(t=k.current)===null||t===void 0?void 0:t.childNodes)}))}}),Zt.createElement("label",{htmlFor:"splitsimple"},o.splitContinueSymbol))),Zt.createElement("div",{className:"splitDataPreview"},o.splitDataPreview),Zt.createElement("div",{className:"splitColumnData"},Zt.createElement("table",null,Zt.createElement("tbody",null,y.map((function(e,t){return e.length>=1?Zt.createElement("tr",{key:t},e.map((function(t){return Zt.createElement("td",{key:e+t},t)}))):Zt.createElement("tr",null,Zt.createElement("td",null))}))))),Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){x()}},a.confirm),Zt.createElement("div",{className:"button-basic button-close",onClick:function onClick(){w()}},a.cancel))};var Wn=function LocationCondition(){var e=qt(cn),t=e.context,n=e.setContext;var l=useDialog(),o=l.showDialog,a=l.hideDialog;var i=C(t),c=i.findAndReplace,u=i.button;var s=Yt("locationConstant"),d=_slicedToArray(s,2),v=d[0],m=d[1];var f=Yt({locationDate:true,locationDigital:true,locationString:true,locationBool:true,locationError:true}),h=_slicedToArray(f,2),p=h[0],y=h[1];var g=Yt({locationDate:true,locationDigital:true,locationString:true,locationBool:true,locationError:true}),k=_slicedToArray(g,2),E=k[0],b=k[1];var w=$t((function(){if(v==="locationConstant"){var e=ze(p);var l=Ae(t);n((function(t){var n=Be(l,v,e,t);n.length===0&&o(c.locationTipNotFindCell,"ok")}))}else if(v==="locationFormula"){var a=ze(E);var i=Ae(t);n((function(e){var t=Be(i,v,a,e);t.length===0&&o(c.locationTipNotFindCell,"ok")}))}else if(v==="locationRowSpan"){var u,s;if(((u=t.luckysheet_select_save)===null||u===void 0?void 0:u.length)===0||((s=t.luckysheet_select_save)===null||s===void 0?void 0:s.length)===1&&t.luckysheet_select_save[0].row[0]===t.luckysheet_select_save[0].row[1]){o(c.locationTiplessTwoRow,"ok");return}var d=an.assignIn([],t.luckysheet_select_save);n((function(e){var t=Be(d,v,void 0,e);t.length===0&&o(c.locationTipNotFindCell,"ok")}))}else if(v==="locationColumnSpan"){var m,f;if(((m=t.luckysheet_select_save)===null||m===void 0?void 0:m.length)===0||((f=t.luckysheet_select_save)===null||f===void 0?void 0:f.length)===1&&t.luckysheet_select_save[0].column[0]===t.luckysheet_select_save[0].column[1]){o(c.locationTiplessTwoColumn,"ok");return}var h=an.assignIn([],t.luckysheet_select_save);n((function(e){var t=Be(h,v,void 0,e);t.length===0&&o(c.locationTipNotFindCell,"ok")}))}else{var y,g;var k;if(((y=t.luckysheet_select_save)===null||y===void 0?void 0:y.length)===0||((g=t.luckysheet_select_save)===null||g===void 0?void 0:g.length)===1&&t.luckysheet_select_save[0].row[0]===t.luckysheet_select_save[0].row[1]&&t.luckysheet_select_save[0].column[0]===t.luckysheet_select_save[0].column[1]){var C=r(t,t.currentSheetId);k=[{row:[0,C.length-1],column:[0,C[0].length-1]}]}else k=an.assignIn([],t.luckysheet_select_save);n((function(e){var t=Be(k,v,void 0,e);t.length===0&&o(c.locationTipNotFindCell,"ok")}))}}),[v,p,t,c.locationTipNotFindCell,c.locationTiplessTwoColumn,c.locationTiplessTwoRow,E,n,o]);var x=$t((function(e){return v===e}),[v]);return Zt.createElement("div",{id:"fortune-location-condition"},Zt.createElement("div",{className:"title"},c.location),Zt.createElement("div",{className:"listbox"},Zt.createElement("div",{className:"listItem"},Zt.createElement("input",{type:"radio",name:"locationType",id:"locationConstant",checked:x("locationConstant"),onChange:function onChange(){m("locationConstant")}}),Zt.createElement("label",{htmlFor:"locationConstant"},c.locationConstant),Zt.createElement("div",{className:"subbox"},["locationDate","locationDigital","locationString","locationBool","locationError"].map((function(e){return Zt.createElement("div",{className:"subItem",key:e},Zt.createElement("input",{type:"checkbox",disabled:!x("locationConstant"),checked:p[e],onChange:function onChange(){y(tn((function(t){an.set(t,e,!t[e])})))}}),Zt.createElement("label",{htmlFor:e,style:{color:x("locationConstant")?"#000":"#666"}},c[e]))})))),Zt.createElement("div",{className:"listItem"},Zt.createElement("input",{type:"radio",name:"locationType",id:"locationFormula",checked:x("locationFormula"),onChange:function onChange(){m("locationFormula")}}),Zt.createElement("label",{htmlFor:"locationFormula"},c.locationFormula),Zt.createElement("div",{className:"subbox"},["locationDate","locationDigital","locationString","locationBool","locationError"].map((function(e){return Zt.createElement("div",{className:"subItem",key:e},Zt.createElement("input",{type:"checkbox",disabled:!x("locationFormula"),checked:E[e],onChange:function onChange(){b(tn((function(t){an.set(t,e,!t[e])})))}}),Zt.createElement("label",{htmlFor:e,style:{color:x("locationFormula")?"#000":"#666"}},c[e]))})))),["locationNull","locationRowSpan","locationColumnSpan"].map((function(e){return Zt.createElement("div",{className:"listItem",key:e},Zt.createElement("input",{type:"radio",name:e,checked:x(e),onChange:function onChange(){m(e)}}),Zt.createElement("label",{htmlFor:e},c[e]))}))),Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){a();w()}},u.confirm),Zt.createElement("div",{className:"button-basic button-close",onClick:function onClick(){a()}},u.cancel))};var Pn=function ConditionalFormat(e){var t=e.items,n=e.setOpen;var l=qt(cn),o=l.context,a=l.setContext,r=l.refs;var i=useDialog(),c=i.showDialog;var u=C(o),s=u.conditionformat;var d=$t((function(e){var t=e.target;var n=t.className==="fortune-toolbar-menu-line"?t.parentElement:t;var l=n.getBoundingClientRect();var o=r.workbookContainer.current.getBoundingClientRect();var a=n.querySelector(".condition-format-sub-menu");if(!an.isNil(a)){var i=window.getComputedStyle(n);var c=parseFloat(i.getPropertyValue("padding-right").replace("px",""));if(o.right-l.right<parseFloat(a.style.width.replace("px",""))){a.style.display="block";a.style.right="".concat(l.width-c,"px")}else{a.style.display="block";a.style.right="".concat(-(parseFloat(a.style.width.replace("px",""))+c),"px")}}}),[r.workbookContainer]);var v=$t((function(e){var t=e.target;if(t.className!=="condition-format-sub-menu"){var n=t.className==="condition-format-item"?t.parentElement:t.querySelector(".condition-format-sub-menu");an.isNil(n)||(n.style.display="none")}else t.style.display="none"}),[]);var m=$t((function(e){return e==="-"?Zt.createElement(Dn,{key:e}):e==="highlightCellRules"?Zt.createElement(An,{key:e,onMouseEnter:d,onMouseLeave:v},Zt.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},s[e],Zt.createElement(un,{name:"rightArrow",width:18}),Zt.createElement("div",{className:"condition-format-sub-menu",style:{display:"none",width:150}},[{text:"greaterThan",value:">"},{text:"lessThan",value:"<"},{text:"between",value:"[]"},{text:"equal",value:"="},{text:"textContains",value:"()"},{text:"occurrenceDate",value:s.yesterday},{text:"duplicateValue",value:"##"}].map((function(e){return Zt.createElement("div",{className:"condition-format-item",key:e.text,onClick:function onClick(){n(false);c(Zt.createElement(Mn,{type:e.text}))}},s[e.text],Zt.createElement("span",null,e.value))}))))):e==="itemSelectionRules"?Zt.createElement(An,{key:e,onMouseEnter:d,onMouseLeave:v},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},s[e],Zt.createElement(un,{name:"rightArrow",width:18}),Zt.createElement("div",{className:"condition-format-sub-menu",style:{display:"none",width:180}},[{text:"top10",value:s.top10},{text:"top10_percent",value:s.top10_percent},{text:"last10",value:s.last10},{text:"last10_percent",value:s.last10_percent},{text:"aboveAverage",value:s.above},{text:"belowAverage",value:s.below}].map((function(e){return Zt.createElement("div",{className:"condition-format-item",key:e.text,onClick:function onClick(){n(false);c(Zt.createElement(Mn,{type:e.text}))}},s[e.text],Zt.createElement("span",null,e.value))}))))):e==="dataBar"||e==="colorGradation"?Zt.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},s[e],Zt.createElement(un,{name:"rightArrow",width:18})):e==="icons"||e==="newFormatRule"?Zt.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},s[e]):e==="deleteRule"?Zt.createElement(An,{key:e,onMouseEnter:d,onMouseLeave:v},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},s[e],Zt.createElement(un,{name:"rightArrow",width:18}),Zt.createElement("div",{className:"condition-format-sub-menu",style:{display:"none",width:150}},["deleteSheetRule"].map((function(e){return Zt.createElement("div",{className:"condition-format-item",key:e,style:{padding:"6px 10px"},onClick:function onClick(){a((function(e){Fe(e,"delSheet")}))}},s[e])}))))):e==="manageRules"?Zt.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},s[e]):Zt.createElement("div",null)}),[s,v,a,n,c,d]);return Zt.createElement("div",{className:"condition-format"},Zt.createElement(zn,{style:{overflow:"visible"}},t.map((function(e){return Zt.createElement("div",{key:"option".concat(e)},m(e))}))))};var On=function CustomIcon(e){var t=e.iconName,n=e.width,l=n===void 0?24:n,o=e.height,a=o===void 0?24:o,r=e.content;var i=Gt((function(){return t?Zt.createElement("svg",{width:l,height:a},Zt.createElement("use",{xlinkHref:"#".concat(t)})):r||Zt.createElement("svg",{width:l,height:l},Zt.createElement("use",{xlinkHref:"#default"}))}),[r,a,t,l]);return Zt.createElement("div",{style:{width:l,height:a,display:"flex",justifyContent:"center",alignItems:"center"}},i)};var Un=function CustomButton(e){var t=e.tooltip,n=e.onClick,l=e.selected,o=e.children,a=e.iconName,r=e.icon;return Zt.createElement("div",{className:"fortune-toolbar-button fortune-toolbar-item",onClick:n,"data-tips":t,role:"button",style:l?{backgroundColor:"#E7E5EB"}:{}},Zt.createElement(On,{iconName:a,content:r}),t&&Zt.createElement("div",{className:"fortune-tooltip"},t),o)};var jn=[["#000000","#444444","#666666","#999999","#cccccc","#eeeeee","#f3f3f3","#ffffff"],["#f00f00","#f90f90","#ff0ff0","#0f00f0","#0ff0ff","#00f00f","#90f90f","#f0ff0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];var Kn=function ColorPicker(e){var t=e.onPick;return Zt.createElement("div",{className:"fortune-toolbar-color-picker"},jn.map((function(e,n){return Zt.createElement("div",{key:n,className:"fortune-toolbar-color-picker-row"},e.map((function(e){return Zt.createElement("div",{key:e,className:"fortune-toolbar-color-picker-item",onClick:function onClick(){return t(e)},style:{backgroundColor:e}})})))})))};var Zn=function CustomColor(e){var t=e.onCustomPick,n=e.onColorPick;var l=qt(cn),o=l.context;var a=C(o),r=a.toolbar,i=a.sheetconfig,c=a.button;var u=Yt("#000000"),s=_slicedToArray(u,2),d=s[0],v=s[1];return Zt.createElement("div",{id:"fortune-custom-color"},Zt.createElement("div",{className:"color-reset",onClick:function onClick(){return t(void 0)}},i.resetColor),Zt.createElement("div",{className:"custom-color"},Zt.createElement("div",null,r.customColor,":"),Zt.createElement("input",{type:"color",value:d,onChange:function onChange(e){return v(e.target.value)}}),Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){t(d)}},c.confirm)),Zt.createElement(Kn,{onPick:function onPick(e){n(e)}}))};var qn=[{Text:"1",value:"Thin",strokeDasharray:"1,0",strokeWidth:"1"},{Text:"2",value:"Hair",strokeDasharray:"1,5",strokeWidth:"1"},{Text:"3",value:"Dotted",strokeDasharray:"2,5",strokeWidth:"2"},{Text:"4",value:"Dashed",strokeDasharray:"5,5",strokeWidth:"2"},{Text:"5",value:"DashDot",strokeDasharray:"20,5,5,10,5,5",strokeWidth:"2"},{Text:"6",value:"DashDotDot",strokeDasharray:"20,5,5,5,5,10,5,5,5,5",strokeWidth:"2"},{Text:"8",value:"Medium",strokeDasharray:"2,0",strokeWidth:"2"},{Text:"9",value:"MediumDashed",strokeDasharray:"3,5",strokeWidth:"3"},{Text:"10",value:"MediumDashDot",strokeDasharray:"20,5,5,10,5,5",strokeWidth:"3"},{Text:"11",value:"MediumDashDotDot",strokeDasharray:"5,5,5,5,20,5,5,5,5,10",strokeWidth:"3"},{Text:"13",value:"Thick",strokeDasharray:"2,0",strokeWidth:"3"}];var Xn=function CustomBorder(e){var t=e.onPick;var n=qt(cn),l=n.context,o=n.refs;var a=C(l),r=a.border;var i=Yt("#000000"),c=_slicedToArray(i,2),u=c[0],s=c[1];var d=Yt("1"),v=_slicedToArray(d,2),m=v[0],f=v[1];var h=Xt(null);var p=Xt(null);var y=Xt(null);var g=Yt(""),k=_slicedToArray(g,2),E=k[0],b=k[1];var w=Yt(""),x=_slicedToArray(w,2),_=x[0],N=x[1];var M=$t((function(e){var t=e.target;var n=t.getBoundingClientRect();var l=t.querySelector(".fortune-border-select-menu");if(!an.isNil(l)){l.style.display="block";var a=o.workbookContainer.current.getBoundingClientRect();a.width-n.right>parseFloat(l.style.width.replace("px",""))?l.style.left="".concat(n===null||n===void 0?void 0:n.width,"px"):l.style.left="-".concat(l.style.width)}}),[o.workbookContainer]);var R=$t((function(){p.current.style.display="none";h.current.style.display="none"}),[]);var L=$t((function(e,t){b(e);N(t)}),[]);return Zt.createElement("div",null,Zt.createElement("div",{className:"fortune-border-select-option",key:"borderColor",onMouseEnter:function onMouseEnter(e){M(e)},onMouseLeave:function onMouseLeave(){R()}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},r.borderColor,Zt.createElement(un,{name:"rightArrow",style:{width:"14px"}})),Zt.createElement("div",{ref:y,className:"fortune-border-color-preview",style:{backgroundColor:u}}),Zt.createElement("div",{ref:h,className:"fortune-border-select-menu",style:{display:"none",width:"166px"}},Zt.createElement(Zn,{onCustomPick:function onCustomPick(e){t(e,m);y.current.style.backgroundColor=u;s(e)},onColorPick:function onColorPick(e){t(e,m);s(e)}}))),Zt.createElement("div",{className:"fortune-border-select-option",key:"borderStyle",onMouseEnter:function onMouseEnter(e){M(e)},onMouseLeave:function onMouseLeave(){R()}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},r.borderStyle,Zt.createElement(un,{name:"rightArrow",style:{width:"14px"}})),Zt.createElement("div",{className:"fortune-border-style-preview"},Zt.createElement("svg",{width:"90"},Zt.createElement("g",{fill:"none",stroke:"black",strokeWidth:E},Zt.createElement("path",{strokeDasharray:_,d:"M0 0 l90 0"})))),Zt.createElement("div",{ref:p,className:"fortune-border-select-menu fortune-toolbar-select",style:{display:"none",width:"110px"}},Zt.createElement("div",{className:"fortune-border-style-picker-menu fortune-border-style-reset",onClick:function onClick(){t(u,"1");L("1","1,0")}},r.borderDefault),Zt.createElement("div",{className:"fortune-boder-style-picker"},qn.map((function(e,n){return Zt.createElement("div",{key:n,className:"fortune-border-style-picker-menu",onClick:function onClick(){t(u,e.Text);f(e.Text);L(e.strokeWidth,e.strokeDasharray)}},Zt.createElement("svg",{height:"10",width:"90"},Zt.createElement("g",{fill:"none",stroke:"black",strokeWidth:e.strokeWidth},Zt.createElement("path",{strokeDasharray:e.strokeDasharray,d:"M0 5 l85 0"}))))}))))))};var Yn=function FormatSearch(e){var t=e.type,l=e.onCancel;var o=qt(cn),a=o.context,r=o.setContext,i=o.refs.cellInput;var c=Yt(2),u=_slicedToArray(c,2),s=u[0],d=u[1];var v=Yt(0),m=_slicedToArray(v,2),f=m[0],h=m[1];var p=C(a),y=p.button,g=p.format,k=p.currencyDetail,E=p.dateFmtList;var b=useDialog(),w=b.showDialog;var x=Gt((function(){return{currency:k,date:E,number:[]}}),[k,E]);var _=Gt((function(){return x[t]}),[x,t]);var N=an.get(g,t);var M=$t((function(){if(s<0||s>9){l();w(g.tipDecimalPlaces,"ok")}else r((function(e){var t=n(e,e.currentSheetId);if(!an.isNil(t)){var o=_[f].value;an.forEach(e.luckysheet_select_save,(function(n){for(var l=n.row[0];l<=n.row[1];l+=1)for(var a=n.column[0];a<=n.column[1];a+=1){var r,i,c,u;if(((r=e.luckysheetfile[t].data)===null||r===void 0?void 0:r[l][a])&&((i=e.luckysheetfile[t].data)===null||i===void 0||(c=i[l][a])===null||c===void 0||(u=c.ct)===null||u===void 0?void 0:u.t)==="n"){var d=0;e.luckysheetfile[t].data[l][a].ct.fa="".concat(o).concat(d.toFixed(s));e.luckysheetfile[t].data[l][a].m=We("".concat(o).concat(d.toFixed(s)),e.luckysheetfile[t].data[l][a].v)}}}));l()}}))}),[l,s,g.tipDecimalPlaces,f,r,w,_]);var R=$t((function(){r((function(e){H(e);i.current&&(i.current.innerHTML="")}));l()}),[l,i,r]);return Zt.createElement("div",{id:"luckysheet-search-format"},Zt.createElement("div",{className:"listbox",style:{height:200}},Zt.createElement("div",{style:{marginBottom:16}},N,g.format,"："),Zt.createElement("div",{className:"inpbox",style:t==="currency"?{display:"block"}:{display:"none"}},g.decimalPlaces,"：",Zt.createElement("input",{className:"decimal-places-input",id:"decimal-places-input",min:0,max:9,defaultValue:2,type:"number",onChange:function onChange(e){d(parseInt(e.target.value,10))}})),Zt.createElement("div",{className:"format-list"},_.map((function(e,t){return Zt.createElement("div",{className:"listBox".concat(t===f?" on":""),key:e.name,onClick:function onClick(){h(t)}},Zt.createElement("div",null,e.name),Zt.createElement("div",null,e.value))})))),Zt.createElement("div",{className:"fortune-dialog-box-button-container",style:t==="currency"?{marginTop:40}:{marginTop:30}},Zt.createElement("div",{className:"fortune-message-box-button button-primary",onClick:M},y.confirm),Zt.createElement("div",{className:"fortune-message-box-button button-default",onClick:R},y.cancel)))};var Gn=function Toolbar(e){var t,n,l;var o=e.setMoreItems,a=e.moreItemsOpen;var i=qt(cn),c=i.context,u=i.setContext,s=i.refs,d=i.settings,v=i.handleUndo,m=i.handleRedo;var f=Xt(c);var h=Xt(null);var p=Yt(-1),y=_slicedToArray(p,2),g=y[0],k=y[1];var E=Yt([]),b=_slicedToArray(E,2),w=b[0],x=b[1];var _=useDialog(),N=_.showDialog,M=_.hideDialog;var R=(t=c.luckysheet_select_save)===null||t===void 0?void 0:t[0];var L=r(c);f.current=c;var S=R===null||R===void 0?void 0:R.row_focus;var V=R===null||R===void 0?void 0:R.column_focus;var H=L&&S!=null&&V!=null?L===null||L===void 0||(n=L[S])===null||n===void 0?void 0:n[V]:void 0;var T=C(c),D=T.toolbar,I=T.merge,z=T.border,A=T.freezen,B=T.defaultFmt,F=T.formula,W=T.sort,P=T.align,O=T.textWrap,U=T.rotation,j=T.screenshot,K=T.filter,Z=T.splitText,q=T.findAndReplace,X=T.comment,Y=T.fontarray;var G=C(c).format;var $=c.luckysheetTableContentHW[0];var J=Yt("#000000"),Q=_slicedToArray(J,2),ee=Q[0],te=Q[1];var ne=Yt("1"),le=_slicedToArray(ne,2),oe=le[0],ae=le[1];var re=$t((function(e,t){var n=e.target;var l=n.className==="fortune-toolbar-menu-line"?n.parentElement:n;var o=l.getBoundingClientRect();var a=s.workbookContainer.current.getBoundingClientRect();var r=l.querySelector(".".concat(t));if(!an.isNil(r)){var i=window.getComputedStyle(l);var c=parseFloat(i.getPropertyValue("padding-right").replace("px",""));if(a.right-o.right<parseFloat(r.style.width.replace("px",""))){r.style.display="block";r.style.right="".concat(o.width-c,"px")}else{r.style.display="block";r.style.right=t==="more-format"?"".concat(-(parseFloat(r.style.width.replace("px",""))+0),"px"):"".concat(-(parseFloat(r.style.width.replace("px",""))+c),"px")}}}),[s.workbookContainer]);var ie=$t((function(e,t){var n=e.target;if(n.className!=="".concat(t)){var l=n.className==="condition-format-item"?n.parentElement:n.querySelector(".".concat(t));an.isNil(l)||(l.style.display="none")}else n.style.display="none"}),[]);Jt((function(){k(-1)}),[d.toolbarItems,d.customToolbarItems]);Jt((function(){if(g===-1){var e=h.current;if(!e)return;var t=e.querySelectorAll(".fortune-toolbar-item");if(!t)return;var n=[];var l=e.getBoundingClientRect();for(var o=0;o<t.length;o+=1){var a=t[o];var r=a.getBoundingClientRect();n.push(r.left-l.left+r.width)}x(n)}}),[g,$]);Jt((function(){if(w.length!==0){var e=h.current;if(e){var t=50;for(var n=w.length-1;n>=0;n-=1){var l=w[n];if(l+t<e.clientWidth){k(n-w.length+d.toolbarItems.length);n===w.length-1&&o(null);break}}}}}),[w,o,d.toolbarItems.length,$]);var ce=$t((function(e,t){var n;var l=D[e];if(e==="|")return Zt.createElement(Tn,{key:t});if(["font-color","background"].includes(e)){var o=function pick(t){u((function(n){return(e==="font-color"?Pe:Oe)(n,s.cellInput.current,t)}));e==="font-color"?s.globalCache.recentTextColor=t:s.globalCache.recentBackgroundColor=t};return Zt.createElement("div",{style:{position:"relative"},key:e},Zt.createElement("div",{style:{width:17,height:2,backgroundColor:e==="font-color"?s.globalCache.recentTextColor:s.globalCache.recentBackgroundColor,position:"absolute",bottom:8,left:9,zIndex:100}}),Zt.createElement(In,{iconId:e,tooltip:l,onClick:function onClick(){var t=e==="font-color"?s.globalCache.recentTextColor:s.globalCache.recentBackgroundColor;t&&o(t)}},(function(e){return Zt.createElement(Zn,{onCustomPick:function onCustomPick(t){o(t);e(false)},onColorPick:o})})))}if(e==="format"){var a=B[0].text;if(H){var i=Ue(H,"ct");var d=an.find(B,(function(e){return e.value===(i===null||i===void 0?void 0:i.fa)}));(i===null||i===void 0?void 0:i.fa)!=null&&(a=d!=null?d.text:B[B.length-1].text)}return Zt.createElement(In,{text:a,key:e,tooltip:l},(function(e){return Zt.createElement(zn,null,B.map((function(t,n){var l=t.text,o=t.value,a=t.example;return o==="split"?Zt.createElement(Dn,{key:n}):o==="fmtOtherSelf"?Zt.createElement(An,{key:o,onMouseEnter:function onMouseEnter(e){return re(e,"more-format")},onMouseLeave:function onMouseLeave(e){return ie(e,"more-format")}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},Zt.createElement("div",null,l),Zt.createElement(un,{name:"rightArrow",width:14})),Zt.createElement("div",{className:"more-format toolbar-item-sub-menu fortune-toolbar-select",style:{display:"none",width:150,bottom:10,top:void 0}},[{text:G.moreCurrency,onclick:function onclick(){N(Zt.createElement(Yn,{onCancel:M,type:"currency"}));e(false)}}].map((function(t){return Zt.createElement("div",{className:"set-background-item fortune-toolbar-select-option",key:t.text,onClick:function onClick(){t.onclick();e(false)}},t.text)})))):Zt.createElement(An,{key:o,onClick:function onClick(){e(false);u((function(e){var t=r(e);t!=null&&je(e,s.cellInput.current,t,"ct",o)}))}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},Zt.createElement("div",null,l),Zt.createElement("div",{className:"fortune-toolbar-subtext"},a)))})))}))}if(e==="font"){var h=Y[0];(H===null||H===void 0?void 0:H.ff)!=null&&(h=an.isNumber(H.ff)?Y[H.ff]:H.ff);return Zt.createElement(In,{text:h,key:e,tooltip:l},(function(e){return Zt.createElement(zn,null,Y.map((function(t){return Zt.createElement(An,{key:t,onClick:function onClick(){u((function(e){h=t;var n=r(e);n&&je(e,s.cellInput.current,n,"ff",t)}));e(false)}},t)})))}))}if(e==="font-size")return Zt.createElement(In,{text:H?Ue(H,"fs",c.defaultFontSize):c.defaultFontSize.toString(),key:e,tooltip:l},(function(e){return Zt.createElement(zn,null,[9,10,11,12,14,16,18,20,22,24,26,28,36,48,72].map((function(t){return Zt.createElement(An,{key:t,onClick:function onClick(){u((function(e){return Ke(e,s.cellInput.current,t,s.canvas.current.getContext("2d"))}));e(false)}},t)})))}));if(e==="horizontal-align"){var p;var y=[{title:"align-left",text:P.left,value:1},{title:"align-center",text:P.center,value:0},{title:"align-right",text:P.right,value:2}];return Zt.createElement(In,{iconId:((p=an.find(y,(function(e){return"".concat(e.value)==="".concat(H===null||H===void 0?void 0:H.ht)})))===null||p===void 0?void 0:p.title)||"align-left",key:e,tooltip:D.horizontalAlign},(function(e){return Zt.createElement(zn,null,y.map((function(t){var n=t.text,l=t.title;return Zt.createElement(An,{key:l,onClick:function onClick(){u((function(e){Ze(e,s.cellInput.current,l.replace("align-",""))}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},n,Zt.createElement(un,{name:l})))})))}))}if(e==="vertical-align"){var g;var k=[{title:"align-top",text:P.top,value:1},{title:"align-middle",text:P.middle,value:0},{title:"align-bottom",text:P.bottom,value:2}];return Zt.createElement(In,{iconId:((g=an.find(k,(function(e){return"".concat(e.value)==="".concat(H===null||H===void 0?void 0:H.vt)})))===null||g===void 0?void 0:g.title)||"align-top",key:e,tooltip:D.verticalAlign},(function(e){return Zt.createElement(zn,null,k.map((function(t){var n=t.text,l=t.title;return Zt.createElement(An,{key:l,onClick:function onClick(){u((function(e){qe(e,s.cellInput.current,l.replace("align-",""))}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},n,Zt.createElement(un,{name:l})))})))}))}if(e==="undo")return Zt.createElement(Hn,{iconId:e,tooltip:l,key:e,disabled:s.globalCache.undoList.length===0,onClick:function onClick(){return v()}});if(e==="redo")return Zt.createElement(Hn,{iconId:e,tooltip:l,key:e,disabled:s.globalCache.redoList.length===0,onClick:function onClick(){return m()}});if(e==="screenshot")return Zt.createElement(Hn,{iconId:e,tooltip:l,key:e,onClick:function onClick(){var e=Xe(f.current);e&&N(Zt.createElement("div",null,Zt.createElement("div",null,j.screenshotTipSuccess),Zt.createElement("img",{src:e,alt:"",style:{maxWidth:"100%",maxHeight:"100%"}})))}});if(e==="splitColumn")return Zt.createElement(Hn,{iconId:e,tooltip:l,key:e,onClick:function onClick(){if(c.allowEdit!==false)if(an.isUndefined(c.luckysheet_select_save))N(Z.tipNoSelect,"ok");else{var e=c.luckysheet_select_save[c.luckysheet_select_save.length-1].column;c.luckysheet_select_save.length>1?N(Z.tipNoMulti,"ok"):e[0]!==e[1]?N(Z.tipNoMultiColumn,"ok"):N(Zt.createElement(Fn,null))}}});if(e==="dataVerification")return Zt.createElement(Hn,{iconId:e,tooltip:l,key:e,onClick:function onClick(){c.allowEdit!==false&&N(Zt.createElement(Nn,null))}});if(e==="locationCondition"){var E=[{text:q.location,value:"location"},{text:q.locationFormula,value:"locationFormula"},{text:q.locationDate,value:"locationDate"},{text:q.locationDigital,value:"locationDigital"},{text:q.locationString,value:"locationString"},{text:q.locationError,value:"locationError"},{text:q.locationRowSpan,value:"locationRowSpan"},{text:q.columnSpan,value:"locationColumnSpan"}];return Zt.createElement(In,{iconId:"locationCondition",key:e,tooltip:q.location},(function(e){return Zt.createElement(zn,null,E.map((function(t){var n=t.text,l=t.value;return Zt.createElement(An,{key:l,onClick:function onClick(){var t,n;if(c.luckysheet_select_save!=null){var o=c.luckysheet_select_save[0];var a;var r=[];a=((t=c.luckysheet_select_save)===null||t===void 0?void 0:t.length)===0||((n=c.luckysheet_select_save)===null||n===void 0?void 0:n.length)===1&&o.row[0]===o.row[1]&&o.column[0]===o.column[1]?[{row:[0,L.length-1],column:[0,L[0].length-1]}]:an.assignIn([],c.luckysheet_select_save);if(l==="location")N(Zt.createElement(Wn,null));else if(l==="locationFormula")u((function(e){r=Be(a,"locationFormula","all",e)}));else if(l==="locationDate")u((function(e){r=Be(a,"locationConstant","d",e)}));else if(l==="locationDigital")u((function(e){r=Be(a,"locationConstant","n",e)}));else if(l==="locationString")u((function(e){r=Be(a,"locationConstant","s,g",e)}));else if(l==="locationError")u((function(e){r=Be(a,"locationConstant","e",e)}));else if(l==="locationCondition")u((function(e){r=Be(a,"locationCF",void 0,e)}));else if(l==="locationRowSpan"){var i,s;if(((i=c.luckysheet_select_save)===null||i===void 0?void 0:i.length)===0||((s=c.luckysheet_select_save)===null||s===void 0?void 0:s.length)===1&&c.luckysheet_select_save[0].row[0]===c.luckysheet_select_save[0].row[1]){N(q.locationTiplessTwoRow,"ok");return}a=an.assignIn([],c.luckysheet_select_save);u((function(e){r=Be(a,"locationRowSpan",void 0,e)}))}else if(l==="locationColumnSpan"){var d,v;if(((d=c.luckysheet_select_save)===null||d===void 0?void 0:d.length)===0||((v=c.luckysheet_select_save)===null||v===void 0?void 0:v.length)===1&&c.luckysheet_select_save[0].column[0]===c.luckysheet_select_save[0].column[1]){N(q.locationTiplessTwoColumn,"ok");return}a=an.assignIn([],c.luckysheet_select_save);u((function(e){r=Be(a,"locationColumnSpan",void 0,e)}))}r.length===0&&l!=="location"&&N(q.locationTipNotFindCell,"ok");e(false)}else N(A.noSeletionError,"ok")}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},n))})))}))}if(e==="conditionFormat"){var C=["highlightCellRules","itemSelectionRules","-","deleteRule"];return Zt.createElement(In,{iconId:"conditionFormat",key:e,tooltip:D.conditionalFormat},(function(e){return Zt.createElement(Pn,{items:C,setOpen:e})}))}if(e==="image")return Zt.createElement(Hn,{iconId:e,tooltip:D.insertImage,key:e,onClick:function onClick(){c.allowEdit!==false&&Ye()}},Zt.createElement("input",{id:"fortune-img-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:function onChange(e){var t;var n=(t=e.currentTarget.files)===null||t===void 0?void 0:t[0];if(n){var l=new FileReader;l.readAsDataURL(n);l.onload=function(e){var t;if(e.target!=null){var n=(t=e.target)===null||t===void 0?void 0:t.result;var l=new Image;l.onload=function(){u((function(e){Ge(e,l)}))};l.src=n}};e.currentTarget.value=""}}}));if(e==="comment"){var b,w,x;var _=(b=c.luckysheet_select_save)===null||b===void 0?void 0:b[c.luckysheet_select_save.length-1];var R=_===null||_===void 0?void 0:_.row_focus;var S=_===null||_===void 0?void 0:_.column_focus;if(_){if(R==null){var V=_slicedToArray(_.row,1);R=V[0]}if(S==null){var T=_slicedToArray(_.column,1);S=T[0]}}else{R=0;S=0}var $;$=(L===null||L===void 0||(w=L[R])===null||w===void 0||(x=w[S])===null||x===void 0?void 0:x.ps)!=null?[{key:"edit",text:X.edit,onClick:$e},{key:"delete",text:X.delete,onClick:Je},{key:"showOrHide",text:X.showOne,onClick:Qe},{key:"showOrHideAll",text:X.showAll,onClick:et}]:[{key:"new",text:X.insert,onClick:tt},{key:"showOrHideAll",text:X.showAll,onClick:et}];return Zt.createElement(In,{iconId:e,key:e,tooltip:l},(function(e){return Zt.createElement(zn,null,$.map((function(t){var n=t.key,l=t.text,o=t.onClick;return Zt.createElement(An,{key:n,onClick:function onClick(){u((function(e){return o(e,s.globalCache,R,S)}));e(false)}},l)})))}))}if(e==="quick-formula"){var J=[{text:F.sum,value:"SUM"},{text:F.average,value:"AVERAGE"},{text:F.count,value:"COUNT"},{text:F.max,value:"MAX"},{text:F.min,value:"MIN"}];return Zt.createElement(In,{iconId:"formula-sum",key:e,tooltip:D.autoSum,onClick:function onClick(){return u((function(e){nt(e,s.cellInput.current,s.fxInput.current,s.globalCache)}))}},(function(e){return Zt.createElement(zn,null,J.map((function(t){var n=t.value,l=t.text;return Zt.createElement(An,{key:n,onClick:function onClick(){u((function(e){lt(e,s.cellInput.current,s.fxInput.current,n,s.globalCache)}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},Zt.createElement("div",null,l),Zt.createElement("div",{className:"fortune-toolbar-subtext"},n)))})),Zt.createElement(Dn,null),Zt.createElement(An,{key:"formula",onClick:function onClick(){N(Zt.createElement(Bn,{onCancel:M}));e(false)}},"".concat(F.find,"...")))}))}if(e==="merge-cell"){var Q=[{text:I.mergeAll,value:"merge-all"},{text:I.mergeV,value:"merge-vertical"},{text:I.mergeH,value:"merge-horizontal"},{text:I.mergeCancel,value:"merge-cancel"}];return Zt.createElement(In,{iconId:"merge-all",key:e,tooltip:l,text:"合并单元格",onClick:function onClick(){return u((function(e){ot(e,"merge-all")}))}},(function(e){return Zt.createElement(zn,null,Q.map((function(t){var n=t.text,l=t.value;return Zt.createElement(An,{key:l,onClick:function onClick(){u((function(e){ot(e,l)}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},Zt.createElement(un,{name:l,style:{marginRight:4}}),n))})))}))}if(e==="border"){var ne=[{text:z.borderTop,value:"border-top"},{text:z.borderBottom,value:"border-bottom"},{text:z.borderLeft,value:"border-left"},{text:z.borderRight,value:"border-right"},{text:"",value:"divider"},{text:z.borderNone,value:"border-none"},{text:z.borderAll,value:"border-all"},{text:z.borderOutside,value:"border-outside"},{text:"",value:"divider"},{text:z.borderInside,value:"border-inside"},{text:z.borderHorizontal,value:"border-horizontal"},{text:z.borderVertical,value:"border-vertical"},{text:z.borderSlash,value:"border-slash"},{text:"",value:"divider"}];return Zt.createElement(In,{iconId:"border-all",key:e,tooltip:l,text:"边框设置",onClick:function onClick(){return u((function(e){at(e,"border-all",ee,oe)}))}},(function(e){return Zt.createElement(zn,null,ne.map((function(t,n){var l=t.text,o=t.value;return o!=="divider"?Zt.createElement(An,{key:o,onClick:function onClick(){u((function(e){at(e,o,ee,oe)}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},l,Zt.createElement(un,{name:o}))):Zt.createElement(Dn,{key:n})})),Zt.createElement(Xn,{onPick:function onPick(e,t){te(e);ae(t)}}))}))}if(e==="freeze"){var le=[{text:A.freezenRowRange,value:"freeze-row"},{text:A.freezenColumnRange,value:"freeze-col"},{text:A.freezenRCRange,value:"freeze-row-col"},{text:A.freezenCancel,value:"freeze-cancel"}];return Zt.createElement(In,{iconId:"freeze-row-col",key:e,tooltip:l,onClick:function onClick(){return u((function(e){rt(e,"freeze-row-col")}))}},(function(e){return Zt.createElement(zn,null,le.map((function(t){var n=t.text,l=t.value;return Zt.createElement(An,{key:l,onClick:function onClick(){u((function(e){rt(e,l)}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},n,Zt.createElement(un,{name:l})))})))}))}if(e==="text-wrap"){var ce=[{text:O.clip,iconId:"text-clip",value:"clip"},{text:O.overflow,iconId:"text-overflow",value:"overflow"},{text:O.wrap,iconId:"text-wrap",value:"wrap"}];var ue=ce[0];(H===null||H===void 0?void 0:H.tb)!=null&&(ue=an.get(ce,H.tb));return Zt.createElement(In,{iconId:ue.iconId,key:e,tooltip:D.textWrap},(function(e){return Zt.createElement(zn,null,ce.map((function(t){var n=t.text,l=t.iconId,o=t.value;return Zt.createElement(An,{key:o,onClick:function onClick(){u((function(e){var t=r(e);t!=null&&je(e,s.cellInput.current,t,"tb",o)}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},n,Zt.createElement(un,{name:l})))})))}))}if(e==="text-rotation"){var se=[{text:U.none,iconId:"text-rotation-none",value:"none"},{text:U.angleup,iconId:"text-rotation-angleup",value:"angleup"},{text:U.angledown,iconId:"text-rotation-angledown",value:"angledown"},{text:U.vertical,iconId:"text-rotation-vertical",value:"vertical"},{text:U.rotationUp,iconId:"text-rotation-up",value:"rotation-up"},{text:U.rotationDown,iconId:"text-rotation-down",value:"rotation-down"}];var de=se[0];(H===null||H===void 0?void 0:H.tr)!=null&&(de=an.get(se,H.tr));return Zt.createElement(In,{iconId:de.iconId,key:e,tooltip:D.textRotate},(function(e){return Zt.createElement(zn,null,se.map((function(t){var n=t.text,l=t.iconId,o=t.value;return Zt.createElement(An,{key:o,onClick:function onClick(){u((function(e){var t=r(e);t!=null&&je(e,s.cellInput.current,t,"tr",o)}));e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},n,Zt.createElement(un,{name:l})))})))}))}if(e==="filter"){var ve=[{iconId:"sort-asc",value:"sort-asc",text:W.asc,onClick:function onClick(){u((function(e){it(e,true)}))}},{iconId:"sort-desc",value:"sort-desc",text:W.desc,onClick:function onClick(){u((function(e){it(e,false)}))}},{iconId:"",value:"divider"},{iconId:"filter1",value:"filter",text:K.filter,onClick:function onClick(){return u((function(e){ct(e)}))}},{iconId:"eraser",value:"eraser",text:K.clearFilter,onClick:function onClick(){return u((function(e){ut(e)}))}}];return Zt.createElement(In,{iconId:"filter",key:e,tooltip:D.sortAndFilter},(function(e){return Zt.createElement(zn,null,ve.map((function(t,n){var l=t.text,o=t.iconId,a=t.value,r=t.onClick;return a!=="divider"?Zt.createElement(An,{key:a,onClick:function onClick(){r===null||r===void 0?void 0:r();e(false)}},Zt.createElement("div",{className:"fortune-toolbar-menu-line"},l,Zt.createElement(un,{name:o}))):Zt.createElement(Dn,{key:"divider-".concat(n)})})))}))}return Zt.createElement(Hn,{iconId:e,tooltip:l,key:e,selected:(n=st(e))===null||n===void 0?void 0:n(H),onClick:function onClick(){return u((function(t){var n;(n=dt(e))===null||n===void 0?void 0:n(t,s.cellInput.current,s.globalCache)}))}})}),[D,H,u,s.cellInput,s.fxInput,s.globalCache,B,P,v,m,L,F,N,M,I,z,A,j,W,O,U,K,Z,q,c.luckysheet_select_save,c.defaultFontSize,c.allowEdit,X,Y,ie,re,s.canvas,ee,oe,G.moreCurrency]);return Zt.createElement("div",{ref:h,className:"fortune-toolbar"},d.customToolbarItems.map((function(e){return Zt.createElement(Un,{tooltip:e.tooltip,onClick:e.onClick,key:e.key,icon:e.icon,iconName:e.iconName},e.children)})),((l=d.customToolbarItems)===null||l===void 0?void 0:l.length)>0?Zt.createElement(Tn,{key:"customDivider"}):null,(g===-1?d.toolbarItems:d.toolbarItems.slice(0,g+1)).map((function(e,t){return ce(e,t)})),g!==-1&&g<d.toolbarItems.length-1?Zt.createElement(Hn,{iconId:"more",tooltip:D.toolMore,onClick:function onClick(){o(a?null:d.toolbarItems.slice(g+1).map((function(e,t){return ce(e,t)})))}}):null)};var $n=function LocationBox(){var e=qt(cn),t=e.context;var n=Gt((function(){var e=an.last(t.luckysheet_select_save);if(!(e&&e.row_focus!=null&&e.column_focus!=null))return"";var n=e.row_focus;var l=e.column_focus;return t.config.merge!=null&&"".concat(n,"_").concat(l)in t.config.merge?K(t,t.currentSheetId,{column:[l,l],row:[n,n]}):K(t,t.currentSheetId,e)}),[t.currentSheetId,t.luckysheet_select_save]);return Zt.createElement("div",{className:"fortune-name-box-container"},Zt.createElement("div",{className:"fortune-name-box",tabIndex:0,dir:"ltr","aria-autocomplete":"list"},n))};var Jn=function FxEditor(){var e;var t=qt(cn),n=t.context,l=t.setContext,o=t.refs;var a=Yt(false),c=_slicedToArray(a,2),u=c[0],s=c[1];var d=Xt();var v=Xt(null);var m=Yt(false),f=_slicedToArray(m,2),h=f[0],p=f[1];var y=(e=n.luckysheet_select_save)===null||e===void 0?void 0:e[0];var g=usePrevious(y);var k=usePrevious(n.currentSheetId);var E=Xt("");Jt((function(){p(V(n));if(!an.isEqual(g,y)||n.currentSheetId!==k){var e=r(n);var t="";if(y){var l;var a=y.row_focus;var i=y.column_focus;if(an.isNil(a)||an.isNil(i))return;var c=e===null||e===void 0||(l=e[a])===null||l===void 0?void 0:l[i];c&&(t=_(c)?vt(a,i,e):c.f?w(a,i,e,"f"):M(a,i,e));o.fxInput.current.innerHTML=L(R(t))}else o.fxInput.current.innerHTML=""}}),[n.luckysheetfile,n.currentSheetId,n.luckysheet_select_save]);var C=$t((function(){var e,t;if(n.allowEdit!==false&&((e=(t=n.luckysheet_select_save)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0)>0&&!n.luckysheet_cell_selected_move&&i(n,n.luckysheet_select_save)){s(true);l((function(e){var t=e.luckysheet_select_save[e.luckysheet_select_save.length-1];var n=t.row_focus;var l=t.column_focus;e.luckysheetCellUpdate=[n,l];o.globalCache.doNotFocus=true}))}}),[n.config,n.luckysheet_select_save,n.luckysheetfile,n.currentSheetId,o.globalCache,l]);var b=$t((function(e){if(n.allowEdit!==false){d.current=new KeyboardEvent(e.type,e.nativeEvent);var t=e.key;E.current=o.fxInput.current.innerText;t!=="ArrowLeft"&&t!=="ArrowRight"||e.stopPropagation();l((function(l){if(n.luckysheetCellUpdate.length>0)switch(t){case"Enter":var a=an.clone(l.luckysheetCellUpdate);D(l,l.luckysheetCellUpdate[0],l.luckysheetCellUpdate[1],o.fxInput.current);l.luckysheet_select_save=[{row:[a[0],a[0]],column:[a[1],a[1]],row_focus:a[0],column_focus:a[1]}];T(l,"down",1,"rangeOfSelect");e.preventDefault();e.stopPropagation();break;case"Escape":H(l);T(l,"down",0,"rangeOfSelect");e.preventDefault();e.stopPropagation();break;case"ArrowLeft":mt(l,o.fxInput.current);break;case"ArrowRight":mt(l,o.fxInput.current);break}}))}}),[n.allowEdit,n.luckysheetCellUpdate.length,o.fxInput,l]);var x=$t((function(){var e=d.current;if(e){var t=e.keyCode;t&&(!(t>=112&&t<=123||t<=46||t===144||t===108||e.ctrlKey||e.altKey||e.shiftKey&&(t===37||t===38||t===39||t===40))||t===8||t===32||t===46||e.ctrlKey&&t===86)&&l((function(e){z(e,o.cellInput.current,o.fxInput.current,t,E.current)}))}}),[o.cellInput,o.fxInput,l]);var N=Gt((function(){return n.allowEdit!==false&&(!h&&!!i(n,n.luckysheet_select_save))}),[n.config,n.luckysheet_select_save,n.luckysheetfile,n.currentSheetId,h]);return Zt.createElement("div",{className:"fortune-fx-editor"},Zt.createElement($n,null),Zt.createElement("div",{className:"fortune-fx-icon"},Zt.createElement(un,{name:"fx",width:18,height:18})),Zt.createElement("div",{ref:v,className:"fortune-fx-input-container"},Zt.createElement(vn,{innerRef:function innerRef(e){o.fxInput.current=e},className:"fortune-fx-input",id:"luckysheet-functionbox-cell","aria-autocomplete":"list",onFocus:C,onKeyDown:b,onChange:x,onBlur:function onBlur(){return s(false)},tabIndex:0,allowEdit:N}),u&&Zt.createElement(Zt.Fragment,null,Zt.createElement(mn,{style:{top:v.current.clientHeight}}),Zt.createElement(fn,{style:{top:v.current.clientHeight}}))))};var Qn=function SheetItem(e){var t=e.sheet,n=e.isDropPlaceholder;var l=qt(cn),o=l.context,a=l.setContext,r=l.refs;var i=Yt(false),c=_slicedToArray(i,2),u=c[0],s=c[1];var d=Xt(null);var v=Xt(null);var m=Yt(false),f=_slicedToArray(m,2),h=f[0],p=f[1];var y=Yt("#c3c3c3"),g=_slicedToArray(y,2),k=g[0],E=g[1];var C=useAlert(),b=C.showAlert;Jt((function(){a((function(e){var t=o.sheetScrollRecord[e===null||e===void 0?void 0:e.currentSheetId];if(t){var n,l,a,r;e.scrollLeft=(n=t.scrollLeft)!==null&&n!==void 0?n:0;e.scrollTop=(l=t.scrollTop)!==null&&l!==void 0?l:0;e.luckysheet_select_status=(a=t.luckysheet_select_status)!==null&&a!==void 0&&a;e.luckysheet_select_save=(r=t.luckysheet_select_save)!==null&&r!==void 0?r:void 0}else{e.scrollLeft=0;e.scrollTop=0;e.luckysheet_select_status=false;e.luckysheet_select_save=void 0}e.luckysheet_selection_range=[]}))}),[o.currentSheetId,o.sheetScrollRecord,a]);Jt((function(){if(v.current){if(u)if(window.getSelection){var e=document.createRange();e.selectNodeContents(v.current);if(e.startContainer&&document.body.contains(e.startContainer)){var t=window.getSelection();t===null||t===void 0?void 0:t.removeAllRanges();t===null||t===void 0?void 0:t.addRange(e)}}else if(document.selection){var n=document.body.createTextRange();n.moveToElementText(v.current);n.select()}v.current.dataset.oldText=v.current.innerText}}),[u]);var w=$t((function(){a((function(e){try{ft(e,v.current)}catch(e){b(e.message)}}));s(false)}),[a,b]);var x=$t((function(e){if(e.key==="Enter"){var t;(t=v.current)===null||t===void 0?void 0:t.blur()}e.stopPropagation()}),[]);var _=$t((function(e){o.allowEdit===true&&e.dataTransfer.setData("sheetId","".concat(t.id));e.stopPropagation()}),[o.allowEdit,t.id]);var N=$t((function(e){if(o.allowEdit!==false){var l=e.dataTransfer.getData("sheetId");a((function(e){var o=t.id;var a;var r;an.sortBy(e.luckysheetfile,["order"]).forEach((function(e,t){e.order=t;e.id===l?a=e:e.id===o&&(r=e)}));if(a&&r){a.order=r.order-.1;an.sortBy(e.luckysheetfile,["order"]).forEach((function(e,t){e.order=t}))}else a&&n&&(a.order=e.luckysheetfile.length)}));p(false);e.stopPropagation()}}),[o.allowEdit,n,a,t.id]);return Zt.createElement("div",{onDragOver:function onDragOver(e){e.preventDefault();e.stopPropagation()},onDragEnter:function onDragEnter(e){p(true);e.stopPropagation()},onDragLeave:function onDragLeave(e){p(false);e.stopPropagation()},onDragEnd:function onDragEnd(e){p(false);e.stopPropagation()},onDrop:N,onDragStart:_,draggable:o.allowEdit&&!u,key:t.id,ref:d,className:n?"fortune-sheettab-placeholder":"luckysheet-sheets-item".concat(o.currentSheetId===t.id?" luckysheet-sheets-item-active":""),onClick:function onClick(){n||a((function(e){e.sheetScrollRecord[e.currentSheetId]={scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,luckysheet_select_status:e.luckysheet_select_status,luckysheet_select_save:e.luckysheet_select_save,luckysheet_selection_range:e.luckysheet_selection_range};e.dataVerificationDropDownList=false;e.currentSheetId=t.id;e.zoomRatio=t.zoomRatio||1;ht(e,r.globalCache);H(e)}))},onContextMenu:function onContextMenu(e){if(!n){var l=r.workbookContainer.current.getBoundingClientRect();var o=e.pageX,i=e.pageY;a((function(e){e.dataVerificationDropDownList=false;e.currentSheetId=t.id;e.zoomRatio=t.zoomRatio||1;e.sheetTabContextMenu={x:o-l.left-window.scrollX,y:i-l.top-window.scrollY,sheet:t,onRename:function onRename(){return s(true)}}}))}},style:{borderLeft:h?"2px solid #0188fb":"",display:t.hide===1?"none":""}},Zt.createElement("span",{className:"luckysheet-sheets-item-name",spellCheck:"false",suppressContentEditableWarning:true,contentEditable:!n&&u,onDoubleClick:function onDoubleClick(){return s(true)},onBlur:w,onKeyDown:x,ref:v,style:h?{pointerEvents:"none"}:{}},t.name),Zt.createElement("span",{className:"luckysheet-sheets-item-function",onMouseEnter:function onMouseEnter(){return E("#5c5c5c")},onMouseLeave:function onMouseLeave(){return E("#c3c3c3")},onClick:function onClick(e){if(!n&&o.allowEdit!==false){var l=r.workbookContainer.current.getBoundingClientRect();var i=e.pageX,c=e.pageY;a((function(e){e.currentSheetId=t.id;e.sheetTabContextMenu={x:i-l.left-window.scrollX,y:c-l.top-window.scrollY,sheet:t,onRename:function onRename(){return s(true)}}}))}}},Zt.createElement(un,{name:"downArrow",width:12,style:{fill:k}})),!!t.color&&Zt.createElement("div",{className:"luckysheet-sheets-item-color",style:{background:t.color}}))};var el=[{text:"10%",value:.1},{text:"30%",value:.3},{text:"50%",value:.5},{text:"70%",value:.7},{text:"100%",value:1},{text:"150%",value:1.5},{text:"200%",value:2},{text:"300%",value:3},{text:"400%",value:4}];var tl=function ZoomControl(){var e=qt(cn),t=e.context,l=e.setContext;var o=Xt(null);var a=Yt(false),r=_slicedToArray(a,2),i=r[0],c=r[1];useOutsideClick(o,(function(){c(false)}),[]);var u=$t((function(e){e=parseFloat(e.toFixed(1));e>pt||e<yt||l((function(t){var l=n(t,t.currentSheetId);if(l!=null){t.luckysheetfile[l].zoomRatio=e;t.zoomRatio=e}}),{noHistory:true})}),[l]);return Zt.createElement("div",{className:"fortune-zoom-container"},Zt.createElement("div",{className:"fortune-zoom-button",onClick:function onClick(e){u(t.zoomRatio-.1);e.stopPropagation()}},Zt.createElement(un,{name:"minus",width:16,height:16})),Zt.createElement("div",{className:"fortune-zoom-ratio"},Zt.createElement("div",{className:"fortune-zoom-ratio-current fortune-zoom-button",onClick:function onClick(){return c(true)}},(t.zoomRatio*100).toFixed(0),"%"),i&&Zt.createElement("div",{className:"fortune-zoom-ratio-menu",ref:o},el.map((function(e){return Zt.createElement("div",{className:"fortune-zoom-ratio-item",key:e.text,onClick:function onClick(t){u(e.value);t.preventDefault()}},Zt.createElement("div",{className:"fortune-zoom-ratio-text"},e.text))})))),Zt.createElement("div",{className:"fortune-zoom-button",onClick:function onClick(e){u(t.zoomRatio+.1);e.stopPropagation()}},Zt.createElement(un,{name:"plus",width:16,height:16})))};var nl=function SheetTab(){var e=qt(cn),t=e.context,n=e.setContext,l=e.settings,o=e.refs;var a=Xt(null);var r=Xt(null);var i=Xt(null);var c=Yt(false),u=_slicedToArray(c,2),s=u[0],d=u[1];var v=Yt(true),m=_slicedToArray(v,2),f=m[0],h=m[1];var p=150;var y=$t((function(e){var t;if(a.current!=null&&a.current.scrollLeft!=null){var n=a.current.scrollLeft;n+e<=0?h(true):n>0&&h(false);(t=a.current)===null||t===void 0?void 0:t.scrollBy({left:e,behavior:"smooth"})}}),[]);Jt((function(){var e=a.current;e&&d(e.scrollWidth-2>e.clientWidth)}),[t.luckysheetfile]);var g=$t((function(){return setTimeout((function(){n((function(e){e.luckysheetCellUpdate.length>0&&D(e,e.luckysheetCellUpdate[0],e.luckysheetCellUpdate[1],o.cellInput.current);gt(e,l)}),{addSheetOp:true});var e=a.current;d(e.scrollWidth>e.clientWidth)}))}),[o.cellInput,n,l]);return Zt.createElement("div",{className:"luckysheet-sheet-area luckysheet-noselected-text",onContextMenu:function onContextMenu(e){return e.preventDefault()},id:"luckysheet-sheet-area"},Zt.createElement("div",{id:"luckysheet-sheet-content"},t.allowEdit&&Zt.createElement("div",{className:"fortune-sheettab-button",onClick:g},Zt.createElement(un,{name:"plus",width:16,height:16})),t.allowEdit&&Zt.createElement("div",{className:"sheet-list-container"},Zt.createElement("div",{id:"all-sheets",className:"fortune-sheettab-button",ref:a,onMouseDown:function onMouseDown(e){e.stopPropagation();n((function(e){e.showSheetList=!!an.isUndefined(e.showSheetList)||!e.showSheetList;e.sheetTabContextMenu={}}))}},Zt.createElement(un,{name:"all-sheets",width:16,height:16}))),Zt.createElement("div",{id:"luckysheet-sheets-m",className:"luckysheet-sheets-m lucky-button-custom"},Zt.createElement("i",{className:"iconfont luckysheet-iconfont-caidan2"})),Zt.createElement("div",{className:"fortune-sheettab-container",id:"fortune-sheettab-container"},!f&&Zt.createElement("div",{className:"boundary boundary-left"}),Zt.createElement("div",{className:"fortune-sheettab-container-c",id:"fortune-sheettab-container-c",ref:a},an.sortBy(t.luckysheetfile,(function(e){return Number(e.order)})).map((function(e){return Zt.createElement(Qn,{key:e.id,sheet:e})}))),f&&s&&Zt.createElement("div",{className:"boundary boundary-right"})),s&&Zt.createElement("div",{id:"fortune-sheettab-leftscroll",className:"fortune-sheettab-scroll",ref:r,onClick:function onClick(){y(-p)}},Zt.createElement(un,{name:"arrow-doubleleft",width:12,height:12})),s&&Zt.createElement("div",{id:"fortune-sheettab-rightscroll",className:"fortune-sheettab-scroll",ref:i,onClick:function onClick(){y(p)}},Zt.createElement(un,{name:"arrow-doubleright",width:12,height:12}))),Zt.createElement("div",{className:"fortune-sheet-area-right"},Zt.createElement(tl,null)))};var ll=function Divider(){return Zt.createElement("div",{className:"fortune-context-menu-divider"})};var ol=function Menu(e){var t=e.onClick,n=e.onMouseLeave,l=e.onMouseEnter,o=e.children;var a=Xt(null);return Zt.createElement("div",{ref:a,className:"luckysheet-cols-menuitem luckysheet-mousedown-cancel",onClick:function onClick(e){return t===null||t===void 0?void 0:t(e,a.current)},onMouseLeave:function onMouseLeave(e){return n===null||n===void 0?void 0:n(e,a.current)},onMouseEnter:function onMouseEnter(e){return l===null||l===void 0?void 0:l(e,a.current)}},Zt.createElement("div",{className:"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"},o))};var al=function CustomSort(){var e=Yt([]),t=_slicedToArray(e,2),l=t[0],o=t[1];var a=Yt(true),r=_slicedToArray(a,2),i=r[0],c=r[1];var u=qt(cn),s=u.context,d=u.setContext;var v=Yt("0"),m=_slicedToArray(v,2),f=m[0],h=m[1];var p=Yt(false),y=_slicedToArray(p,2),g=y[0],k=y[1];var E=C(s),b=E.sort;var w=useDialog(),x=w.hideDialog;var _=s.luckysheet_select_save[0].column[0];var N=s.luckysheet_select_save[0].column[1];var M=s.luckysheet_select_save[0].row[0];var R=s.luckysheet_select_save[0].row[1];var L=n(s,s.currentSheetId);var S=function handleSelectChange(e){h(e.target.value)};var V=$t((function(e){var t=e.target.value;c(t==="asc")}),[]);var H=$t((function(e){var t=e.target.checked;k(t)}),[]);Jt((function(){var e=[];if(g)for(var t=_;t<=N;t+=1){var n,l;var a=(n=s.luckysheetfile[L].data)===null||n===void 0||(l=n[M])===null||l===void 0?void 0:l[t];var r=(a===null||a===void 0?void 0:a.m)||(a===null||a===void 0?void 0:a.v);if(r)e.push(r);else{var i=kt(t);e.push("".concat(b.columnOperation," ").concat(i))}}else for(var c=_;c<=N;c+=1){var u=kt(c);e.push(u)}o(e)}),[N,_,s.luckysheetfile,g,M,L,b.columnOperation]);return Zt.createElement("div",{className:"fortune-sort"},Zt.createElement("div",{className:"fortune-sort-title"},Zt.createElement("span",null,Zt.createElement("span",null,b.sortRangeTitle),kt(_),M+1,Zt.createElement("span",null,b.sortRangeTitleTo),kt(N),R+1)),Zt.createElement("div",null,Zt.createElement("div",{className:"fortune-sort-modal"},Zt.createElement("div",null,Zt.createElement("input",{type:"checkbox",id:"fortune-sort-haveheader",onChange:H}),Zt.createElement("span",null,b.hasTitle)),Zt.createElement("div",{className:"fortune-sort-tablec"},Zt.createElement("table",{cellSpacing:"0"},Zt.createElement("tbody",null,Zt.createElement("tr",null,Zt.createElement("td",{style:{width:"190px"}},b.sortBy,Zt.createElement("select",{name:"sort_0",onChange:S},l.map((function(e,t){return Zt.createElement("option",{value:t,key:t},e)})))),Zt.createElement("td",null,Zt.createElement("div",null,Zt.createElement("input",{type:"radio",value:"asc",defaultChecked:true,name:"sort_0",onChange:V}),Zt.createElement("span",null,b.asc)),Zt.createElement("div",null,Zt.createElement("input",{type:"radio",value:"desc",name:"sort_0",onChange:V}),Zt.createElement("span",null,b.desc))))))))),Zt.createElement("div",{className:"fortune-sort-button"},Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){d((function(e){Et(e,i,parseInt(f,10));e.contextMenu={}}));x()}},b.confirm)))};var rl=function ContextMenu(){var e=useDialog(),t=e.showDialog;var l=Xt(null);var o=qt(cn),a=o.context,r=o.setContext,c=o.settings,u=o.refs;var s=a.contextMenu;var d=useAlert(),v=d.showAlert;var m=C(a),f=m.rightclick,h=m.drag,p=m.generalDialog,y=m.info;var g=$t((function(e,l){var o;var c=(o=a.luckysheet_select_save)===null||o===void 0?void 0:o[0];if(e==="|")return Zt.createElement(ll,{key:"divider-".concat(l)});if(e==="copy")return Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){var t;if(((t=e.luckysheet_select_save)===null||t===void 0?void 0:t.length)>1){v(f.noMulti,"ok");e.contextMenu={}}else{Ct(e);e.contextMenu={}}}))}},f.copy);if(e==="paste")return Zt.createElement(ol,{key:e,onClick:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var e;return regeneratorRuntime.wrap((function _callee$(t){while(1)switch(t.prev=t.next){case 0:t.next=2;return navigator.clipboard.readText();case 2:e=t.sent;r((function(t){bt(t,e);t.contextMenu={}}));case 4:case"end":return t.stop()}}),_callee)})));function onClick(){return e.apply(this,arguments)}return onClick}()},f.paste);if(e==="insert-column")return(c===null||c===void 0?void 0:c.row_select)?null:["left","right"].map((function(e){var t,n;return Zt.createElement(ol,{key:"add-col-".concat(e),onClick:function onClick(t){var n,l,o,i;var c=(n=a.luckysheet_select_save)===null||n===void 0||(l=n[0])===null||l===void 0||(o=l.column)===null||o===void 0?void 0:o[0];if(c!=null){var u=(i=t.target.querySelector("input"))===null||i===void 0?void 0:i.value;if(u!=null){var s=parseInt(u,10);if(!(s<1)){var d=e==="left"?"lefttop":"rightbottom";var m={type:"column",index:c,count:s,direction:d,id:a.currentSheetId};r((function(e){try{we(e,m);e.contextMenu={}}catch(t){t.message==="maxExceeded"?v(f.columnOverLimit,"ok"):t.message==="readOnly"&&v(f.cannotInsertOnColumnReadOnly,"ok");e.contextMenu={}}}),{insertRowColOp:m})}}}}},Zt.createElement(Zt.Fragment,null,an.startsWith((t=a.lang)!==null&&t!==void 0?t:"","zh")&&Zt.createElement(Zt.Fragment,null,f.to,Zt.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},f[e])),"".concat(f.insert,"  "),Zt.createElement("input",{onClick:function onClick(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},type:"text",className:"luckysheet-mousedown-cancel",placeholder:f.number,defaultValue:"1"}),Zt.createElement("span",{className:"luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel"},"".concat(f.column,"  ")),!an.startsWith((n=a.lang)!==null&&n!==void 0?n:"","zh")&&Zt.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},f[e])))}));if(e==="insert-row")return(c===null||c===void 0?void 0:c.column_select)?null:["top","bottom"].map((function(e){var t,n;return Zt.createElement(ol,{key:"add-row-".concat(e),onClick:function onClick(t,n){var l,o,i,c;var u=(l=a.luckysheet_select_save)===null||l===void 0||(o=l[0])===null||o===void 0||(i=o.row)===null||i===void 0?void 0:i[0];if(u!=null){var s=(c=n.querySelector("input"))===null||c===void 0?void 0:c.value;if(s!=null){var d=parseInt(s,10);if(!(d<1)){var m=e==="top"?"lefttop":"rightbottom";var h={type:"row",index:u,count:d,direction:m,id:a.currentSheetId};r((function(e){try{we(e,h);e.contextMenu={}}catch(t){t.message==="maxExceeded"?v(f.rowOverLimit,"ok"):t.message==="readOnly"&&v(f.cannotInsertOnRowReadOnly,"ok");e.contextMenu={}}}),{insertRowColOp:h})}}}}},Zt.createElement(Zt.Fragment,null,an.startsWith((t=a.lang)!==null&&t!==void 0?t:"","zh")&&Zt.createElement(Zt.Fragment,null,f.to,Zt.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},f[e])),"".concat(f.insert,"  "),Zt.createElement("input",{onClick:function onClick(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},type:"text",className:"luckysheet-mousedown-cancel",placeholder:f.number,defaultValue:"1"}),Zt.createElement("span",{className:"luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel"},"".concat(f.row,"  ")),!an.startsWith((n=a.lang)!==null&&n!==void 0?n:"","zh")&&Zt.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},f[e])))}));if(e==="delete-column")return(c===null||c===void 0?void 0:c.column_select)&&Zt.createElement(ol,{key:"delete-col",onClick:function onClick(){if(c){var e=_slicedToArray(c.column,2),t=e[0],l=e[1];var o={type:"column",start:t,end:l,id:a.currentSheetId};r((function(e){var r,i,c;if(((r=e.luckysheet_select_save)===null||r===void 0?void 0:r.length)>1){v(f.noMulti,"ok");e.contextMenu={};e.dataVerificationDropDownList=false}else{var u=l-t+1;var s=n(e,a.currentSheetId);if(((i=e.luckysheetfile[s].data)===null||i===void 0||(c=i[0])===null||c===void 0?void 0:c.length)<=u){v(f.cannotDeleteAllColumn,"ok");e.contextMenu={}}else{try{wt(e,o)}catch(e){e.message==="readOnly"&&v(f.cannotDeleteColumnReadOnly,"ok")}e.contextMenu={}}}}),{deleteRowColOp:o})}}},f.deleteSelected,f.column);if(e==="delete-row")return(c===null||c===void 0?void 0:c.row_select)&&Zt.createElement(ol,{key:"delete-row",onClick:function onClick(){if(c){var e=_slicedToArray(c.row,2),t=e[0],l=e[1];var o={type:"row",start:t,end:l,id:a.currentSheetId};r((function(e){var r,i;if(((r=e.luckysheet_select_save)===null||r===void 0?void 0:r.length)>1){v(f.noMulti,"ok");e.contextMenu={}}else{var c=l-t+1;var u=n(e,a.currentSheetId);if(((i=e.luckysheetfile[u].data)===null||i===void 0?void 0:i.length)<=c){v(f.cannotDeleteAllRow,"ok");e.contextMenu={}}else{try{wt(e,o)}catch(e){e.message==="readOnly"&&v(f.cannotDeleteRowReadOnly,"ok")}e.contextMenu={}}}}),{deleteRowColOp:o})}}},f.deleteSelected,f.row);if(e==="hide-row")return(c===null||c===void 0?void 0:c.row_select)===true&&["hideSelected","showHide"].map((function(e){return Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(n){var l="";e==="hideSelected"?l=xt(n,"row"):e==="showHide"&&_t(n,"row");l==="noMulti"&&t(h.noMulti);n.contextMenu={}}))}},f[e]+f.row)}));if(e==="hide-column")return(c===null||c===void 0?void 0:c.column_select)===true&&["hideSelected","showHide"].map((function(e){return Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(n){var l="";e==="hideSelected"?l=xt(n,"column"):e==="showHide"&&_t(n,"column");l==="noMulti"&&t(h.noMulti);n.contextMenu={}}))}},f[e]+f.column)}));if(e==="set-row-height"){var u,s;var d=(c===null||c===void 0?void 0:c.height)||a.defaultrowlen;var m=((u=a.luckysheet_select_save)===null||u===void 0?void 0:u.some((function(e){return e.height_move!==(d+1)*(e.row[1]-e.row[0]+1)-1})))?"":d;return((s=a.luckysheet_select_save)===null||s===void 0?void 0:s.some((function(e){return e.row_select})))?Zt.createElement(ol,{key:"set-row-height",onClick:function onClick(e,t){var n;var l=(n=t.querySelector("input"))===null||n===void 0?void 0:n.value;r((function(e){if(an.isUndefined(l)||l===""||parseInt(l,10)<=0||parseInt(l,10)>545){v(y.tipRowHeightLimit,"ok");e.contextMenu={}}else{var t=parseInt(l,10);var n={};an.forEach(e.luckysheet_select_save,(function(e){for(var l=e.row[0];l<=e.row[1];l+=1)n[l]=t}));Nt.setRowHeight(e,n,{},true);e.contextMenu={}}}))}},f.row,f.height,Zt.createElement("input",{onClick:function onClick(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},type:"number",min:1,max:545,className:"luckysheet-mousedown-cancel",placeholder:f.number,defaultValue:m,style:{width:"40px"}}),"px"):null}if(e==="set-column-width"){var g,k;var E=(c===null||c===void 0?void 0:c.width)||a.defaultcollen;var C=((g=a.luckysheet_select_save)===null||g===void 0?void 0:g.some((function(e){return e.width_move!==(E+1)*(e.column[1]-e.column[0]+1)-1})))?"":E;return((k=a.luckysheet_select_save)===null||k===void 0?void 0:k.some((function(e){return e.column_select})))?Zt.createElement(ol,{key:"set-column-width",onClick:function onClick(e,t){var n;var l=(n=t.querySelector("input"))===null||n===void 0?void 0:n.value;r((function(e){if(an.isUndefined(l)||l===""||parseInt(l,10)<=0||parseInt(l,10)>2038){v(y.tipColumnWidthLimit,"ok");e.contextMenu={}}else{var t=parseInt(l,10);var n={};an.forEach(e.luckysheet_select_save,(function(e){for(var l=e.column[0];l<=e.column[1];l+=1)n[l]=t}));Nt.setColumnWidth(e,n,{},true);e.contextMenu={}}}))}},f.column,f.width,Zt.createElement("input",{onClick:function onClick(e){return e.stopPropagation()},onKeyDown:function onKeyDown(e){return e.stopPropagation()},type:"number",min:1,max:545,className:"luckysheet-mousedown-cancel",placeholder:f.number,defaultValue:C,style:{width:"40px"}}),"px"):null}return e==="clear"?Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){var n=i(e);if(n){if(e.activeImg!=null)Mt(e);else{var l=Rt(e);l==="partMC"?t(p.partiallyError,"ok"):l==="allowEdit"?t(p.readOnlyError,"ok"):l==="dataNullError"&&t(p.dataNullError,"ok")}e.contextMenu={};Lt(e,null,void 0)}}))}},f.clearContent):e==="orderAZ"?Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){Et(e,true);e.contextMenu={}}))}},f.orderAZ):e==="orderZA"?Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){Et(e,false);e.contextMenu={}}))}},f.orderZA):e==="sort"?Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){t(Zt.createElement(al,null));e.contextMenu={}}))}},f.sortSelection):e==="filter"?Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){ct(e);e.contextMenu={}}))}},f.filterSelection):e==="image"?Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){Ye();e.contextMenu={}}))}},f.image):e==="link"?Zt.createElement(ol,{key:e,onClick:function onClick(){r((function(e){St(e);e.contextMenu={}}))}},f.link):null}),[a.currentSheetId,a.lang,a.luckysheet_select_save,a.defaultrowlen,a.defaultcollen,f,y,r,v,t,h,p]);Qt((function(){var e;if(l.current){var t=window.innerHeight;var n=window.innerWidth;var o=l.current.getBoundingClientRect();var a=(e=u.workbookContainer.current)===null||e===void 0?void 0:e.getBoundingClientRect();if(a){var i=o.width;var c=o.height;var d=s.y||0;var v=s.x||0;var m=false;if(a.left+v+i>n){v-=i;m=true}if(a.top+d+c>t){d-=c;m=true}if(d<0){d=0;m=true}m&&r((function(e){e.contextMenu.x=v;e.contextMenu.y=d}))}}}),[s.x,s.y,r]);return an.isEmpty(a.contextMenu)?null:Zt.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu",ref:l,onContextMenu:function onContextMenu(e){return e.stopPropagation()},style:{left:s.x,top:s.y}},a.contextMenu.headerMenu===true?c.headerContextMenu.map((function(e,t){return g(e,t)})):c.cellContextMenu.map((function(e,t){return g(e,t)})))};var il=function SVGDefines(){return Zt.createElement("svg",{style:{position:"absolute",width:0,height:0},xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},Zt.createElement("defs",null,Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"add"},Zt.createElement("rect",{x:"4.75",y:"4.75",width:"14.5",height:"14.5",rx:"0.75",stroke:"#424A59",strokeOpacity:"0.9",strokeWidth:"1.5"}),Zt.createElement("rect",{x:"11.25",y:"8.5",width:"1.5",height:"7",fill:"#535B68"}),Zt.createElement("rect",{x:"15.5",y:"11.25",width:"1.5",height:"7",transform:"rotate(90 15.5 11.25)",fill:"#535B68"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-bottom"},Zt.createElement("path",{d:"M9.25 12.5L12.0002 15.5L14.75 12.5H9.25Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"5.5",y:"16.5",width:"13",height:"1.5",fill:"#525C6F"}),Zt.createElement("rect",{x:"11.25",y:"5.5",width:"1.5",height:"7.5",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-center"},Zt.createElement("path",{d:"M5 6.75H19",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M8 12H16",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M5 17.25L19 17.25",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-justify"},Zt.createElement("path",{d:"M19.5 6.5H4.5",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"}),Zt.createElement("path",{d:"M19.5 12L4.5 12",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"}),Zt.createElement("path",{d:"M19.5 17.5H4.5",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-left"},Zt.createElement("path",{d:"M5 6.75H19",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M5 12H13",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M5 17.25L19 17.25",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-middle"},Zt.createElement("path",{d:"M9.25 16.5L12.0002 13.5L14.75 16.5H9.25Z",fill:"#525C6F"}),Zt.createElement("path",{d:"M9.25 7L12.0002 10L14.75 7L9.25 7Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"5.5",y:"11",width:"13",height:"1.5",fill:"#525C6F"}),Zt.createElement("rect",{x:"11.25",y:"16",width:"1.5",height:"3.5",fill:"#525C6F"}),Zt.createElement("rect",{x:"11.25",y:"4",width:"1.5",height:"3.5",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-right"},Zt.createElement("path",{d:"M5 6.75H19",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M11 12H19",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M5 17.25L19 17.25",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-top"},Zt.createElement("path",{d:"M9.25 11L12.0002 8L14.75 11H9.25Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"5.5",y:"5.5",width:"13",height:"1.5",fill:"#525C6F"}),Zt.createElement("rect",{x:"11.25",y:"10.5",width:"1.5",height:"7.5",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"bold"},Zt.createElement("path",{d:"M6.30566 5.07617V18.9992H12.4872C13.9107 18.9992 15.0417 18.7067 15.8607 18.1607C16.8162 17.4977 17.3037 16.4837 17.3037 15.1187C17.3037 14.1827 17.0307 13.4417 16.5237 12.8567C16.0167 12.2717 15.3147 11.8817 14.3982 11.7257C15.1002 11.4917 15.6657 11.1212 16.0947 10.6142C16.5042 10.0487 16.7187 9.36617 16.7187 8.58617C16.7187 7.49417 16.3482 6.63617 15.6072 6.01217C14.8467 5.38817 13.8132 5.07617 12.5262 5.07617H6.30566ZM7.90466 6.42167H12.1557C13.1307 6.42167 13.8717 6.59717 14.3787 6.98717C14.8857 7.37717 15.1392 7.96217 15.1392 8.74217C15.1392 9.54167 14.8662 10.1462 14.3592 10.5557C13.8522 10.9457 13.1112 11.1602 12.1362 11.1602H7.90466V6.42167ZM7.90466 12.4862H12.3507C13.4232 12.4862 14.2422 12.6812 14.8077 13.1102C15.3927 13.5392 15.7047 14.2022 15.7047 15.0992C15.7047 15.9962 15.3537 16.6787 14.6712 17.1077C14.0862 17.4587 13.3257 17.6537 12.3507 17.6537H7.90466V12.4862Z",fill:"#394259"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-all"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-bottom"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"5",y1:"18.25",x2:"19",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-color"},Zt.createElement("path",{d:"M16 10.9106L18.9511 13.8617L14.5431 18.2697H11.592V15.3186L16 10.9106Z",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 6.5H17.5V9.84613H19V6.5V5H17.5H6.5H5V6.5V17.5V19H6.5H9.84616V17.5H6.5V6.5Z",fill:"#535A68"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-horizontal"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"5",y1:"18.25",x2:"19",y2:"18.25",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border_diagonal_down"},Zt.createElement("line",{x1:"17.9697",y1:"18.0303",x2:"5.96967",y2:"6.03033",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border_diagonal_up"},Zt.createElement("line",{y1:"-0.75",x2:"16.9706",y2:"-0.75",transform:"matrix(0.707107 -0.707107 -0.707107 -0.707107 5.5 17.5)",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-inside"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-left"},Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"5.75",y1:"19",x2:"5.75",y2:"5",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-none"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-outside"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-right"},Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"18.25",y1:"19",x2:"18.25",y2:"5",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-vertical"},Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"18.25",y1:"19",x2:"18.25",y2:"5",stroke:"#CCCED2",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-slash"},Zt.createElement("line",{x1:"5.75",y1:"5.75",x2:"17.95",y2:"17.95",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-style"},Zt.createElement("line",{x1:"5",y1:"5.75",x2:"19",y2:"5.75",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"5",y1:"12.25",x2:"7.5",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"8.8252",y1:"12.25",x2:"11.3252",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12.6504",y1:"12.25",x2:"15.1504",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"16.4746",y1:"12.25",x2:"18.9746",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"5",y1:"18.25",x2:"6.5",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"7.08008",y1:"18.25",x2:"8.58008",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"9.16016",y1:"18.25",x2:"10.6602",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"11.2402",y1:"18.25",x2:"12.7402",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"13.3203",y1:"18.25",x2:"14.8203",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"15.4004",y1:"18.25",x2:"16.9004",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"17.4805",y1:"18.25",x2:"18.9805",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-top"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"5",y1:"5.75",x2:"19",y2:"5.75",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 18 18",fill:"none",id:"close"},Zt.createElement("path",{d:"M13.9255 5L5.00091 13.9246",stroke:"#262A33",strokeOpacity:"0.9",strokeWidth:"1.5",strokeLinecap:"round"}),Zt.createElement("path",{d:"M13.9255 13.9238L5.00091 4.9992",stroke:"#262A33",strokeOpacity:"0.9",strokeWidth:"1.5",strokeLinecap:"round"})),Zt.createElement("symbol",{viewBox:"0 0 10 24",fill:"none",id:"combo-arrow"},Zt.createElement("path",{d:"M8 10H2L5 14L8 10Z",fill:"#A6A6A6"})),Zt.createElement("symbol",{fill:"none",viewBox:"0 0 24 24",id:"comment"},Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.968 15.7L12 17.956l2.032-2.258H18.5v-10h-13v10h4.468zm1.289 3.673L9.3 17.2H5.5A1.5 1.5 0 014 15.7v-10a1.5 1.5 0 011.5-1.5h13A1.5 1.5 0 0120 5.7v10a1.5 1.5 0 01-1.5 1.5h-3.8l-1.957 2.174a1 1 0 01-1.486 0z",fill:"#525C6F"}),Zt.createElement("path",{d:"M7 8.2h10v1.5H7V8.2zM7 11.699h6v1.5H7z",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"strike-through"},Zt.createElement("rect",{x:"6",y:"11.5",width:"13",height:"1.5",fill:"#394259"}),Zt.createElement("path",{d:"M9.00344 11.5C9.69342 11.9717 10.6431 12.3814 11.8525 12.729C13.071 13.0815 13.9121 13.4403 14.376 13.8052C14.8398 14.1639 15.0718 14.6742 15.0718 15.3359C15.0718 15.9977 14.8213 16.5203 14.3203 16.9038C13.8193 17.2873 13.0988 17.479 12.1587 17.479C11.1506 17.479 10.3434 17.244 9.7373 16.7739C9.13737 16.2977 8.8374 15.6514 8.8374 14.835H7.04688C7.04688 15.6204 7.26335 16.3224 7.69629 16.9409C8.13542 17.5594 8.757 18.048 9.56104 18.4067C10.3651 18.7593 11.231 18.9355 12.1587 18.9355C13.5874 18.9355 14.7285 18.6077 15.582 17.9521C16.4355 17.2904 16.8623 16.4121 16.8623 15.3174C16.8623 14.6309 16.7077 14.034 16.3984 13.5269C16.0954 13.0197 15.6253 12.5775 14.9883 12.2002C14.581 11.9526 14.0705 11.7192 13.457 11.5H9.00344Z",fill:"#394259"}),Zt.createElement("path",{d:"M7.71685 10C7.5547 9.61466 7.47363 9.19458 7.47363 8.73975C7.47363 7.67594 7.8973 6.79769 8.74463 6.10498C9.59814 5.40609 10.7052 5.05664 12.0659 5.05664C12.9937 5.05664 13.8193 5.236 14.543 5.59473C15.2728 5.95345 15.8356 6.44824 16.2314 7.0791C16.6335 7.70996 16.8345 8.39958 16.8345 9.14795H15.0439C15.0439 8.33154 14.7842 7.69141 14.2646 7.22754C13.7451 6.75749 13.0122 6.52246 12.0659 6.52246C11.1877 6.52246 10.5011 6.71729 10.0063 7.10693C9.51774 7.4904 9.27344 8.02539 9.27344 8.71191C9.27344 9.2095 9.46296 9.63887 9.84201 10H7.71685Z",fill:"#394259"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"clear-format"},Zt.createElement("line",{x1:"8",y1:"18.25",x2:"20",y2:"18.25",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 7.12132L17.8787 11L10 18.8787L6.12132 15L14 7.12132ZM14 5L15.0607 6.06066L18.9393 9.93934L20 11L18.9393 12.0607L12 19L8 19L5.06066 16.0607L4 15L5.06066 13.9393L12.9393 6.06066L14 5Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"13.9375",y:"6.12316",width:"6.98528",height:"5.7265",transform:"rotate(45 13.9375 6.12316)",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"image"},Zt.createElement("circle",{cx:"8.75",cy:"8.75",r:"1.25",fill:"#525C6F"}),Zt.createElement("rect",{x:"4.75",y:"5.25",width:"14.5",height:"13.5",rx:"0.75",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M7 19L12.984 11.8949C13.1659 11.6789 13.4905 11.6563 13.7006 11.845L19.5 17.0556",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"italic"},Zt.createElement("path",{d:"M11 5H16V6.5H11V5Z",fill:"#394259"}),Zt.createElement("path",{d:"M9 17.5H14V19H9V17.5Z",fill:"#394259"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.7598 17.877L12.7598 5.87695L14.2394 6.12355L12.2394 18.1236L10.7598 17.877Z",fill:"#394259"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-cancel"},Zt.createElement("path",{d:"M13 14.9998L16.5 11.9996L13 8.99982V14.9998Z",fill:"#525C6F"}),Zt.createElement("path",{d:"M11 14.9998L7.5 11.9996L11 8.99982L11 14.9998Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"10",y:"11.2498",width:"4.5",height:"1.5",fill:"#525C6F"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 6.49982H6.5L6.5 17.4998H9.5V15.4999H11V17.4998V18.9998H9.5H6.5H5V17.4998L5 6.49982V4.99982H6.5H9.5L11 4.99982V6.49982V8.49988H9.5V6.49982ZM13 15.4999V15.9998V17.4998V18.9998H14.5H17.5H19V17.4998V6.49982V4.99982H17.5H14.5H13V6.49982V7.99982V8.49988H14.5V7.99982V6.49982H17.5V17.4998H14.5L14.5 15.9998V15.4999H13Z",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-horizontal"},Zt.createElement("path",{d:"M11 15L14.5 11.9998L11 9V15Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"5",y:"11.25",width:"8.5",height:"1.5",fill:"#525C6F"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 6.5H7.5H9.5H11V5H9.5H6.5H5V6.5V17.5V19H6.5H9.5H11V17.5H9.5H7.5H6.5V6.5ZM13 16V15.5H14.5V16V17.5H17.5V6.5H14.5V8V8.5H13V8V6.5V5H14.5H17.5H19V6.5V17.5V19H17.5H14.5H13V17.5V16Z",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-vertical"},Zt.createElement("path",{d:"M9 10.9998L12.0002 14.4998L15 10.9998L9 10.9998Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"12.75",y:"4.99982",width:"8.5",height:"1.5",transform:"rotate(90 12.75 4.99982)",fill:"#525C6F"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.5 6.49982L17.5 7L17.5 10.9998H19V9.49982V6.49982V4.99982H17.5L6.5 4.99982H5V6.49982L5 9.49982V10.9998H6.5V9.49982L6.5 7L6.5 6.49982L17.5 6.49982ZM8 12.9998L8.5 12.9998V14.4998H8H6.5V17.4998H17.5V14.4998H16H15.5V12.9998H16H17.5H19L19 14.4998V17.4998V18.9998H17.5H6.5L5 18.9998L5 17.4998V14.4998V12.9998H6.5H8Z",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-all"},Zt.createElement("path",{d:"M15.5 14.9998L12 11.9996L15.5 8.99982V14.9998Z",fill:"#525C6F"}),Zt.createElement("path",{d:"M8.5 14.9998L12 11.9996L8.5 8.99982L8.5 14.9998Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"7",y:"11.2498",width:"2.5",height:"1.5",fill:"#525C6F"}),Zt.createElement("rect",{x:"14.5",y:"11.2498",width:"2.5",height:"1.5",fill:"#525C6F"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 6.49982H6.5L6.5 17.4998H9.5V15.4999H11V17.4998V18.9998H9.5H6.5H5V17.4998L5 6.49982V4.99982H6.5H9.5L11 4.99982V6.49982V8.49988H9.5V6.49982ZM13 15.4999V15.9998V17.4998V18.9998H14.5H17.5H19V17.4998V6.49982V4.99982H17.5H14.5H13V6.49982V7.99982V8.49988H14.5V7.99982V6.49982H17.5V17.4998H14.5L14.5 15.9998V15.4999H13Z",fill:"#525C6F"})),Zt.createElement("symbol",{fill:"none",viewBox:"0 0 16 16",id:"plus"},Zt.createElement("path",{d:"M8 1.715v12.571M1.714 8h12.572",stroke:"#666",strokeWidth:"1.714"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",version:"1.1","p-id":"4116",id:"minus"},Zt.createElement("path",{d:"M801.895 542.105h-579.79C205.479 542.105 192 528.627 192 512c0-16.627 13.479-30.105 30.105-30.105h579.789C818.521 481.895 832 495.373 832 512c0 16.627-13.479 30.105-30.105 30.105z","p-id":"4117"})),Zt.createElement("symbol",{viewBox:"-100 -100 1224 1224",fill:"#525C6F",id:"background"},Zt.createElement("path",{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zM389.3 700.2c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-0.6-0.6-1.3-1.2-2-1.7l-78.2-78.2c-3.5-3.5-9.3-3.5-12.8 0l-48 48c-3.5 3.5-3.5 9.3 0 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256z m12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"})),Zt.createElement("symbol",{viewBox:"-100 -100 1224 1224",fill:"#525C6F",id:"font-color"},Zt.createElement("path",{d:"M904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8zM253.7 736h85c4.2 0 8-2.7 9.3-6.8l53.7-166h219.2l53.2 166c1.3 4 5 6.8 9.3 6.8h89.1c1.1 0 2.2-0.2 3.2-0.5 5.1-1.8 7.8-7.3 6-12.4L573.6 118.6c-1.4-3.9-5.1-6.6-9.2-6.6H462.1c-4.2 0-7.9 2.6-9.2 6.6L244.5 723.1c-0.4 1-0.5 2.1-0.5 3.2-0.1 5.3 4.3 9.7 9.7 9.7z m255.9-516.1h4.1l83.8 263.8H424.9l84.7-263.8z"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"text-overflow"},Zt.createElement("path",{d:"M16.5 15L20 11.9998L16.5 9V15Z",fill:"#525C6F"}),Zt.createElement("rect",{x:"7",y:"11.25",width:"9.5",height:"1.5",fill:"#525C6F"}),Zt.createElement("line",{x1:"4.75",y1:"5",x2:"4.75",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12.25",y1:"5",x2:"12.25",y2:"9.5",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12.25",y1:"14.5",x2:"12.25",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"text-wrap"},Zt.createElement("line",{x1:"4.75",y1:"5",x2:"4.75",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"19.25",y1:"5",x2:"19.25",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.00001 16.2502L9.99 13.5V15.5H12.0005C13.9335 15.5 15.5005 13.933 15.5005 12C15.5005 10.067 13.9335 8.5 12.0005 8.5H7V7H12.0005C14.7619 7 17.0005 9.23857 17.0005 12C17.0005 14.7614 14.7619 17 12.0005 17H9.99V19L7.00001 16.2502Z",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"underline"},Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 19H7V17.5H17V19Z",fill:"#394259"}),Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.25 5V12.25C9.25 13.7688 10.4812 15 12 15C13.5188 15 14.75 13.7688 14.75 12.25V5H16.25V12.25C16.25 14.5972 14.3472 16.5 12 16.5C9.65278 16.5 7.75 14.5972 7.75 12.25V5H9.25Z",fill:"#394259"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"undo"},Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.5 7.75001L7.2019 10.835V8.5H13.25C15.4591 8.5 17.25 10.2909 17.25 12.5C17.25 14.7091 15.4591 16.5 13.25 16.5H7V18H13.25C16.2876 18 18.75 15.5376 18.75 12.5C18.75 9.46244 16.2876 7 13.25 7H7.2019V4.66547L3.5 7.75001Z",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"redo"},Zt.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.5 7.75001L16.7981 10.835V8.5H10.75C8.54086 8.5 6.75 10.2909 6.75 12.5C6.75 14.7091 8.54086 16.5 10.75 16.5H17V18H10.75C7.71243 18 5.25 15.5376 5.25 12.5C5.25 9.46244 7.71243 7 10.75 7H16.7981V4.66547L20.5 7.75001Z",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"fx"},Zt.createElement("path",{d:"M841 370c3-3.3 2.7-8.3-0.6-11.3-1.5-1.3-3.4-2.1-5.3-2.1h-72.6c-2.4 0-4.6 1-6.1 2.8L633.5 504.6c-2.9 3.4-7.9 3.8-11.3 0.9-0.9-0.8-1.6-1.7-2.1-2.8l-63.5-141.3c-1.3-2.9-4.1-4.7-7.3-4.7H380.7l0.9-4.7 8-42.3c10.5-55.4 38-81.4 85.8-81.4 18.6 0 35.5 1.7 48.8 4.7l14.1-66.8c-22.6-4.7-35.2-6.1-54.9-6.1-103.3 0-156.4 44.3-175.9 147.3l-9.4 49.4h-97.6c-3.8 0-7.1 2.7-7.8 6.4L181.9 415c-0.9 4.3 1.9 8.6 6.2 9.5 0.5 0.1 1.1 0.2 1.6 0.2H284l-89 429.9c-0.9 4.3 1.9 8.6 6.2 9.5 0.5 0.1 1.1 0.2 1.6 0.2H269c3.8 0 7.1-2.7 7.8-6.4l89.7-433.1h135.8l68.2 139.1c1.4 2.9 1 6.4-1.2 8.8l-180.6 203c-2.9 3.3-2.6 8.4 0.7 11.3 1.5 1.3 3.4 2 5.3 2h72.7c2.4 0 4.6-1 6.1-2.8l123.7-146.7c2.8-3.4 7.9-3.8 11.3-1 0.9 0.8 1.6 1.7 2.1 2.8L676.4 784c1.3 2.8 4.1 4.7 7.3 4.7h64.6c4.4 0 8-3.6 8-8 0-1.2-0.3-2.4-0.8-3.5l-95.2-198.9c-1.4-2.9-0.9-6.4 1.3-8.8L841 370z"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"currency-format"},Zt.createElement("path",{fill:"#525C6F",d:"M675.861333 192l45.610667 44.906667-166.997333 169.6h237.525333v64H544v144.597333h248v64H544v176.597333h-64v-176.597333H232v-64H480v-144.597333H232v-64h237.482667l-166.954667-169.6L348.138667 192 512 358.464 675.861333 192z","p-id":"5490"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"percentage-format"},Zt.createElement("path",{fill:"#525C6F",d:"M855.7 210.8l-42.4-42.4c-3.1-3.1-8.2-3.1-11.3 0L168.3 801.9c-3.1 3.1-3.1 8.2 0 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1 0.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144z m0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zM720 576c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144z m0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z","p-id":"5920"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"number-decrease"},Zt.createElement("path",{fill:"#525C6F",d:"M132.266667 597.333333h76.8a4.266667 4.266667 0 0 0 4.266666-4.266666v-76.8a4.266667 4.266667 0 0 0-4.266666-4.266667H132.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266666z m367.616-403.925333a94.72 94.72 0 0 0-27.306667-17.322667c-25.514667-10.496-54.954667-11.392-81.706667-5.632-36.778667 7.936-66.56 31.872-84.906666 64.256-19.797333 34.816-28.16 77.397333-28.16 139.178667 0 61.184 8.405333 102.4 28.16 137.941333a125.866667 125.866667 0 0 0 112.768 67.797334c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.773333 28.16-77.354667 28.16-135.552 0-50.432-5.888-104.106667-32.768-148.394667a148.906667 148.906667 0 0 0-27.562667-34.474667z m-81.066667 314.197333c-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.149333 20.394667-133.76 58.794667-133.76 39.594667 0 59.306667 45.653333 59.306667 135.552 0 87.04-20.394667 132.565333-58.794667 132.565334z m289.024 212.394667a4.266667 4.266667 0 0 1-4.266667-4.266667V640l-103.68 103.68a4.266667 4.266667 0 0 0 0 6.016L704 853.333333v-75.733333a4.266667 4.266667 0 0 1 4.266667-4.266667H896v-53.333333h-187.733333z","p-id":"6524"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"number-increase"},Zt.createElement("path",{fill:"#525C6F",d:"M132.266667 597.333333h76.8a4.266667 4.266667 0 0 0 4.266666-4.266666v-76.8a4.266667 4.266667 0 0 0-4.266666-4.266667H132.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266666z m366.848-402.944a111.530667 111.530667 0 0 0-45.226667-21.76 142.933333 142.933333 0 0 0-71.253333 1.152A130.56 130.56 0 0 0 305.92 234.666667c-19.797333 34.816-28.16 77.397333-28.16 139.178666 0 61.184 8.405333 102.4 28.16 137.941334a125.866667 125.866667 0 0 0 112.768 67.797333c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.773333 28.16-77.354667 28.16-135.552 0-61.696-11.178667-141.653333-61.098666-181.888z m-79.872 313.173334c-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.149333 20.394667-133.76 58.794667-133.76 39.594667 0 59.306667 45.653333 59.306666 135.552 0 87.04-20.394667 132.565333-58.794666 132.565333z m335.232 71.978666c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.730667 28.16-77.312 28.16-135.509333 0-47.786667-3.84-99.114667-27.093333-141.909333-27.178667-50.176-82.944-75.392-139.093334-64.554667l-12.8 3.157333A128.64 128.64 0 0 0 641.706667 234.666667c-19.797333 34.773333-28.16 77.354667-28.16 139.093333 0 61.184 8.405333 102.4 28.16 137.941333a125.866667 125.866667 0 0 0 112.768 67.754667z m0-340.053333c39.594667 0 59.306667 45.653333 59.306666 135.552 0 86.954667-20.394667 132.565333-58.794666 132.565333-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.192 20.394667-133.76 58.794667-133.76z m34.858666 476.16a4.266667 4.266667 0 0 1-4.266666 4.266667H597.333333v53.333333h187.733334a4.266667 4.266667 0 0 1 4.266666 4.266667V853.333333l103.68-103.68a4.266667 4.266667 0 0 0 0-6.016L789.333333 640v75.733333z","p-id":"6702"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",id:"format-painter"},Zt.createElement("path",{fill:"#525C6F",d:"M15.1004 6.5L6.90039 6.5V9.8L15.1004 9.8L15.1004 6.5ZM15.1004 5C15.9288 5 16.6004 5.67157 16.6004 6.5V9.8C16.6004 10.6284 15.9288 11.3 15.1004 11.3H6.90039C6.07196 11.3 5.40039 10.6284 5.40039 9.8V6.5C5.40039 5.67157 6.07196 5 6.90039 5H15.1004Z"}),Zt.createElement("path",{fill:"#525C6F",d:"M17.7174 8.90039H15.3262V7.40039H18.4674C18.8816 7.40039 19.2174 7.73618 19.2174 8.15039V13.7859C19.2174 14.163 18.9374 14.4814 18.5634 14.5297L10.8174 15.5299V19.0004H9.31738V14.8705C9.31738 14.4934 9.59736 14.175 9.97134 14.1267L17.7174 13.1265V8.90039Z"})),Zt.createElement("symbol",{viewBox:"0 0 1096 1096",id:"formula-sum"},Zt.createElement("path",{fill:"#525C6F",d:"M725.333333 853.333333H256c-17.066667 0-29.866667-8.533333-38.4-25.6-8.533333-17.066667-4.266667-34.133333 4.266667-46.933333l230.4-268.8-230.4-268.8c-8.533333-12.8-12.8-34.133333-4.266667-46.933333 8.533333-17.066667 21.333333-25.6 38.4-25.6h469.333333c46.933333 0 85.333333 38.4 85.333334 85.333333v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667s-42.666667-17.066667-42.666667-42.666667V256H349.866667l196.266666 226.133333c12.8 17.066667 12.8 38.4 0 55.466667L349.866667 768H725.333333v-85.333333c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 46.933333-38.4 85.333333-85.333334 85.333333z"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"arrow-doubleleft"},Zt.createElement("path",{d:"M272.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512z"}),Zt.createElement("path",{d:"M576.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"arrow-doubleright"},Zt.createElement("path",{d:"M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1c-4.1 5.2-0.4 12.9 6.3 12.9h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"}),Zt.createElement("path",{d:"M837.2 492.3L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1c-4.1 5.2-0.4 12.9 6.3 12.9h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-col"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M5.75 12H18.25M12 5.5V18.5",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M12 12L5.5 17.75",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M11.25 6L5.75 11.5",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-row"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M5.75 12H18.25M12 5.5V18.5",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M18 6.5L11.5 12.25",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M11.25 6L5.75 11.5",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-row-col"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M5.75 12H18.25M12 5.5V18.5",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M18 6L5.75 18.25",stroke:"#525C6F",strokeWidth:"1.5"}),Zt.createElement("path",{d:"M11.25 6L5.75 11.5",stroke:"#525C6F",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-cancel"},Zt.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"}),Zt.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"sort-desc"},Zt.createElement("path",{d:"M839.6 433.8L749 150.5c-1.2-3.9-4.8-6.5-8.9-6.5h-77.4c-4.1 0-7.6 2.6-8.9 6.5l-91.3 283.3c-0.3 0.9-0.5 1.9-0.5 2.9 0 5.1 4.2 9.3 9.3 9.3h56.4c4.2 0 7.8-2.8 9-6.8l17.5-61.6h89l17.3 61.5c1.1 4 4.8 6.8 9 6.8h61.2c1 0 1.9-0.1 2.8-0.4 2.4-0.8 4.3-2.4 5.5-4.6 1.1-2.2 1.3-4.7 0.6-7.1zM663.3 325.5l32.8-116.9h6.3l32.1 116.9h-71.2z","p-id":"2016"}),Zt.createElement("path",{d:"M806.8 818.4H677.2v-0.4l132.6-188.9c1.1-1.6 1.7-3.4 1.7-5.4v-36.4c0-5.1-4.2-9.3-9.3-9.3h-204c-5.1 0-9.3 4.2-9.3 9.3v43c0 5.1 4.2 9.3 9.3 9.3h122.6v0.4L587.7 828.9c-1.1 1.6-1.7 3.4-1.7 5.4v36.4c0 5.1 4.2 9.3 9.3 9.3h211.4c5.1 0 9.3-4.2 9.3-9.3v-43c0.1-5.1-4.1-9.3-9.2-9.3z","p-id":"2017"}),Zt.createElement("path",{d:"M416 702h-76V172c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v530h-76c-6.7 0-10.5 7.8-6.3 13l112 141.9c3.2 4.1 9.4 4.1 12.6 0l112-141.9c4.1-5.2 0.4-13-6.3-13z","p-id":"2018"})),Zt.createElement("svg",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"sort-asc"},Zt.createElement("path",{d:"M839.6 433.8L749 150.5c-1.2-3.9-4.8-6.5-8.9-6.5h-77.4c-4.1 0-7.6 2.6-8.9 6.5l-91.3 283.3c-0.3 0.9-0.5 1.9-0.5 2.9 0 5.1 4.2 9.3 9.3 9.3h56.4c4.2 0 7.8-2.8 9-6.8l17.5-61.6h89l17.3 61.5c1.1 4 4.8 6.8 9 6.8h61.2c1 0 1.9-0.1 2.8-0.4 2.4-0.8 4.3-2.4 5.5-4.6 1.1-2.2 1.3-4.7 0.6-7.1zM663.3 325.5l32.8-116.9h6.3l32.1 116.9h-71.2z","p-id":"2263"}),Zt.createElement("path",{d:"M806.8 818.4H677.2v-0.4l132.6-188.9c1.1-1.6 1.7-3.4 1.7-5.4v-36.4c0-5.1-4.2-9.3-9.3-9.3h-204c-5.1 0-9.3 4.2-9.3 9.3v43c0 5.1 4.2 9.3 9.3 9.3h122.6v0.4L587.7 828.9c-1.1 1.6-1.7 3.4-1.7 5.4v36.4c0 5.1 4.2 9.3 9.3 9.3h211.4c5.1 0 9.3-4.2 9.3-9.3v-43c0.1-5.1-4.1-9.3-9.2-9.3z","p-id":"2264"}),Zt.createElement("path",{d:"M310.3 167.1c-3.2-4.1-9.4-4.1-12.6 0L185.7 309c-4.2 5.3-0.4 13 6.3 13h76v530c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V322h76c6.7 0 10.5-7.8 6.3-13l-112-141.9z","p-id":"2265"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"more"},Zt.createElement("path",{d:"M224 597.333333C183.466667 597.333333 149.333333 563.2 149.333333 522.666667S183.466667 448 224 448s74.666667 34.133333 74.666667 74.666667-32 74.666667-74.666667 74.666666zM512 597.333333c-40.533333 0-74.666667-34.133333-74.666667-74.666666S471.466667 448 512 448s74.666667 34.133333 74.666667 74.666667S554.666667 597.333333 512 597.333333zM800 597.333333c-40.533333 0-74.666667-34.133333-74.666667-74.666666s34.133333-74.666667 74.666667-74.666667 74.666667 34.133333 74.666667 74.666667-32 74.666667-74.666667 74.666666z"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",width:"24",height:"24",id:"text-clip"},Zt.createElement("path",{d:"M217.6 810.666667h76.8a4.266667 4.266667 0 0 0 4.266667-4.266667V217.6a4.266667 4.266667 0 0 0-4.266667-4.266667H217.6a4.266667 4.266667 0 0 0-4.266667 4.266667v588.8a4.266667 4.266667 0 0 0 4.266667 4.266667zM725.333333 217.6v247.466667a4.266667 4.266667 0 0 1-4.266666 4.266666H388.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266667h332.8a4.266667 4.266667 0 0 1 4.266666 4.266666v247.466667a4.266667 4.266667 0 0 0 4.266667 4.266667h76.8a4.266667 4.266667 0 0 0 4.266667-4.266667V217.6a4.266667 4.266667 0 0 0-4.266667-4.266667h-76.8a4.266667 4.266667 0 0 0-4.266667 4.266667z","p-id":"13371",fill:"#525C6F"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-none"},Zt.createElement("path",{d:"M657.066667 620.088889c24.177778 0 39.822222-24.177778 31.288889-46.933333L509.155556 150.755556c-14.222222-34.133333-64-34.133333-78.222223 0L250.311111 573.155556c-9.955556 22.755556 7.111111 46.933333 31.288889 46.933333 14.222222 0 25.6-8.533333 31.288889-21.333333l36.977778-92.444445h240.355555l36.977778 92.444445c4.266667 12.8 17.066667 21.333333 29.866667 21.333333z m-285.866667-170.666667L469.333333 203.377778l98.133334 246.044444H371.2zM704 662.755556c-11.377778 11.377778-11.377778 28.444444 0 39.822222l45.511111 45.511111H204.8c-15.644444 0-28.444444 12.8-28.444444 28.444444s12.8 28.444444 28.444444 28.444445h544.711111l-45.511111 45.511111c-11.377778 11.377778-11.377778 28.444444 0 39.822222 11.377778 11.377778 28.444444 11.377778 39.822222 0L839.111111 796.444444c11.377778-11.377778 11.377778-28.444444 0-39.822222l-93.866667-93.866666c-11.377778-11.377778-29.866667-11.377778-41.244444 0z","p-id":"17165"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-angleup"},Zt.createElement("path",{d:"M634.311111 398.222222c17.066667-17.066667 11.377778-45.511111-11.377778-54.044444L196.266667 170.666667c-35.555556-14.222222-69.688889 21.333333-55.466667 55.466666l172.088889 426.666667c8.533333 22.755556 38.4 28.444444 54.044444 11.377778 9.955556-9.955556 12.8-24.177778 7.111111-36.977778l-39.822222-91.022222 170.666667-170.666667 91.022222 39.822222c12.8 4.266667 28.444444 2.844444 38.4-7.111111z m-322.844444 81.066667l-105.244445-243.2L449.422222 341.333333l-137.955555 137.955556zM696.888889 393.955556c0 15.644444 12.8 28.444444 28.444444 28.444444h64L403.911111 807.822222c-11.377778 11.377778-11.377778 28.444444 0 39.822222 11.377778 11.377778 28.444444 11.377778 39.822222 0l385.422223-385.422222V526.222222c0 15.644444 12.8 28.444444 28.444444 28.444445s28.444444-12.8 28.444444-28.444445v-133.688889c0-15.644444-12.8-28.444444-28.444444-28.444444h-133.688889c-14.222222 1.422222-27.022222 14.222222-27.022222 29.866667z","p-id":"17929"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-angledown"},Zt.createElement("path",{d:"M625.777778 634.311111c17.066667 17.066667 45.511111 11.377778 54.044444-11.377778l172.088889-426.666666c14.222222-35.555556-21.333333-69.688889-55.466667-55.466667L371.2 312.888889c-22.755556 8.533333-28.444444 38.4-11.377778 54.044444 9.955556 9.955556 24.177778 12.8 36.977778 7.111111l91.022222-39.822222 170.666667 170.666667-39.822222 92.444444c-4.266667 11.377778-2.844444 27.022222 7.111111 36.977778z m-81.066667-322.844444l243.2-105.244445L682.666667 449.422222l-137.955556-137.955555zM630.044444 696.888889c-15.644444 0-28.444444 12.8-28.444444 28.444444v64L216.177778 403.911111c-11.377778-11.377778-28.444444-11.377778-39.822222 0-11.377778 11.377778-11.377778 28.444444 0 39.822222l385.422222 385.422223H497.777778c-15.644444 0-28.444444 12.8-28.444445 28.444444s12.8 28.444444 28.444445 28.444444h133.688889c15.644444 0 28.444444-12.8 28.444444-28.444444v-133.688889c-1.422222-14.222222-14.222222-27.022222-29.866667-27.022222z","p-id":"18084"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-vertical"},Zt.createElement("path",{d:"M465.066667 672.711111c-24.177778 0-39.822222-24.177778-31.288889-46.933333l179.2-423.822222c14.222222-34.133333 64-34.133333 78.222222 0L871.822222 625.777778c9.955556 22.755556-7.111111 46.933333-31.288889 46.933333-14.222222 0-25.6-8.533333-31.288889-21.333333l-36.977777-92.444445H531.911111l-36.977778 92.444445c-4.266667 12.8-17.066667 21.333333-29.866666 21.333333z m285.866666-170.666667L652.8 256 554.666667 502.044444h196.266666zM157.866667 704c11.377778-11.377778 28.444444-11.377778 39.822222 0l45.511111 45.511111V204.8c0-15.644444 12.8-28.444444 28.444444-28.444444s28.444444 12.8 28.444445 28.444444v544.711111l45.511111-45.511111c11.377778-11.377778 28.444444-11.377778 39.822222 0 11.377778 11.377778 11.377778 28.444444 0 39.822222L292.977778 839.111111c-11.377778 11.377778-28.444444 11.377778-39.822222 0l-93.866667-93.866667c-12.8-11.377778-12.8-29.866667-1.422222-41.244444z","p-id":"18239"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-up"},Zt.createElement("path",{d:"M620.088889 366.933333c0-24.177778-24.177778-39.822222-46.933333-31.288889L150.755556 514.844444c-34.133333 14.222222-34.133333 64 0 78.222223l423.822222 179.2c22.755556 9.955556 46.933333-7.111111 46.933333-31.288889 0-14.222222-8.533333-25.6-21.333333-31.288889l-92.444445-36.977778V433.777778l92.444445-36.977778c11.377778-4.266667 19.911111-17.066667 19.911111-29.866667z m-170.666667 285.866667L203.377778 554.666667l246.044444-98.133334v196.266667zM662.755556 320c11.377778 11.377778 28.444444 11.377778 39.822222 0l45.511111-45.511111v544.711111c0 15.644444 12.8 28.444444 28.444444 28.444444s28.444444-12.8 28.444445-28.444444V274.488889l45.511111 45.511111c11.377778 11.377778 28.444444 11.377778 39.822222 0 11.377778-11.377778 11.377778-28.444444 0-39.822222L796.444444 184.888889c-11.377778-11.377778-28.444444-11.377778-39.822222 0l-93.866666 93.866667c-11.377778 11.377778-11.377778 29.866667 0 41.244444z","p-id":"18394"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"screenshot"},Zt.createElement("path",{d:"M320 704V128H256v128H128v64h128v448h448v128h64v-128h128v-64H320z m384-64h64V256H384v64h320v320z","p-id":"3788"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"conditionFormat",width:"20"},Zt.createElement("path",{d:"M128 128h768v768H128V128z m64 512v128h128v-128H192z m256 0v128h192v-128H448zM192 448v128h128V448H192z m0-192v128h128V256H192z m192 0v128h192V256H384z m320 384v128h128v-128h-128z m0-192v128h128V448h-128z m0-192v128h128V256h-128z","p-id":"1955"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"splitColumn"},Zt.createElement("path",{d:"M143.36 184.32v163.84h737.28v-163.84h-737.28z m-40.96-40.96h819.2v245.76h-819.2v-245.76z m342.016 333.824l67.584 67.584 67.584-67.584c8.192-8.192 20.48-8.192 28.672 0 8.192 8.192 8.192 20.48 0 28.672l-96.256 96.256-96.256-96.256c-8.192-8.192-8.192-20.48 0-28.672 8.192-8.192 20.48-8.192 28.672 0z m-342.016 157.696h368.64v245.76h-368.64v-245.76z m450.56 0h368.64v245.76h-368.64v-245.76z m-409.6 204.8h286.72v-163.84h-286.72v163.84z m450.56 0h286.72v-163.84h-286.72v163.84z","p-id":"1984"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"locationCondition"},Zt.createElement("path",{d:"M938.666667 388.266667H584.533333V247.466667a21.333333 21.333333 0 0 0-21.333333-21.333334H85.333333A21.333333 21.333333 0 0 0 64 247.466667v324.266666a21.333333 21.333333 0 0 0 21.333333 21.333334h277.333334V785.066667a21.333333 21.333333 0 0 0 21.333333 21.333333h554.666667a21.333333 21.333333 0 0 0 21.333333-21.333333V409.6a21.333333 21.333333 0 0 0-21.333333-21.333333z m-832 162.133333v-281.6h435.2v119.466667H384a21.333333 21.333333 0 0 0-21.333333 21.333333v140.8h-256z","p-id":"9672"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"dataVerification"},Zt.createElement("path",{d:"M510.9 921.6l-107.8-66.2c-124.6-76.5-202-214.8-202-361.1V243.9h21.7c205.1 0 262-115.5 267.8-128.6l5.7-13 28.7-0.3 6.2 13.1c5.9 13.3 62.8 128.8 267.8 128.8h21.7v250.4c0 146.3-77.4 284.6-202 361.1l-107.8 66.2zM244.5 287v207.3c0 131.2 69.5 255.4 181.3 324.1l85.1 52.2 85.1-52.2c111.8-68.6 181.3-192.8 181.3-324.1V287c-157.7-6.1-234.1-77.8-266.4-121.7-32.2 43.8-108.6 115.6-266.4 121.7z","p-id":"5514"}),Zt.createElement("path",{d:"M502.2 617.3c-5.6 0-11.1-2.1-15.4-6.4L410 534.1c-8.5-8.5-8.5-22.2 0-30.7s22.2-8.5 30.7 0l61.4 61.4 108.7-108.7c8.5-8.5 22.2-8.5 30.7 0s8.5 22.2 0 30.7l-124 124.1c-4.2 4.2-9.8 6.4-15.3 6.4z","p-id":"5515"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-down"},Zt.createElement("path",{d:"M403.911111 657.066667c0 24.177778 24.177778 39.822222 46.933333 31.288889L873.244444 509.155556c34.133333-14.222222 34.13333299-64 0-78.222223L450.844444 250.311111c-22.755556-9.955556-46.933333 7.111111-46.933333 31.288889 0 14.222222 8.533333 25.6 21.333333 31.288889l92.444445 36.977778-1e-8 240.355555-92.44444499 36.977778c-12.8 4.266667-21.333333 17.066667-21.333333 29.866667z m170.666667-285.86666701L820.622222 469.33333299l-246.044444 98.13333401L574.577778 371.19999999zM361.244444 704c-11.377778-11.377778-28.444444-11.377778-39.822222 0l-45.511111 45.511111L275.911111 204.79999999c0-15.644444-12.8-28.444444-28.44444399-28.44444399s-28.444444 12.8-28.44444501 28.444444l-1e-8 544.711111-45.51111099-45.511111c-11.377778-11.377778-28.444444-11.377778-39.822222 0-11.377778 11.377778-11.377778 28.444444 0 39.822222L227.555556 839.111111c11.377778 11.377778 28.444444 11.377778 39.822222-1e-8l93.866666-93.86666699c11.377778-11.377778 11.377778-29.866667 0-41.244444z","p-id":"10914"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"search"},Zt.createElement("path",{d:"M469.333 192c153.174 0 277.334 124.16 277.334 277.333 0 68.054-24.534 130.411-65.216 178.688L846.336 818.24l-48.341 49.877L630.4 695.125a276.053 276.053 0 0 1-161.067 51.542C316.16 746.667 192 622.507 192 469.333S316.16 192 469.333 192z m0 64C351.51 256 256 351.51 256 469.333s95.51 213.334 213.333 213.334 213.334-95.51 213.334-213.334S587.157 256 469.333 256z","p-id":"11202"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"link"},Zt.createElement("path",{d:"M577.155781 655.619241L431.54903 801.139578a119.509873 119.509873 0 0 1-169.111224 0l-26.442532-25.924051a119.6827 119.6827 0 0 1 0-169.111223L366.393249 475.274262a21.344135 21.344135 0 0 1 30.417553 0 21.516962 21.516962 0 0 1 0 30.503966L266.585654 636.176203a76.389536 76.389536 0 0 0 0 108.016877l26.442532 26.442532a76.389536 76.389536 0 0 0 108.016877 0l145.520338-145.606751a76.389536 76.389536 0 0 0 0-108.016878L535.763713 505.864641A21.516962 21.516962 0 0 1 535.763713 475.274262a21.344135 21.344135 0 0 1 30.417553 0l11.233755 11.147341a119.6827 119.6827 0 0 1-0.25924 169.197638z","p-id":"28239"}),Zt.createElement("path",{d:"M546.565401 517.011983L535.763713 505.864641A21.516962 21.516962 0 0 1 535.763713 475.274262a21.344135 21.344135 0 0 1 30.417553 0l11.233755 11.147341","p-id":"28240"}),Zt.createElement("path",{d:"M446.844219 368.380759l145.606751-145.520337a119.509873 119.509873 0 0 1 169.111224 0l26.442532 26.356118a119.6827 119.6827 0 0 1 0 169.111224L657.606751 548.639325a21.344135 21.344135 0 0 1-30.417553 0 21.516962 21.516962 0 0 1 0-30.503966l130.225148-130.311562a76.389536 76.389536 0 0 0 0-108.016877l-26.442532-26.442532a76.389536 76.389536 0 0 0-108.016877 0L477.434599 398.971139a76.389536 76.389536 0 0 0 0 108.016878L488.581941 518.481013a21.516962 21.516962 0 0 1 0 30.503966 21.344135 21.344135 0 0 1-30.417553 0l-11.233755-11.147342a119.6827 119.6827 0 0 1-0.086414-169.456878z","p-id":"28241"}),Zt.createElement("path",{d:"M477.434599 506.988017L488.581941 518.481013a21.516962 21.516962 0 0 1 0 30.503966 21.344135 21.344135 0 0 1-30.417553 0l-11.233755-11.147342","p-id":"28242"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"copy"},Zt.createElement("path",{d:"M832 128c-12.8-76.8-76.8-128-160-128h-448C102.4 0 0 102.4 0 224v448c0 76.8 57.6 140.8 128 160 12.8 76.8 76.8 128 160 128h512c89.6 0 160-70.4 160-160v-512c0-76.8-57.6-140.8-128-160zM64 672v-448C64 134.4 134.4 64 224 64h448c44.8 0 76.8 25.6 89.6 64H288C198.4 128 128 198.4 128 288v473.6c-38.4-12.8-64-44.8-64-89.6z m832 128c0 51.2-44.8 96-96 96h-512c-51.2 0-96-44.8-96-96v-512C192 236.8 236.8 192 288 192h512c51.2 0 96 44.8 96 96v512z","p-id":"28791"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"pencil"},Zt.createElement("path",{d:"M966.283012 57.28336A194.600516 194.600516 0 0 0 828.144425 0.000203c-49.932663 0-100.118792 19.009897-138.138586 57.283157l-667.12066 667.12066-22.811877 276.784103c-1.013861 12.166334 8.61782 22.304946 20.530689 22.304946h1.774257l276.784104-22.811876 667.12066-667.12066c76.293054-76.293054 76.293054-199.984119 0-276.277173zM271.534635 941.116848l-205.813821 16.72871L82.702989 751.778272l547.231575-547.231575 189.085111 189.085111-547.48504 547.48504zM922.686981 289.964502l-60.071275 60.071275-189.085111-189.085111 60.071275-60.071275c25.34653-25.34653 58.803949-39.033656 94.542555-39.033656 35.738607 0 69.196026 13.940591 94.542556 39.033656 52.213851 52.213851 52.213851 136.87126 0 189.085111z","p-id":"40167"})),Zt.createElement("symbol",{fill:"#535A68",id:"unlink",viewBox:"0 0 1024 1024"},Zt.createElement("path",{d:"M240.469333 240.469333l241.194667 241.194667 90.965333-90.965333a42.88 42.88 0 0 1 60.672 60.672L542.293333 542.293333l241.237334 241.237334a42.666667 42.666667 0 0 1-60.330667 60.330666l-119.936-119.893333-151.893333 151.893333a214.4 214.4 0 0 1-309.674667-296.533333l6.4-6.698667 151.936-151.893333-119.893333-119.893333a42.666667 42.666667 0 0 1 60.330666-60.373334z m120.192 240.896l-151.893333 151.893334a128.64 128.64 0 0 0 176.426667 187.136l5.546666-5.162667 151.850667-151.936-60.629333-60.629333-30.592 30.634666a42.88 42.88 0 1 1-60.672-60.672l30.634666-30.592-60.672-60.672z m515.2-333.226666a214.4 214.4 0 0 1 0 303.232l-121.301333 121.258666A42.88 42.88 0 1 1 693.973333 512l121.258667-121.301333a128.64 128.64 0 0 0-181.930667-181.930667L512 330.069333a42.88 42.88 0 1 1-60.629333-60.629333l121.258666-121.301333a214.4 214.4 0 0 1 303.232 0z m-333.653333 273.365333l-60.373333 60.330667 60.330666 60.330666 60.330667-60.330666-60.330667-60.330667z","p-id":"39251"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"filter"},Zt.createElement("path",{d:"M872.533333 134.4c-12.8-10.666667-29.866667-17.066667-49.066666-17.066667H198.4C157.866667 117.333333 123.733333 151.466667 123.733333 192c0 17.066667 6.4 34.133333 17.066667 49.066667l256 302.933333v251.733333c0 12.8 6.4 23.466667 17.066667 27.733334l162.133333 81.066666c4.266667 2.133333 8.533333 4.266667 14.933333 4.266667 6.4 0 10.666667-2.133333 17.066667-4.266667 8.533333-6.4 14.933333-17.066667 14.933333-27.733333V541.866667l256-302.933334c12.8-14.933333 19.2-34.133333 17.066667-53.333333 2.133333-19.2-6.4-38.4-23.466667-51.2z m-38.4 64L569.6 509.866667c-4.266667 6.4-8.533333 12.8-8.533333 21.333333v292.266667l-98.133334-49.066667V531.2c0-8.533333-2.133333-14.933333-8.533333-21.333333L189.866667 198.4c0-2.133333-2.133333-4.266667-2.133334-6.4 0-6.4 4.266667-10.666667 10.666667-10.666667h625.066667c2.133333 0 4.266667 0 6.4 2.133334 2.133333 2.133333 4.266667 6.4 4.266666 6.4 2.133333 2.133333 2.133333 6.4 0 8.533333z","p-id":"43580"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"filter1"},Zt.createElement("path",{d:"M608 864C588.8 864 576 851.2 576 832L576 448c0-6.4 6.4-19.2 12.8-25.6L787.2 256c6.4-6.4 6.4-19.2 0-19.2 0-6.4-6.4-12.8-19.2-12.8L256 224c-12.8 0-19.2 6.4-19.2 12.8 0 6.4-6.4 12.8 6.4 19.2l198.4 166.4C441.6 428.8 448 441.6 448 448l0 256c0 19.2-12.8 32-32 32S384 723.2 384 704L384 460.8 198.4 307.2c-25.6-25.6-32-64-19.2-96C185.6 179.2 217.6 160 256 160L768 160c32 0 64 19.2 76.8 51.2 12.8 32 6.4 70.4-19.2 89.6l-192 160L633.6 832C640 851.2 627.2 864 608 864z","p-id":"43727"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"eraser"},Zt.createElement("path",{d:"M596.437333 85.333333a42.837333 42.837333 0 0 0-30.549333 13.824l-469.333333 512a42.666667 42.666667 0 0 0 1.28 59.008l170.666666 170.666667A42.496 42.496 0 0 0 298.666667 853.333333h512v-85.333333h-195.669334l311.168-311.168a42.538667 42.538667 0 0 0 0-60.330667l-298.666666-298.666666A43.221333 43.221333 0 0 0 596.437333 85.333333z m-102.144 682.666667H316.330667l-129.28-129.28 268.8-293.205333 230.485333 230.485333-192.042667 192z m252.373334-252.330667l-233.130667-233.130666 85.12-92.842667L835.669333 426.666667 746.666667 515.669333z","p-id":"50819"})),Zt.createElement("symbol",{viewBox:"0 0 1057 1024",fill:"#535A68",id:"sort"},Zt.createElement("path",{d:"M438.634667 192v644.202667l-0.810667 5.781333c-1.152 7.210667-2.304 8.704-8.64 17.002667l-7.168 3.925333c-15.914667 8.490667-18.282667 7.168-38.4-3.925333L149.333333 624.533333l45.269334-45.226666 180.032 180.138666V192h64z m216.96 10.005333l231.04 231.146667-45.269334 45.248L661.333333 298.261333V865.706667h-64V226.133333a34.133333 34.133333 0 0 1 58.282667-24.128z","p-id":"52781"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"filter-fill"},Zt.createElement("path",{d:"M776.341333 170.666667a64 64 0 0 1 49.557334 104.512L627.541333 517.76v273.386667L398.293333 687.018667v-169.237334l-192.469333-243.413333A64 64 0 0 1 256 170.666667h520.341333z","p-id":"18344"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#ffffff",id:"filter-fill-white"},Zt.createElement("path",{d:"M776.341333 170.666667a64 64 0 0 1 49.557334 104.512L627.541333 517.76v273.386667L398.293333 687.018667v-169.237334l-192.469333-243.413333A64 64 0 0 1 256 170.666667h520.341333z","p-id":"18344"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"all-sheets"},Zt.createElement("path",{d:"M849.427 1000.999h-157.9c-73.785 0-132.809-59.029-132.809-132.809v-258.243c0-14.759 10.33-26.562 25.088-29.513 4.427-1.472 8.853-2.953 13.278-2.953h252.337c73.785 0 132.809 59.029 132.809 132.809v157.9c-1.472 72.309-60.5 132.809-132.809 132.809zM616.268 636.505v231.684c0 39.844 32.468 73.785 73.785 73.785h157.9c39.844 0 73.785-32.468 73.785-73.785v-157.9c0-39.844-32.468-73.785-73.785-73.785h-231.684z","p-id":"4941"}),Zt.createElement("path",{d:"M315.23 1000.999h-147.571c-76.736 0-137.241-61.981-137.241-137.241v-147.571c0-76.736 61.981-137.241 137.241-137.241h247.911c4.427 0 8.853 1.472 13.278 2.953 14.759 1.472 25.088 14.759 25.088 29.513v253.814c0 73.785-61.981 135.764-138.711 135.764zM167.657 636.505c-42.796 0-78.211 35.418-78.211 78.211v147.571c0 44.269 35.418 78.211 78.211 78.211h147.571c42.796 0 78.211-35.418 78.211-78.211v-225.779h-225.779z","p-id":"4942"}),Zt.createElement("path",{d:"M415.576 471.232h-255.291c-72.309 0-129.859-57.549-129.859-129.859v-163.801c0-72.309 57.549-129.859 129.859-129.859h163.801c72.309 0 129.859 57.549 129.859 129.859v261.199c0 14.759-10.33 26.562-25.088 29.513-4.427 1.472-8.853 2.953-13.278 2.953zM158.805 105.259c-38.369 0-70.836 32.468-70.836 70.836v165.279c0 38.369 32.468 70.836 70.836 70.836h234.634v-234.634c0-38.369-32.468-70.836-70.836-70.836h-163.801z","p-id":"4943"}),Zt.createElement("path",{d:"M847.948 471.232h-252.337c-4.427 0-8.853-1.472-13.278-2.953-14.759-1.472-25.088-14.759-25.088-29.513v-258.243c0-73.785 60.5-134.287 134.287-134.287h156.423c73.785 0 134.287 60.5 134.287 134.287v156.423c-1.472 73.785-60.5 134.287-134.287 134.287zM616.268 412.199h230.207c41.318 0 75.263-33.941 75.263-75.263v-156.423c0-41.318-33.941-75.263-75.263-75.263h-156.423c-41.318 0-75.263 33.941-75.263 75.263v231.684z","p-id":"4944"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"hidden"},Zt.createElement("path",{d:"M849.152 665.429333c62.762667-69.674667 86.826667-138.538667 87.296-139.904a42.410667 42.410667 0 0 0 0-27.008C935.552 495.658667 837.674667 213.333333 512 213.333333c-37.802667 0-72.192 4.138667-104.064 10.837334l75.776 75.776c9.301333-0.554667 18.517333-1.28 28.288-1.28 228.309333 0 316.757333 164.096 338.176 213.333333a369.365333 369.365333 0 0 1-60.544 93.866667l59.52 59.562666zM512 810.666667c78.293333 0 143.146667-16.597333 196.906667-41.429334l156.928 156.928 60.330666-60.330666-768-768-60.330666 60.330666 141.610666 141.610667c-111.530667 83.285333-151.338667 196.906667-151.936 198.698667a42.410667 42.410667 0 0 0 0 27.008C88.448 528.341333 186.325333 810.666667 512 810.666667zM299.989333 360.32l96.938667 96.938667c-22.229333 47.488-14.378667 106.282667 24.533333 145.194666s97.706667 46.805333 145.194667 24.533334l76.842667 76.842666A394.325333 394.325333 0 0 1 512 725.333333c-228.309333 0-316.757333-164.096-338.176-213.333333a366.933333 366.933333 0 0 1 126.165333-151.68z","p-id":"19355"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"check"},Zt.createElement("path",{d:"M439.439404 776.947278a32.717146 32.717146 0 0 1-21.343097-7.892761L185.810916 570.228169c-13.779841-11.795651-15.389502-32.527834-3.593851-46.308698 11.795651-13.778818 32.528857-15.390525 46.308699-3.593852L435.957093 697.877431l349.863273-405.566946c11.846816-13.736862 32.588209-15.265682 46.323025-3.415796 13.733792 11.847839 15.263635 32.587186 3.414773 46.322002l-371.235023 430.340165c-6.492878 7.52744-15.661701 11.390421-24.883737 11.390422z",fill:"","p-id":"5612"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#A8ABB0",id:"rightArrow"},Zt.createElement("path",{d:"M781.963636 495.709091l-418.909091-323.490909c-20.945455-16.290909-37.236364-9.309091-37.236363 16.290909v646.981818c0 25.6 16.290909 32.581818 37.236363 16.290909l418.909091-323.490909c11.636364-9.309091 11.636364-23.272727 0-32.581818z","p-id":"5380"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"downArrow"},Zt.createElement("path",{d:"M163.396608 289.168384c-40.577024 0-66.526208 54.183936-35.44064 85.25824L477.217792 723.704832c20.031488 20.031488 49.82272 20.031488 69.853184 0l349.274112-349.278208c30.30528-30.294016 6.677504-85.25824-34.927616-85.25824L163.396608 289.168384z","p-id":"2683"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#272636",id:"headDownArrow"},Zt.createElement("path",{d:"M0 511.976727C0 229.678545 229.725091 0 511.976727 0s511.976727 229.632 511.976727 511.976727c0 282.391273-229.725091 511.976727-511.976727 511.976727C229.725091 1024 0 794.368 0 511.976727M955.717818 511.976727c0-244.898909-199.121455-444.206545-443.741091-444.206545-244.666182 0-443.694545 199.307636-443.694545 444.206545 0 244.945455 199.121455 444.253091 443.694545 444.253091C756.642909 956.276364 955.717818 756.968727 955.717818 511.976727M230.027636 419.025455c0-6.562909 2.420364-13.102545 7.563636-18.059636 9.914182-9.960727 26.042182-9.960727 36.096 0l238.289455 236.916364L750.312727 401.105455c9.960727-9.914182 26.135273-9.914182 36.305455 0 9.914182 9.960727 9.914182 26.042182 0 35.956364L511.976727 709.678545 237.474909 436.922182C232.424727 432.104727 230.027636 425.588364 230.027636 419.025455","p-id":"5142"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",id:"tab"},Zt.createElement("path",{d:"M960 591.424V368.96c0-0.288 0.16-0.512 0.16-0.768S960 367.68 960 367.424V192a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v175.424c0 0.288-0.16 0.512-0.16 0.768s0.16 0.48 0.16 0.768v222.464c0 0.288-0.16 0.512-0.16 0.768s0.16 0.48 0.16 0.768V864a32 32 0 0 0 32 32h832a32 32 0 0 0 32-32v-271.04c0-0.288 0.16-0.512 0.16-0.768S960 591.68 960 591.424z m-560-31.232v-160H608v160h-208z m208 64V832h-208v-207.808H608z m-480-224h208v160H128v-160z m544 0h224v160h-224v-160zM896 224v112.192H128V224h768zM128 624.192h208V832H128v-207.808zM672 832v-207.808h224V832h-224z","p-id":"3023"})),Zt.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"default"},Zt.createElement("path",{d:"M844.8 896c25.6 0 51.2-19.2 51.2-51.2v-185.6h-51.2c-44.8 0-83.2-38.4-83.2-83.2s38.4-83.2 83.2-83.2h51.2V313.6c0-25.6-19.2-51.2-51.2-51.2h-134.4c0-70.4-57.6-128-128-128S448 185.6 448 256H313.6c-25.6 0-51.2 19.2-51.2 51.2V448C185.6 448 128 505.6 128 576s57.6 128 128 128v134.4c0 25.6 19.2 51.2 51.2 51.2h185.6v-51.2c0-44.8 38.4-83.2 83.2-83.2 44.8 0 83.2 38.4 83.2 83.2v57.6h185.6zM576 710.4c-70.4 0-128 57.6-128 128H307.2v-185.6H256c-44.8 0-83.2-38.4-83.2-83.2S211.2 492.8 256 492.8h51.2V307.2h185.6V256c0-44.8 38.4-83.2 83.2-83.2 44.8 0 83.2 38.4 83.2 83.2v51.2h185.6V448c-70.4 0-128 57.6-128 128s57.6 128 128 128v140.8H704c6.4-70.4-51.2-134.4-128-134.4z",fill:"","p-id":"36983"}))))};var cl=function ChangeColor(e){var t=e.triggerParentUpdate;var l=qt(cn),o=l.context,a=l.setContext;var r=C(o),i=r.toolbar,c=r.sheetconfig,u=r.button;var s=Yt("#000000"),d=_slicedToArray(s,2),v=d[0],m=d[1];var f=Yt(o.luckysheetfile[n(o,o.currentSheetId)].color),h=_slicedToArray(f,2),p=h[0],y=h[1];var g=$t((function(){y(v)}),[v]);Jt((function(){a((function(e){if(e.allowEdit!==false){var t=n(e,e.currentSheetId);e.luckysheetfile[t].color=p}}))}),[p,a]);return Zt.createElement("div",{id:"fortune-change-color"},Zt.createElement("div",{className:"color-reset",onClick:function onClick(){return y(void 0)}},c.resetColor),Zt.createElement("div",{className:"custom-color"},Zt.createElement("div",null,i.customColor,":"),Zt.createElement("input",{type:"color",value:v,onChange:function onChange(e){return m(e.target.value)},onFocus:function onFocus(){t(true)},onBlur:function onBlur(){t(false)}}),Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){g()}},u.confirm)),Zt.createElement(Kn,{onPick:function onPick(e){m(e);y(e)}}))};var ul=function SheetTabContextMenu(){var e;var t=qt(cn),n=t.context,l=t.setContext,o=t.settings;var a=n.sheetTabContextMenu,r=a.x,i=a.y,c=a.sheet,u=a.onRename;var s=C(n),d=s.sheetconfig;var v=Yt({x:-1,y:-1}),m=_slicedToArray(v,2),f=m[0],h=m[1];var p=Yt(false),y=_slicedToArray(p,2),g=y[0],k=y[1];var E=Yt(false),b=_slicedToArray(E,2),w=b[0],x=b[1];var _=useAlert(),N=_.showAlert,M=_.hideAlert;var R=Xt(null);var L=$t((function(){l((function(e){e.sheetTabContextMenu={}}))}),[l]);Qt((function(){var e;var t=(e=R.current)===null||e===void 0?void 0:e.getBoundingClientRect();t&&r!=null&&i!=null&&h({x:r,y:i-t.height})}),[r,i]);useOutsideClick(R,L,[L]);var S=$t((function(e){n.allowEdit!==false&&c&&l((function(t){var n=-1;an.sortBy(t.luckysheetfile,["order"]).forEach((function(e,t){e.order=t;e.id===c.id&&(n=t)}));Nt.setSheetOrder(t,_defineProperty({},c.id,n+e))}))}),[n.allowEdit,l,c]);var V=$t((function(){n.allowEdit!==false&&c&&l((function(e){var t=e.luckysheetfile.filter((function(e){return an.isUndefined(e.hide)||(e===null||e===void 0?void 0:e.hide)!==1}));t.length>1?Nt.hideSheet(e,c.id):N(d.noMoreSheet,"ok")}))}),[n.allowEdit,l,c,N,d]);var H=$t((function(){n.allowEdit!==false&&(c===null||c===void 0?void 0:c.id)&&l((function(e){Nt.copySheet(e,c.id)}),{addSheetOp:true})}),[n.allowEdit,l,c===null||c===void 0?void 0:c.id]);var T=$t((function(e){x(e)}),[]);var D=$t((function(){n.allowEdit!==false&&(c===null||c===void 0?void 0:c.id)&&l((function(e){an.forEach(e.luckysheetfile,(function(e){e.status=c.id===e.id?1:0}))}))}),[n.allowEdit,l,c===null||c===void 0?void 0:c.id]);return c&&r!=null&&i!=null?Zt.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu",onContextMenu:function onContextMenu(e){return e.stopPropagation()},style:{left:f.x,top:f.y,overflow:"visible"},ref:R},(e=o.sheetTabContextMenu)===null||e===void 0?void 0:e.map((function(e,t){return e==="delete"?Zt.createElement(ol,{key:e,onClick:function onClick(){var e=n.luckysheetfile.filter((function(e){return an.isUndefined(e.hide)||e.hide!==1}));n.luckysheetfile.length>1&&e.length>1?N(d.confirmDelete,"yesno",(function(){l((function(e){Vt(e,c.id)}),{deleteSheetOp:{id:c.id}});M()})):N(d.noMoreSheet,"ok");L()}},d.delete):e==="rename"?Zt.createElement(ol,{key:e,onClick:function onClick(){u===null||u===void 0?void 0:u();L()}},d.rename):e==="move"?Zt.createElement(Zt.Fragment,{key:e},Zt.createElement(ol,{onClick:function onClick(){S(-1.5);L()}},d.moveLeft),Zt.createElement(ol,{onClick:function onClick(){S(1.5);L()}},d.moveRight)):e==="hide"?Zt.createElement(ol,{key:e,onClick:function onClick(){V();L()}},d.hide):e==="copy"?Zt.createElement(ol,{key:e,onClick:function onClick(){H();L()}},d.copy):e==="color"?Zt.createElement(ol,{key:e,onMouseEnter:function onMouseEnter(){k(true)},onMouseLeave:function onMouseLeave(){w||k(false)}},d.changeColor,Zt.createElement("span",{className:"change-color-triangle"},Zt.createElement(un,{name:"rightArrow",width:18})),g&&n.allowEdit&&Zt.createElement(cl,{triggerParentUpdate:T})):e==="focus"?Zt.createElement(ol,{key:e,onClick:function onClick(){D();L()}},d.focus):e==="|"?Zt.createElement(ll,{key:"divide-".concat(t)}):null}))):null};var sl=function MoreItemsContaier(e){var t=e.onClose,n=e.children;var l=Xt(null);useOutsideClick(l,(function(){t===null||t===void 0?void 0:t()}),[l,t]);return Zt.createElement("div",{ref:l,className:"fortune-toolbar-more-container"},n)};function generateAPIs(e,t,l,o,a,r,i,c){return{applyOp:function applyOp(e){t((function(t){var l,o,r,i,c;var u=Ht(t,e),s=_slicedToArray(u,2),d=s[0],v=s[1];if(v.length>0){var m=_slicedToArray(v,1),f=m[0];if(f.op==="insertRowCol")try{we(t,f.value,false)}catch(e){console.error(e)}else if(f.op==="deleteRowCol")wt(t,f.value);else if(f.op==="addSheet"){var h,p,y;var g=(h=d.filter((function(e){return e.path[0]==="name"})))===null||h===void 0||(p=h[0])===null||p===void 0?void 0:p.value;((y=f.value)===null||y===void 0?void 0:y.id)&&gt(t,a,f.value.id,false,g,f.value);var k=n(t,f.value.id);Nt.initSheetData(t,k,f.value)}else if(f.op==="deleteSheet"){Vt(t,f.value.id);d.length=0}}if(((l=e[0])===null||l===void 0||(o=l.path)===null||o===void 0?void 0:o[0])==="filter_select")t.luckysheet_filter_save=e[0].value;else if(((r=e[0])===null||r===void 0||(i=r.path)===null||i===void 0?void 0:i[0])==="hide"&&t.currentSheetId===e[0].id){var E=t.luckysheetfile.filter((function(t){return(an.isUndefined(t.hide)||(t===null||t===void 0?void 0:t.hide)!==1)&&t.id!==e[0].id}));t.currentSheetId=an.sortBy(E,(function(e){return e.order}))[0].id}$(t,t.luckysheet_filter_save,(c=e[0])===null||c===void 0?void 0:c.id);if(d.length!==0)try{nn(t,d)}catch(e){console.error(e)}}),{noHistory:true})},getCellValue:function getCellValue(t,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Nt.getCellValue(e,t,n,l)},setCellValue:function setCellValue(e,n,l){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return t((function(t){return Nt.setCellValue(t,e,n,l,r,o)}))},clearCell:function clearCell(e,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t((function(t){return Nt.clearCell(t,e,n,l)}))},setCellFormat:function setCellFormat(e,n,l,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return t((function(t){return Nt.setCellFormat(t,e,n,l,o,a)}))},autoFillCell:function autoFillCell(e,n,l){return t((function(t){return Nt.autoFillCell(t,e,n,l)}))},freeze:function freeze(e,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t((function(t){return Nt.freeze(t,e,n,l)}))},insertRowOrColumn:function insertRowOrColumn(e,n,l){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"rightbottom";var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return t((function(t){return Nt.insertRowOrColumn(t,e,n,l,o,a)}))},deleteRowOrColumn:function deleteRowOrColumn(e,n,l){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return t((function(t){return Nt.deleteRowOrColumn(t,e,n,l,o)}))},setRowHeight:function setRowHeight(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var l=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return t((function(t){return Nt.setRowHeight(t,e,n,l)}))},setColumnWidth:function setColumnWidth(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var l=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return t((function(t){return Nt.setColumnWidth(t,e,n,l)}))},getRowHeight:function getRowHeight(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nt.getRowHeight(e,t,n)},getColumnWidth:function getColumnWidth(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nt.getColumnWidth(e,t,n)},getSelection:function getSelection(){return Nt.getSelection(e)},getFlattenRange:function getFlattenRange(t){return Nt.getFlattenRange(e,t)},getCellsByFlattenRange:function getCellsByFlattenRange(t){return Nt.getCellsByFlattenRange(e,t)},getSelectionCoordinates:function getSelectionCoordinates(){return Nt.getSelectionCoordinates(e)},getCellsByRange:function getCellsByRange(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nt.getCellsByRange(e,t,n)},getHtmlByRange:function getHtmlByRange(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nt.getHtmlByRange(e,t,n)},setSelection:function setSelection(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t((function(t){return Nt.setSelection(t,e,n)}))},setCellValuesByRange:function setCellValuesByRange(e,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t((function(t){return Nt.setCellValuesByRange(t,e,n,r,l)}))},setCellFormatByRange:function setCellFormatByRange(e,n,l){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return t((function(t){return Nt.setCellFormatByRange(t,e,n,l,o)}))},mergeCells:function mergeCells(e,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t((function(t){return Nt.mergeCells(t,e,n,l)}))},cancelMerge:function cancelMerge(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t((function(t){return Nt.cancelMerge(t,e,n)}))},getAllSheets:function getAllSheets(){return Nt.getAllSheets(e)},getSheet:function getSheet(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Nt.getSheetWithLatestCelldata(e,t)},addSheet:function addSheet(){return t((function(e){return Nt.addSheet(e,a)}))},deleteSheet:function deleteSheet(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t((function(t){return Nt.deleteSheet(t,e)}))},updateSheet:function updateSheet(e){return t((function(t){return Nt.updateSheet(t,e)}))},activateSheet:function activateSheet(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t((function(t){return Nt.activateSheet(t,e)}))},setSheetName:function setSheetName(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t((function(t){return Nt.setSheetName(t,e,n)}))},setSheetOrder:function setSheetOrder(e){return t((function(t){return Nt.setSheetOrder(t,e)}))},scroll:function scroll(t){return Nt.scroll(e,i,c,t)},addPresences:function addPresences(e){t((function(t){t.presences=an.differenceBy(t.presences||[],e,(function(e){return e.userId==null?e.username:e.userId})).concat(e)}))},removePresences:function removePresences(e){t((function(t){t.presences!=null&&(t.presences=an.differenceBy(t.presences,e,(function(e){return e.userId==null?e.username:e.userId})))}))},handleUndo:l,handleRedo:o,calculateFormula:function calculateFormula(){t((function(e){an.forEach(e.luckysheetfile,(function(t){Nt.calculateSheetFromula(e,t.id)}))}))},dataToCelldata:function dataToCelldata(e){return Nt.dataToCelldata(e)},celldataToData:function celldataToData(e,t,n){return Nt.celldataToData(e,t,n)}}}var dl=function SelectItem(e){var t=e.item,n=e.isChecked,l=e.onChange,o=e.isItemVisible;var a=Gt((function(){return n(t.key)}),[n,t.key]);return o(t)?Zt.createElement("div",{className:"select-item"},Zt.createElement("input",{className:"filter-checkbox",type:"checkbox",checked:a,onChange:function onChange(){l(t,!a)}}),Zt.createElement("div",null,t.text),Zt.createElement("span",{className:"count"},"( ".concat(t.rows.length," )"))):null};var vl=function DateSelectTreeItem(e){var t=e.item,n=e.depth,l=n===void 0?0:n,o=e.initialExpand,a=e.onExpand,r=e.isChecked,i=e.onChange,c=e.isItemVisible;var u=Yt(o(t.key)),s=_slicedToArray(u,2),d=s[0],v=s[1];var m=Gt((function(){return r(t.key)}),[r,t.key]);return c(t)?Zt.createElement("div",null,Zt.createElement("div",{className:"select-item",style:{marginLeft:l*20-2},onClick:function onClick(){a===null||a===void 0?void 0:a(t.key,!d);v(!d)}},an.isEmpty(t.children)?Zt.createElement("div",{style:{width:10}}):Zt.createElement("div",{className:"filter-caret ".concat(d?"down":"right"),style:{cursor:"pointer"}}),Zt.createElement("input",{className:"filter-checkbox",type:"checkbox",checked:m,onChange:function onChange(){i(t,!m)},onClick:function onClick(e){return e.stopPropagation()}}),Zt.createElement("div",null,t.text),Zt.createElement("span",{className:"count"},"( ".concat(t.rows.length," )"))),d&&t.children.map((function(e){return Zt.createElement(DateSelectTreeItem,_objectSpread2({key:e.key,item:e,depth:l+1},{initialExpand:o,onExpand:a,isChecked:r,onChange:i,isItemVisible:c}))}))):null};var ml=function DateSelectTree(e){var t=e.dates,n=e.initialExpand,l=e.onExpand,o=e.isChecked,a=e.onChange,r=e.isItemVisible;return Zt.createElement(Zt.Fragment,null,t.map((function(e){return Zt.createElement(vl,_objectSpread2({key:e.key,item:e},{initialExpand:n,onExpand:l,isChecked:o,onChange:a,isItemVisible:r}))})))};var fl=function FilterMenu(){var e;var t=qt(cn),n=t.context,l=t.setContext,o=t.settings,a=t.refs;var r=Xt(null);var i=Xt(n);var c=Xt(null);var u=Xt(null);var s=n.filterContextMenu;var d=s||{startRow:null,startCol:null,endRow:null,endCol:null,col:null,listBoxMaxHeight:400},v=d.startRow,m=d.startCol,f=d.endRow,h=d.endCol,p=d.col,y=d.listBoxMaxHeight;var g=C(n),k=g.filter;var E=Yt({dates:[],dateRowMap:{},values:[],valueRowMap:{},visibleRows:[],flattenValues:[]}),b=_slicedToArray(E,2),w=b[0],x=b[1];var _=Yt([]),N=_slicedToArray(_,2),M=N[0],R=N[1];var L=Yt([]),S=_slicedToArray(L,2),V=S[0],H=S[1];var T=Xt({});var D=Xt([]);var I=Yt([]),z=_slicedToArray(I,2),A=z[0],B=z[1];var F=Yt(""),W=_slicedToArray(F,2),P=W[0],O=W[1];var U=Yt(),j=_slicedToArray(U,2),K=j[0],Z=j[1];var q=Yt({bgColors:[],fcColors:[]}),X=_slicedToArray(q,2),Y=X[0],G=X[1];var $=Yt(false),J=_slicedToArray($,2),Q=J[0],ee=J[1];var te=useAlert(),ne=te.showAlert;var le=Xt(false);i.current=n;var oe=$t((function(){l((function(e){e.filterContextMenu=void 0}))}),[l]);useOutsideClick(r,oe,[oe]);var ae=$t((function(e){var t=T.current[e];if(t==null){T.current[e]=true;return true}return t}),[]);var re=$t((function(e,t){T.current[e]=t}),[]);var ie=Gt((function(){return an.debounce((function(e){B(an.filter(w.flattenValues,(function(t){return t.toLowerCase().indexOf(e.toLowerCase())>-1})))}),300)}),[w.flattenValues]);var ce=$t((function(){R([]);H([]);D.current=[]}),[]);var ue=$t((function(){R(an.keys(w.dateRowMap));H(an.keys(w.valueRowMap));D.current=w.visibleRows}),[w.dateRowMap,w.valueRowMap,w.visibleRows]);var se=$t((function(){R(tn((function(e){return an.xor(e,an.keys(w.dateRowMap))})));H(tn((function(e){return an.xor(e,an.keys(w.valueRowMap))})));D.current=an.xor(D.current,w.visibleRows)}),[w.dateRowMap,w.valueRowMap,w.visibleRows]);var de=$t((function(e,t,n){G(tn((function(l){var o=an.find(an.get(l,e),(function(e){return e.color===t}));o.checked=n})))}),[]);var ve=Gt((function(){return an.debounce((function(){le.current||ee(false)}),200)}),[]);var me=$t((function(e){p!=null&&l((function(t){var n=Tt(t,v,m,f,h,p,e);n!=null&&ne(n)}))}),[p,l,v,m,f,h,ne]);var fe=$t((function(e,t,n,l){return n.length>1?Zt.createElement("div",{key:e},Zt.createElement("div",{className:"title"},t),Zt.createElement("div",{className:"color-list"},n.map((function(t){return Zt.createElement("div",{key:t.color,className:"item",onClick:function onClick(){return l(e,t.color,!t.checked)}},Zt.createElement("div",{className:"color-label",style:{backgroundColor:t.color}}),Zt.createElement("input",{className:"luckysheet-mousedown-cancel",type:"checkbox",checked:t.checked,onChange:function onChange(){}}))})))):null}),[]);Qt((function(){var e;if(r.current&&s){var t=window.innerHeight;var n=window.innerWidth;var o=r.current.getBoundingClientRect();var i=(e=a.workbookContainer.current)===null||e===void 0?void 0:e.getBoundingClientRect();if(i){var c=o.width;var u=350;var d=s.y;var v=s.x;var m=false;if(i.left+v+c>n){v-=c;m=true}if(i.top+d+u>t){d-=u;m=true}if(d<0){d=0;m=true}var f=t-o.top-350;f<0&&(f=100);s.x===v&&s.y===d&&s.listBoxMaxHeight===f||l((function(e){if(m){an.set(e,"filterContextMenu.x",v);an.set(e,"filterContextMenu.y",d)}an.set(e,"filterContextMenu.listBoxMaxHeight",f)}))}}}),[s,l]);Qt((function(){var e,t;if(K){var n=(e=c.current)===null||e===void 0?void 0:e.getBoundingClientRect();var l=(t=u.current)===null||t===void 0?void 0:t.getBoundingClientRect();if(n!=null&&l!=null){var o=window.innerWidth;var a=an.cloneDeep(K);if(l.left+l.width>o){a.left-=l.width;Z(a)}}}}),[K]);Jt((function(){if(p!=null){O("");ee(false);T.current={};D.current=(s===null||s===void 0?void 0:s.hiddenRows)||[];var e=Dt(i.current,p,v,f,m);x(an.omit(e,["datesUncheck","valuesUncheck"]));R(e.datesUncheck);H(e.valuesUncheck);B(e.flattenValues)}}),[p,f,v,m,D,s===null||s===void 0?void 0:s.hiddenRows]);Jt((function(){p!=null&&G(It(i.current,p,v,f))}),[p,f,v]);return s==null?null:Zt.createElement(Zt.Fragment,null,Zt.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu fortune-filter-menu",id:"luckysheet-\\${menuid}-menu",ref:r,style:{left:s.x,top:s.y}},(e=o.filterContextMenu)===null||e===void 0?void 0:e.map((function(e,t){return e==="|"?Zt.createElement(ll,{key:"divider-".concat(t)}):e==="sort-by-asc"?Zt.createElement(ol,{key:e,onClick:function onClick(){return me(true)}},k.sortByAsc):e==="sort-by-desc"?Zt.createElement(ol,{key:e,onClick:function onClick(){return me(false)}},k.sortByDesc):e==="filter-by-color"?Zt.createElement("div",{key:e,ref:c,onMouseEnter:function onMouseEnter(){var e;if(r.current&&s){ee(true);var t=(e=c.current)===null||e===void 0?void 0:e.getBoundingClientRect();t!=null&&Z({top:t.top-5,left:t.right})}},onMouseLeave:ve},Zt.createElement(ol,{onClick:function onClick(){}},Zt.createElement("div",{className:"filter-bycolor-container"},k.filterByColor,Zt.createElement("div",{className:"filter-caret right"})))):e==="filter-by-condition"?Zt.createElement("div",{key:"name"},Zt.createElement(ol,{onClick:function onClick(){}},Zt.createElement("div",{className:"filter-caret right"}),k.filterByCondition),Zt.createElement("div",{className:"luckysheet-\\${menuid}-bycondition",style:{display:"none"}},Zt.createElement("div",{className:"luckysheet-flat-menu-button luckysheet-mousedown-cancel",id:"luckysheet-\\${menuid}-selected"},Zt.createElement("span",{className:"luckysheet-mousedown-cancel","data-value":"null","data-type":"0"},k.filiterInputNone),Zt.createElement("div",{className:"luckysheet-mousedown-cancel"},Zt.createElement("i",{className:"fa fa-sort","aria-hidden":"true"}))))):e==="filter-by-value"?Zt.createElement("div",{key:e},Zt.createElement(ol,{onClick:function onClick(){}},Zt.createElement("div",{className:"filter-caret right"}),k.filterByValues),Zt.createElement("div",{className:"luckysheet-filter-byvalue"},Zt.createElement("div",{className:"fortune-menuitem-row byvalue-btn-row"},Zt.createElement("div",null,Zt.createElement("span",{className:"fortune-byvalue-btn",onClick:ce},k.filterValueByAllBtn)," - ",Zt.createElement("span",{className:"fortune-byvalue-btn",onClick:ue},k.filterValueByClearBtn)," - ",Zt.createElement("span",{className:"fortune-byvalue-btn",onClick:se},k.filterValueByInverseBtn)),Zt.createElement("div",{className:"byvalue-filter-icon"},Zt.createElement(un,{name:"filter-fill",style:{width:20,height:20}}))),Zt.createElement("div",{className:"filtermenu-input-container"},Zt.createElement("input",{type:"text",onKeyDown:function onKeyDown(e){return e.stopPropagation()},placeholder:k.filterValueByTip,className:"luckysheet-mousedown-cancel",id:"luckysheet-\\${menuid}-byvalue-input",value:P,onChange:function onChange(e){O(e.target.value);ie(e.target.value)}})),Zt.createElement("div",{id:"luckysheet-filter-byvalue-select",style:{maxHeight:y}},Zt.createElement(ml,{dates:w.dates,onExpand:re,initialExpand:ae,isChecked:function isChecked(e){return an.find(M,(function(t){return t.match(e)!=null}))==null},onChange:function onChange(e,t){var n=D.current;D.current=t?an.without.apply(an,[n].concat(_toConsumableArray(e.rows))):an.union(n,e.rows);R(tn((function(n){return t?an.without.apply(an,[n].concat(_toConsumableArray(e.dateValues))):an.union(n,e.dateValues)})))},isItemVisible:function isItemVisible(e){return A.length===w.flattenValues.length||an.findIndex(A,(function(t){return t.match(e.key)!=null}))>-1}}),w.values.map((function(e){return Zt.createElement(dl,{key:e.key,item:e,isChecked:function isChecked(e){return!an.includes(V,e)},onChange:function onChange(e,t){var n=D.current;D.current=t?an.without.apply(an,[n].concat(_toConsumableArray(e.rows))):an.concat(n,e.rows);H(tn((function(n){t?an.pull(n,e.key):n.push(e.key)})))},isItemVisible:function isItemVisible(e){return A.length===w.flattenValues.length||an.includes(A,e.text)}})}))))):null})),Zt.createElement(ll,null),Zt.createElement("div",{className:"fortune-menuitem-row"},Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){p!=null&&l((function(e){var t=an.reduce(D.current,(function(e,t){e[t]=0;return e}),{});zt(e,D.current.length>0,t,{},v,f,p,m,h);D.current=[];e.filterContextMenu=void 0}))}},k.filterConform),Zt.createElement("div",{className:"button-basic button-default",onClick:function onClick(){l((function(e){e.filterContextMenu=void 0}))}},k.filterCancel),Zt.createElement("div",{className:"button-basic button-danger",onClick:function onClick(){l((function(e){ut(e)}))}},k.clearFilter))),Q&&Zt.createElement("div",{ref:u,className:"luckysheet-filter-bycolor-submenu",style:K,onMouseEnter:function onMouseEnter(){le.current=true},onMouseLeave:function onMouseLeave(){le.current=false;ee(false)}},Y.bgColors.length<2&&Y.fcColors.length<2?Zt.createElement("div",{className:"one-color-tip"},k.filterContainerOneColorTip):Zt.createElement(Zt.Fragment,null,[{key:"bgColors",title:k.filiterByColorTip,colors:Y.bgColors},{key:"fcColors",title:k.filiterByTextColorTip,colors:Y.fcColors}].map((function(e){return fe(e.key,e.title,e.colors,de)})),Zt.createElement("div",{className:"button-basic button-primary",onClick:function onClick(){p!=null&&l((function(e){var t=an.reduce(an(Y).values().flatten().map((function(e){return e.checked?[]:e.rows})).flatten().valueOf(),(function(e,t){e[t]=0;return e}),{});zt(e,!an.isEmpty(t),t,{},v,f,p,m,h);D.current=[];e.filterContextMenu=void 0}))}},k.filterConform))))};var hl=function SheetHiddenButton(e){var t=e.style,n=e.sheet;var l=qt(cn),o=l.context,a=l.setContext;var r=$t((function(){o.allowEdit!==false&&n&&a((function(e){Nt.showSheet(e,n.id)}))}),[o.allowEdit,a,n]);return Zt.createElement("div",{style:t,onClick:function onClick(e){e.stopPropagation();r()},className:"fortune-sheet-hidden-button"},(n===null||n===void 0?void 0:n.hide)===1?Zt.createElement(un,{name:"hidden",width:16,height:16,style:{marginTop:"7px"}}):"")};var pl=function SheetListItem(e){var t=e.sheet,n=e.isDropPlaceholder;var l=qt(cn),o=l.context,a=l.setContext,r=l.refs;var i=Xt(null);Jt((function(){a((function(e){var t=o.sheetScrollRecord[e===null||e===void 0?void 0:e.currentSheetId];if(t){var n,l,a,r;e.scrollLeft=(n=t.scrollLeft)!==null&&n!==void 0?n:0;e.scrollTop=(l=t.scrollTop)!==null&&l!==void 0?l:0;e.luckysheet_select_status=(a=t.luckysheet_select_status)!==null&&a!==void 0&&a;e.luckysheet_select_save=(r=t.luckysheet_select_save)!==null&&r!==void 0?r:void 0}else{e.scrollLeft=0;e.scrollTop=0;e.luckysheet_select_status=false;e.luckysheet_select_save=void 0}e.luckysheet_selection_range=[]}))}),[o.currentSheetId,o.sheetScrollRecord,a]);return Zt.createElement("div",{className:"fortune-sheet-list-item",key:t.id,ref:i,onClick:function onClick(){n||a((function(e){e.sheetScrollRecord[e.currentSheetId]={scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,luckysheet_select_status:e.luckysheet_select_status,luckysheet_select_save:e.luckysheet_select_save,luckysheet_selection_range:e.luckysheet_selection_range};e.currentSheetId=t.id;e.zoomRatio=t.zoomRatio||1;ht(e,r.globalCache);H(e)}))}},Zt.createElement("span",{className:"fortune-sheet-selected-check-sapce"},t.id===o.currentSheetId&&Zt.createElement(un,{name:"check",width:16,height:16,style:{lineHeight:30,verticalAlign:"middle"}})),Zt.createElement("span",{className:"luckysheet-sheets-item-name fortune-sheet-list-item-name",spellCheck:"false"},!!t.color&&Zt.createElement("div",{className:"luckysheet-sheets-list-item-color",style:{background:t.color}}),t.name),t.hide&&Zt.createElement(hl,{sheet:t}))};var yl=function SheetList(){var e=qt(cn),t=e.context,n=e.setContext;var l=Xt(null);var o=$t((function(){n((function(e){e.showSheetList=false}))}),[n]);useOutsideClick(l,o,[o]);return Zt.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu fortune-sheet-list",ref:l},an.sortBy(t.luckysheetfile,(function(e){return Number(e.order)})).map((function(e){return Zt.createElement(pl,{sheet:e,key:e.id})})))};var gl=["onChange","onOp","data"];ln();var kl=function triggerGroupValuesRefresh(e){e.groupValuesRefreshData.length>0&&At(e)};var El=function concatProducer(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){t(e)}))}};var Cl=Zt.forwardRef((function(l,o){var a;var r=l.onChange,i=l.onOp,c=l.data,u=_objectWithoutProperties(l,gl);var s=Xt({undoList:[],redoList:[]});var d=Xt(null);var v=Xt(null);var m=Xt(null);var f=Xt(null);var h=Xt(null);var p=Xt(null);var y=Xt(null);var g=Gt((function(){return{globalCache:s.current,cellInput:d,fxInput:v,canvas:m,scrollbarX:f,scrollbarY:h,cellArea:p,workbookContainer:y}}),[]);var k=Yt(e(g)),E=_slicedToArray(k,2),b=E[0],w=E[1];var x=C(b),_=x.formula;var N=Yt(null),M=_slicedToArray(N,2),R=M[0],L=M[1];var S=Yt({numberC:0,count:0,sum:0,max:0,min:0,average:""}),V=_slicedToArray(S,2),H=V[0],T=V[1];var D=Gt((function(){return an.assign(an.cloneDeep(t),u)}),_toConsumableArray(an.values(u)));Jt((function(){var e=b.luckysheet_select_save;var t=u.lang;if(e){var n=Bt(b,t);T(n)}}),[b.luckysheet_select_save]);var I=$t((function(e,t,n){var l,o;var a=t.celldata,r=t.row,i=t.column;var c=an.maxBy(a,"r");var u=an.maxBy(a,"c");var s=((l=c===null||c===void 0?void 0:c.r)!==null&&l!==void 0?l:0)+1;var d=((o=u===null||u===void 0?void 0:u.c)!==null&&o!==void 0?o:0)+1;if(r!=null&&i!=null&&r>0&&i>0){s=Math.max(s,r);d=Math.max(d,i)}else{s=Math.max(s,e.defaultrowNum);d=Math.max(d,e.defaultcolumnNum)}if(s&&d){var v=an.times(s,(function(){return an.times(d,(function(){return null}))}));a===null||a===void 0?void 0:a.forEach((function(e){v[e.r][e.c]=e.v}));e.luckysheetfile=tn(e.luckysheetfile,(function(e){e[n].data=v;delete e[n].celldata;return e}));return v}return null}),[]);var z=$t((function(e,t,n){var l=arguments.length>3&&arguments[3]!==void 0&&arguments[3];i&&i(Ft(e,t,n,l))}),[i]);function reduceUndoList(e,t){var l=e.luckysheetfile.map((function(e){return e.id}));var o=s.current.undoList.filter((function(e){var t;return(t=e.options)===null||t===void 0?void 0:t.deleteSheetOp})).map((function(e){var t,n;return(t=e.options)===null||t===void 0||(n=t.deleteSheetOp)===null||n===void 0?void 0:n.id}));s.current.undoList=s.current.undoList.filter((function(e){var t,n,a,r;return((t=e.options)===null||t===void 0?void 0:t.deleteSheetOp)||((n=e.options)===null||n===void 0?void 0:n.id)===void 0||an.indexOf(l,(a=e.options)===null||a===void 0?void 0:a.id)!==-1||an.indexOf(o,(r=e.options)===null||r===void 0?void 0:r.id)!==-1}));if(t.luckysheetfile.length>e.luckysheetfile.length){var a=t.luckysheetfile.filter((function(t){return an.indexOf(e.luckysheetfile.map((function(e){return e.id})),t.id)===-1})).map((function(e){return n(t,e.id)}));var r=a[0];s.current.undoList=s.current.undoList.map((function(e){e.patches=e.patches.map((function(e){typeof e.path[1]==="number"&&e.path[1]>r&&(e.path[1]-=1);return e}));e.inversePatches=e.inversePatches.map((function(e){typeof e.path[1]==="number"&&e.path[1]>r&&(e.path[1]-=1);return e}));return e}))}}function dataToCelldata(e){var t=[];for(var n=0;n<(e===null||e===void 0?void 0:e.length);n+=1)for(var l=0;l<((o=e[n])===null||o===void 0?void 0:o.length);l+=1){var o;e[n][l]!==null&&t.push({r:n,c:l,v:e[n][l]})}return t}var A=$t((function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};w((function(l){var o=on(l,El(e,kl)),a=_slicedToArray(o,3),r=a[0],i=a[1],c=a[2];if(i.length>0&&!t.noHistory){t.logPatch&&console.info("patch",i);var u=Wt(i);var d=Wt(c);if(d.length>0){t.id=l.currentSheetId;if(t.deleteSheetOp){var v=l.luckysheetfile.filter((function(e){var n;return e.id===((n=t.deleteSheetOp)===null||n===void 0?void 0:n.id)}));if(v){var m=n(l,t.deleteSheetOp.id);t.deletedSheet={id:t.deleteSheetOp.id,index:m,value:an.cloneDeep(l.luckysheetfile[m])};t.deletedSheet.value.celldata=dataToCelldata(t.deletedSheet.value.data);delete t.deletedSheet.value.data;t.deletedSheet.value.status=0;d=[{op:"add",path:["luckysheetfile",0],value:t.deletedSheet.value}]}}else if(t.addSheetOp){t.addSheet={};t.addSheet.id=r.luckysheetfile[r.luckysheetfile.length-1].id}s.current.undoList.push({patches:u,inversePatches:d,options:t});s.current.redoList=[];z(r,u,t)}}else{var f,h,p;(i===null||i===void 0||(f=i[0])===null||f===void 0||(h=f.value)===null||h===void 0?void 0:h.length)<(l===null||l===void 0||(p=l.luckysheetfile)===null||p===void 0?void 0:p.length)&&reduceUndoList(r,l)}return r}))}),[z]);var B=$t((function(){var e=s.current.undoList.pop();e&&w((function(t){var l,o;if((l=e.options)===null||l===void 0?void 0:l.deleteSheetOp){var a,r;e.inversePatches[0].path[1]=t.luckysheetfile.length;var i=(a=e.options.deletedSheet)===null||a===void 0||(r=a.value)===null||r===void 0?void 0:r.order;var c=t.luckysheetfile.filter((function(t){var n,l;return(t===null||t===void 0?void 0:t.order)>=i&&t.id!==(e===null||e===void 0||(n=e.options)===null||n===void 0||(l=n.deleteSheetOp)===null||l===void 0?void 0:l.id)}));an.forEach(c,(function(l){e.inversePatches.push({op:"replace",path:["luckysheetfile",n(t,l.id),"order"],value:(l===null||l===void 0?void 0:l.order)+1})}))}var u=nn(t,e.inversePatches);s.current.redoList.push(e);var d=Pt(e.options);(d===null||d===void 0?void 0:d.insertRowColOp)&&(d.restoreDeletedCells=true);if((o=e.options)===null||o===void 0?void 0:o.addSheetOp){var v;var m=n(t,e.options.addSheet.id);d.addSheet={id:e.options.addSheet.id,index:m,value:an.cloneDeep(t.luckysheetfile[m])};d.addSheet.value.celldata=dataToCelldata((v=d.addSheet.value)===null||v===void 0?void 0:v.data);delete d.addSheet.value.data}z(u,e.inversePatches,d,true);return u}))}),[z]);var F=$t((function(){var e=s.current.redoList.pop();e&&w((function(t){var n=nn(t,e.patches);s.current.undoList.push(e);z(n,e.patches,e.options);return n}))}),[z]);Jt((function(){if(b.luckysheet_select_save!=null){var e,t;(e=D.hooks)===null||e===void 0||(t=e.afterSelectionChange)===null||t===void 0?void 0:t.call(e,b.currentSheetId,b.luckysheet_select_save[0])}}),[b.currentSheetId,b.luckysheet_select_save,D.hooks]);var W=Gt((function(){return{context:b,setContext:A,settings:D,handleUndo:B,handleRedo:F,refs:g}}),[b,F,B,D,g,A]);Jt((function(){an.isEmpty(b.luckysheetfile)||(r===null||r===void 0?void 0:r(b.luckysheetfile))}),[b.luckysheetfile,r]);Jt((function(){A((function(e){var t,l;e.defaultcolumnNum=D.column;e.defaultrowNum=D.row;e.defaultFontSize=D.defaultFontSize;if(an.isEmpty(e.luckysheetfile)){var o=tn(c,(function(e){Ot(e,D.generateSheetId)}));e.luckysheetfile=o;o.forEach((function(t){var l;var o=n(e,t.id);var a=(l=e.luckysheetfile)===null||l===void 0?void 0:l[o];I(e,a,o)}))}D.devicePixelRatio>0&&(e.devicePixelRatio=D.devicePixelRatio);e.lang=D.lang;e.allowEdit=D.allowEdit;e.hooks=D.hooks;an.isEmpty(e.currentSheetId)&&Ut(e);var a=n(e,e.currentSheetId);if(a==null){var r,i;if(((r=(i=e.luckysheetfile)===null||i===void 0?void 0:i.length)!==null&&r!==void 0?r:0)>0){a=0;e.currentSheetId=e.luckysheetfile[0].id}}if(a!=null){var u=(t=e.luckysheetfile)===null||t===void 0?void 0:t[a];if(u){var s=u.data;if(an.isEmpty(s)){var d=I(e,u,a);an.isNull(d)||(s=d)}an.isEmpty(e.luckysheet_select_save)&&!an.isEmpty(u.luckysheet_select_save)&&(e.luckysheet_select_save=u.luckysheet_select_save);if(((l=e.luckysheet_select_save)===null||l===void 0?void 0:l.length)===0){var v,m,f,h,p,y,g,k,E,C,b;!((v=s)===null||v===void 0||(m=v[0])===null||m===void 0||(f=m[0])===null||f===void 0?void 0:f.mc)||an.isNil((h=s)===null||h===void 0||(p=h[0])===null||p===void 0||(y=p[0])===null||y===void 0||(g=y.mc)===null||g===void 0?void 0:g.rs)||an.isNil((k=s)===null||k===void 0||(E=k[0])===null||E===void 0||(C=E[0])===null||C===void 0||(b=C.mc)===null||b===void 0?void 0:b.cs)?e.luckysheet_select_save=[{row:[0,0],column:[0,0]}]:e.luckysheet_select_save=[{row:[0,s[0][0].mc.rs-1],column:[0,s[0][0].mc.cs-1]}]}e.config=an.isNil(u.config)?{}:u.config;e.insertedImgs=u.images;e.zoomRatio=an.isNil(u.zoomRatio)?1:u.zoomRatio;e.rowHeaderWidth=D.rowHeaderWidth*e.zoomRatio;e.columnHeaderHeight=D.columnHeaderHeight*e.zoomRatio;an.isNil(u.defaultRowHeight)?e.defaultrowlen=D.defaultRowHeight:e.defaultrowlen=Number(u.defaultRowHeight);an.isNil(u.addRows)?e.addDefaultRows=D.addRows:e.addDefaultRows=Number(u.addRows);an.isNil(u.defaultColWidth)?e.defaultcollen=D.defaultColWidth:e.defaultcollen=Number(u.defaultColWidth);if(an.isNil(u.showGridLines))e.showGridLines=true;else{var w=u.showGridLines;e.showGridLines=w!==0&&w!==false}if(an.isNil(D.lang)){var x=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage;e.lang=x}}}}),{noHistory:true})}),[b.currentSheetId,b.luckysheetfile.length,c,D.defaultRowHeight,D.defaultColWidth,D.column,D.row,D.defaultFontSize,D.devicePixelRatio,D.lang,D.allowEdit,D.hooks,D.generateSheetId,A,I,D.rowHeaderWidth,D.columnHeaderHeight,D.addRows]);var P=$t((function(e){var t=e.nativeEvent;if(!e.ctrlKey&&!e.metaKey||e.code!=="KeyZ")if(!e.ctrlKey&&!e.metaKey||e.code!=="KeyY")A((function(e){jt(e,d.current,v.current,t,s.current,B,F,m.current.getContext("2d"))}));else{F();e.stopPropagation();e.preventDefault()}else{e.shiftKey?F():B();e.stopPropagation()}}),[F,B,A]);var O=$t((function(e){var t;if(d.current===document.activeElement||((t=document.activeElement)===null||t===void 0?void 0:t.className)==="fortune-sheet-overlay"){var l=e.clipboardData;l||(l=window.clipboardData);var o=l.getData("text/html")||l.getData("text/plain");var a=document.createElement("div");a.innerHTML=o;var r=a.querySelectorAll("table tr");var i=r.length+b.luckysheet_select_save[0].row[0];var c=i-b.luckysheetfile[n(b,b.currentSheetId)].data.length;var u=b.luckysheet_select_save;if(c>0){var s={type:"row",index:b.luckysheetfile[n(b,b.currentSheetId)].data.length-1,count:c,direction:"rightbottom",id:b.currentSheetId};A((function(e){we(e,s);e.luckysheet_select_save=u}),{insertRowColOp:s})}A((function(t){try{Kt(t,e)}catch(e){console.error(e)}}))}}),[b,A]);var U=$t((function(){L(null)}),[]);Jt((function(){document.addEventListener("paste",O);return function(){document.removeEventListener("paste",O)}}),[O]);en(o,(function(){return generateAPIs(b,A,B,F,D,d.current,f.current,h.current)}),[b,A,B,F,D]);var j=n(b,b.currentSheetId);if(j==null)return null;var K=(a=b.luckysheetfile)===null||a===void 0?void 0:a[j];return K?Zt.createElement(cn.Provider,{value:W},Zt.createElement(En,null,Zt.createElement("div",{className:"fortune-container",ref:y,onKeyDown:P},Zt.createElement(il,null),Zt.createElement("div",{className:"fortune-workarea"},D.showToolbar&&Zt.createElement(Gn,{moreItemsOpen:R!==null,setMoreItems:L}),D.showFormulaBar&&Zt.createElement(Jn,null)),Zt.createElement(Vn,{sheet:K}),D.showSheetTabs&&Zt.createElement(nl,null),Zt.createElement(rl,null),Zt.createElement(fl,null),Zt.createElement(ul,null),b.showSheetList&&Zt.createElement(yl,null),R&&Zt.createElement(sl,{onClose:U},R),!an.isEmpty(b.contextMenu)&&Zt.createElement("div",{onMouseDown:function onMouseDown(){A((function(e){e.contextMenu={};e.filterContextMenu=void 0;e.showSheetList=void 0}))},onMouseMove:function onMouseMove(e){return e.stopPropagation()},onMouseUp:function onMouseUp(e){return e.stopPropagation()},onContextMenu:function onContextMenu(e){e.preventDefault();e.stopPropagation()},className:"fortune-popover-backdrop"}),Zt.createElement("div",{className:"fortune-stat-area"},Zt.createElement("div",{className:"luckysheet-sheet-selection-calInfo"},!!H.count&&Zt.createElement("div",{style:{width:"60px"}},_.count,": ",H.count),!!H.numberC&&!!H.sum&&Zt.createElement("div",null,_.sum,": ",H.sum),!!H.numberC&&!!H.average&&Zt.createElement("div",null,_.average,": ",H.average),!!H.numberC&&!!H.max&&Zt.createElement("div",null,_.max,": ",H.max),!!H.numberC&&!!H.min&&Zt.createElement("div",null,_.min,": ",H.min)))))):null}));export{Cl as Workbook};

