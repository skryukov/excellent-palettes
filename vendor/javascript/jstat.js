var r="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var n={};(function(r,t){n=t()})(0,(function(){var n=function(n,t){var e=Array.prototype.concat;var a=Array.prototype.slice;var o=Object.prototype.toString;function calcRdx(r,t){var e=r>t?r:t;return n.pow(10,17-~~(n.log(e>0?e:-e)*n.LOG10E))}var i=Array.isArray||function isArray(r){return"[object Array]"===o.call(r)};function isFunction(r){return"[object Function]"===o.call(r)}function isNumber(r){return"number"===typeof r&&r-r===0}function toVector(r){return e.apply([],r)}function jStat(){return new jStat._init(arguments)}jStat.fn=jStat.prototype;jStat._init=function _init(n){if(i(n[0]))if(i(n[0][0])){isFunction(n[1])&&(n[0]=jStat.map(n[0],n[1]));for(var t=0;t<n[0].length;t++)(this||r)[t]=n[0][t];(this||r).length=n[0].length}else{(this||r)[0]=isFunction(n[1])?jStat.map(n[0],n[1]):n[0];(this||r).length=1}else if(isNumber(n[0])){(this||r)[0]=jStat.seq.apply(null,n);(this||r).length=1}else{if(n[0]instanceof jStat)return jStat(n[0].toArray());(this||r)[0]=[];(this||r).length=1}return this||r};jStat._init.prototype=jStat.prototype;jStat._init.constructor=jStat;jStat.utils={calcRdx:calcRdx,isArray:i,isFunction:isFunction,isNumber:isNumber,toVector:toVector};jStat._random_fn=n.random;jStat.setRandom=function setRandom(r){if("function"!==typeof r)throw new TypeError("fn is not a function");jStat._random_fn=r};jStat.extend=function extend(n){var t,e;if(1===arguments.length){for(e in n)jStat[e]=n[e];return this||r}for(t=1;t<arguments.length;t++)for(e in arguments[t])n[e]=arguments[t][e];return n};jStat.rows=function rows(r){return r.length||1};jStat.cols=function cols(r){return r[0].length||1};jStat.dimensions=function dimensions(r){return{rows:jStat.rows(r),cols:jStat.cols(r)}};jStat.row=function row(r,n){return i(n)?n.map((function(n){return jStat.row(r,n)})):r[n]};jStat.rowa=function rowa(r,n){return jStat.row(r,n)};jStat.col=function col(r,n){if(i(n)){var t=jStat.arange(r.length).map((function(){return new Array(n.length)}));n.forEach((function(n,e){jStat.arange(r.length).forEach((function(a){t[a][e]=r[a][n]}))}));return t}var e=new Array(r.length);for(var a=0;a<r.length;a++)e[a]=[r[a][n]];return e};jStat.cola=function cola(r,n){return jStat.col(r,n).map((function(r){return r[0]}))};jStat.diag=function diag(r){var n=jStat.rows(r);var t=new Array(n);for(var e=0;e<n;e++)t[e]=[r[e][e]];return t};jStat.antidiag=function antidiag(r){var n=jStat.rows(r)-1;var t=new Array(n);for(var e=0;n>=0;n--,e++)t[e]=[r[e][n]];return t};jStat.transpose=function transpose(r){var n=[];var t,e,a,o,u;i(r[0])||(r=[r]);e=r.length;a=r[0].length;for(u=0;u<a;u++){t=new Array(e);for(o=0;o<e;o++)t[o]=r[o][u];n.push(t)}return 1===n.length?n[0]:n};jStat.map=function map(r,n,t){var e,a,o,u,c;i(r[0])||(r=[r]);a=r.length;o=r[0].length;u=t?r:new Array(a);for(e=0;e<a;e++){u[e]||(u[e]=new Array(o));for(c=0;c<o;c++)u[e][c]=n(r[e][c],e,c)}return 1===u.length?u[0]:u};jStat.cumreduce=function cumreduce(r,n,t){var e,a,o,u,c;i(r[0])||(r=[r]);a=r.length;o=r[0].length;u=t?r:new Array(a);for(e=0;e<a;e++){u[e]||(u[e]=new Array(o));o>0&&(u[e][0]=r[e][0]);for(c=1;c<o;c++)u[e][c]=n(u[e][c-1],r[e][c])}return 1===u.length?u[0]:u};jStat.alter=function alter(r,n){return jStat.map(r,n,true)};jStat.create=function create(r,n,t){var e=new Array(r);var a,o;if(isFunction(n)){t=n;n=r}for(a=0;a<r;a++){e[a]=new Array(n);for(o=0;o<n;o++)e[a][o]=t(a,o)}return e};function retZero(){return 0}jStat.zeros=function zeros(r,n){isNumber(n)||(n=r);return jStat.create(r,n,retZero)};function retOne(){return 1}jStat.ones=function ones(r,n){isNumber(n)||(n=r);return jStat.create(r,n,retOne)};jStat.rand=function rand(r,n){isNumber(n)||(n=r);return jStat.create(r,n,jStat._random_fn)};function retIdent(r,n){return r===n?1:0}jStat.identity=function identity(r,n){isNumber(n)||(n=r);return jStat.create(r,n,retIdent)};jStat.symmetric=function symmetric(r){var n=r.length;var t,e;if(r.length!==r[0].length)return false;for(t=0;t<n;t++)for(e=0;e<n;e++)if(r[e][t]!==r[t][e])return false;return true};jStat.clear=function clear(r){return jStat.alter(r,retZero)};jStat.seq=function seq(r,n,t,e){isFunction(e)||(e=false);var a=[];var o=calcRdx(r,n);var i=(n*o-r*o)/((t-1)*o);var u=r;var c;for(c=0;u<=n&&c<t;c++,u=(r*o+i*o*c)/o)a.push(e?e(u,c):u);return a};jStat.arange=function arange(r,n,e){var a=[];var o;e=e||1;if(n===t){n=r;r=0}if(r===n||0===e)return[];if(r<n&&e<0)return[];if(r>n&&e>0)return[];if(e>0)for(o=r;o<n;o+=e)a.push(o);else for(o=r;o>n;o+=e)a.push(o);return a};jStat.slice=function(){function _slice(r,n,e,a){var o;var i=[];var u=r.length;if(n===t&&e===t&&a===t)return jStat.copy(r);n=n||0;e=e||r.length;n=n>=0?n:u+n;e=e>=0?e:u+e;a=a||1;if(n===e||0===a)return[];if(n<e&&a<0)return[];if(n>e&&a>0)return[];if(a>0)for(o=n;o<e;o+=a)i.push(r[o]);else for(o=n;o>e;o+=a)i.push(r[o]);return i}function slice(r,n){var t,e;n=n||{};if(isNumber(n.row)){if(isNumber(n.col))return r[n.row][n.col];var a=jStat.rowa(r,n.row);t=n.col||{};return _slice(a,t.start,t.end,t.step)}if(isNumber(n.col)){var o=jStat.cola(r,n.col);e=n.row||{};return _slice(o,e.start,e.end,e.step)}e=n.row||{};t=n.col||{};var i=_slice(r,e.start,e.end,e.step);return i.map((function(r){return _slice(r,t.start,t.end,t.step)}))}return slice}();jStat.sliceAssign=function sliceAssign(r,e,a){var o,i;if(isNumber(e.row)){if(isNumber(e.col))return r[e.row][e.col]=a;e.col=e.col||{};e.col.start=e.col.start||0;e.col.end=e.col.end||r[0].length;e.col.step=e.col.step||1;o=jStat.arange(e.col.start,n.min(r.length,e.col.end),e.col.step);var u=e.row;o.forEach((function(n,t){r[u][n]=a[t]}));return r}if(isNumber(e.col)){e.row=e.row||{};e.row.start=e.row.start||0;e.row.end=e.row.end||r.length;e.row.step=e.row.step||1;i=jStat.arange(e.row.start,n.min(r[0].length,e.row.end),e.row.step);var c=e.col;i.forEach((function(n,t){r[n][c]=a[t]}));return r}a[0].length===t&&(a=[a]);e.row.start=e.row.start||0;e.row.end=e.row.end||r.length;e.row.step=e.row.step||1;e.col.start=e.col.start||0;e.col.end=e.col.end||r[0].length;e.col.step=e.col.step||1;i=jStat.arange(e.row.start,n.min(r.length,e.row.end),e.row.step);o=jStat.arange(e.col.start,n.min(r[0].length,e.col.end),e.col.step);i.forEach((function(n,t){o.forEach((function(e,o){r[n][e]=a[t][o]}))}));return r};jStat.diagonal=function diagonal(r){var n=jStat.zeros(r.length,r.length);r.forEach((function(r,t){n[t][t]=r}));return n};jStat.copy=function copy(r){return r.map((function(r){return isNumber(r)?r:r.map((function(r){return r}))}))};var u=jStat.prototype;u.length=0;u.push=Array.prototype.push;u.sort=Array.prototype.sort;u.splice=Array.prototype.splice;u.slice=Array.prototype.slice;u.toArray=function toArray(){return(this||r).length>1?a.call(this||r):a.call(this||r)[0]};u.map=function map(n,t){return jStat(jStat.map(this||r,n,t))};u.cumreduce=function cumreduce(n,t){return jStat(jStat.cumreduce(this||r,n,t))};u.alter=function alter(n){jStat.alter(this||r,n);return this||r};(function(n){for(var t=0;t<n.length;t++)(function(n){u[n]=function(t){var e,a=this||r;if(t){setTimeout((function(){t.call(a,u[n].call(a))}));return this||r}e=jStat[n](this||r);return i(e)?jStat(e):e}})(n[t])})("transpose clear symmetric rows cols dimensions diag antidiag".split(" "));(function(n){for(var t=0;t<n.length;t++)(function(n){u[n]=function(t,e){var a=this||r;if(e){setTimeout((function(){e.call(a,u[n].call(a,t))}));return this||r}return jStat(jStat[n](this||r,t))}})(n[t])})("row col".split(" "));(function(r){for(var n=0;n<r.length;n++)(function(r){u[r]=function(){return jStat(jStat[r].apply(null,arguments))}})(r[n])})("create zeros ones rand identity".split(" "));return jStat}(Math);(function(n,t){var e=n.utils.isFunction;function ascNum(r,n){return r-n}function clip(r,n,e){return t.max(n,t.min(r,e))}n.sum=function sum(r){var sum=0;var n=r.length;while(--n>=0)sum+=r[n];return sum};n.sumsqrd=function sumsqrd(r){var n=0;var t=r.length;while(--t>=0)n+=r[t]*r[t];return n};n.sumsqerr=function sumsqerr(r){var t=n.mean(r);var e=0;var a=r.length;var o;while(--a>=0){o=r[a]-t;e+=o*o}return e};n.sumrow=function sumrow(r){var n=0;var t=r.length;while(--t>=0)n+=r[t];return n};n.product=function product(r){var n=1;var t=r.length;while(--t>=0)n*=r[t];return n};n.min=function min(r){var n=r[0];var t=0;while(++t<r.length)r[t]<n&&(n=r[t]);return n};n.max=function max(r){var n=r[0];var t=0;while(++t<r.length)r[t]>n&&(n=r[t]);return n};n.unique=function unique(r){var n={},t=[];for(var e=0;e<r.length;e++)if(!n[r[e]]){n[r[e]]=true;t.push(r[e])}return t};n.mean=function mean(r){return n.sum(r)/r.length};n.meansqerr=function meansqerr(r){return n.sumsqerr(r)/r.length};n.geomean=function geomean(r){var e=r.map(t.log);var a=n.mean(e);return t.exp(a)};n.median=function median(r){var n=r.length;var t=r.slice().sort(ascNum);return 1&n?t[n/2|0]:(t[n/2-1]+t[n/2])/2};n.cumsum=function cumsum(r){return n.cumreduce(r,(function(r,n){return r+n}))};n.cumprod=function cumprod(r){return n.cumreduce(r,(function(r,n){return r*n}))};n.diff=function diff(r){var n=[];var t=r.length;var e;for(e=1;e<t;e++)n.push(r[e]-r[e-1]);return n};n.rank=function(r){var n;var t=[];var e={};for(n=0;n<r.length;n++){var a=r[n];if(e[a])e[a]++;else{e[a]=1;t.push(a)}}var o=t.sort(ascNum);var i={};var u=1;for(n=0;n<o.length;n++){a=o[n];var c=e[a];var s=u;var l=u+c-1;var v=(s+l)/2;i[a]=v;u+=c}return r.map((function(r){return i[r]}))};n.mode=function mode(r){var n=r.length;var t=r.slice().sort(ascNum);var e=1;var a=0;var o=0;var i=[];var u;for(u=0;u<n;u++)if(t[u]===t[u+1])e++;else{if(e>a){i=[t[u]];a=e;o=0}else if(e===a){i.push(t[u]);o++}e=1}return 0===o?i[0]:i};n.range=function range(r){return n.max(r)-n.min(r)};n.variance=function variance(r,t){return n.sumsqerr(r)/(r.length-(t?1:0))};n.pooledvariance=function pooledvariance(r){var t=r.reduce((function(r,t){return r+n.sumsqerr(t)}),0);var e=r.reduce((function(r,n){return r+n.length}),0);return t/(e-r.length)};n.deviation=function(r){var t=n.mean(r);var e=r.length;var a=new Array(e);for(var o=0;o<e;o++)a[o]=r[o]-t;return a};n.stdev=function stdev(r,e){return t.sqrt(n.variance(r,e))};n.pooledstdev=function pooledstdev(r){return t.sqrt(n.pooledvariance(r))};n.meandev=function meandev(r){var e=n.mean(r);var a=[];for(var o=r.length-1;o>=0;o--)a.push(t.abs(r[o]-e));return n.mean(a)};n.meddev=function meddev(r){var e=n.median(r);var a=[];for(var o=r.length-1;o>=0;o--)a.push(t.abs(r[o]-e));return n.median(a)};n.coeffvar=function coeffvar(r){return n.stdev(r)/n.mean(r)};n.quartiles=function quartiles(r){var n=r.length;var e=r.slice().sort(ascNum);return[e[t.round(n/4)-1],e[t.round(n/2)-1],e[t.round(3*n/4)-1]]};n.quantiles=function quantiles(r,n,e,a){var o=r.slice().sort(ascNum);var i=[n.length];var u=r.length;var c,s,l,v,m,d;"undefined"===typeof e&&(e=3/8);"undefined"===typeof a&&(a=3/8);for(c=0;c<n.length;c++){s=n[c];l=e+s*(1-e-a);v=u*s+l;m=t.floor(clip(v,1,u-1));d=clip(v-m,0,1);i[c]=(1-d)*o[m-1]+d*o[m]}return i};n.percentile=function percentile(r,n,t){var e=r.slice().sort(ascNum);var a=n*(e.length+(t?1:-1))+(t?0:1);var o=parseInt(a);var i=a-o;return o+1<e.length?e[o-1]+i*(e[o]-e[o-1]):e[o-1]};n.percentileOfScore=function percentileOfScore(r,n,t){var e=0;var a=r.length;var o=false;var i,u;"strict"===t&&(o=true);for(u=0;u<a;u++){i=r[u];(o&&i<n||!o&&i<=n)&&e++}return e/a};n.histogram=function histogram(r,e){e=e||4;var a=n.min(r);var o=(n.max(r)-a)/e;var i=r.length;var u=[];var c;for(c=0;c<e;c++)u[c]=0;for(c=0;c<i;c++)u[t.min(t.floor((r[c]-a)/o),e-1)]+=1;return u};n.covariance=function covariance(r,t){var e=n.mean(r);var a=n.mean(t);var o=r.length;var i=new Array(o);var u;for(u=0;u<o;u++)i[u]=(r[u]-e)*(t[u]-a);return n.sum(i)/(o-1)};n.corrcoeff=function corrcoeff(r,t){return n.covariance(r,t)/n.stdev(r,1)/n.stdev(t,1)};n.spearmancoeff=function(r,t){r=n.rank(r);t=n.rank(t);return n.corrcoeff(r,t)};n.stanMoment=function stanMoment(r,e){var a=n.mean(r);var o=n.stdev(r);var i=r.length;var u=0;for(var c=0;c<i;c++)u+=t.pow((r[c]-a)/o,e);return u/r.length};n.skewness=function skewness(r){return n.stanMoment(r,3)};n.kurtosis=function kurtosis(r){return n.stanMoment(r,4)-3};var a=n.prototype;(function(t){for(var o=0;o<t.length;o++)(function(t){a[t]=function(o,i){var u=[];var c=0;var s=this||r;if(e(o)){i=o;o=false}if(i){setTimeout((function(){i.call(s,a[t].call(s,o))}));return this||r}if((this||r).length>1){s=true===o?this||r:this.transpose();for(;c<s.length;c++)u[c]=n[t](s[c]);return u}return n[t]((this||r)[0],o)}})(t[o])})("cumsum cumprod".split(" "));(function(t){for(var o=0;o<t.length;o++)(function(t){a[t]=function(o,i){var u=[];var c=0;var s=this||r;if(e(o)){i=o;o=false}if(i){setTimeout((function(){i.call(s,a[t].call(s,o))}));return this||r}if((this||r).length>1){"sumrow"!==t&&(s=true===o?this||r:this.transpose());for(;c<s.length;c++)u[c]=n[t](s[c]);return true===o?n[t](n.utils.toVector(u)):u}return n[t]((this||r)[0],o)}})(t[o])})("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "));(function(t){for(var o=0;o<t.length;o++)(function(t){a[t]=function(){var o=[];var i=0;var u=this||r;var c=Array.prototype.slice.call(arguments);var s;if(e(c[c.length-1])){s=c[c.length-1];var l=c.slice(0,c.length-1);setTimeout((function(){s.call(u,a[t].apply(u,l))}));return this||r}s=void 0;var v=function curriedFunction(r){return n[t].apply(u,[r].concat(c))};if((this||r).length>1){u=u.transpose();for(;i<u.length;i++)o[i]=v(u[i]);return o}return v((this||r)[0])}})(t[o])})("quantiles percentileOfScore".split(" "))})(n,Math);(function(n,t){n.gammaln=function gammaln(r){var n=0;var e=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];var a=1.000000000190015;var o,i,u;u=(i=o=r)+5.5;u-=(o+.5)*t.log(u);for(;n<6;n++)a+=e[n]/++i;return t.log(2.5066282746310007*a/o)-u};n.loggam=function loggam(r){var n,e,a,o,i;var u,c;var s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];n=r;c=0;if(1==r||2==r)return 0;if(r<=7){c=t.floor(7-r);n=r+c}e=1/(n*n);a=2*t.PI;i=s[9];for(u=8;u>=0;u--){i*=e;i+=s[u]}o=i/n+.5*t.log(a)+(n-.5)*t.log(n)-n;if(r<=7)for(u=1;u<=c;u++){o-=t.log(n-1);n-=1}return o};n.gammafn=function gammafn(r){var n=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054];var e=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];var a=false;var o=0;var i=0;var u=0;var c=r;var s,l,v,m;if(r>171.6243769536076)return Infinity;if(c<=0){m=c%1+36e-17;if(!m)return Infinity;a=(1&c?-1:1)*t.PI/t.sin(t.PI*m);c=1-c}v=c;l=c<1?c++:(c-=o=(0|c)-1)-1;for(s=0;s<8;++s){u=(u+n[s])*l;i=i*l+e[s]}m=u/i+1;if(v<c)m/=v;else if(v>c)for(s=0;s<o;++s){m*=c;c++}a&&(m=a/m);return m};n.gammap=function gammap(r,t){return n.lowRegGamma(r,t)*n.gammafn(r)};n.lowRegGamma=function lowRegGamma(r,e){var a=n.gammaln(r);var o=r;var i=1/r;var u=i;var c=e+1-r;var s=1/1e-30;var l=1/c;var v=l;var m=1;var d=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);var p;if(e<0||r<=0)return NaN;if(e<r+1){for(;m<=d;m++)i+=u*=e/++o;return i*t.exp(-e+r*t.log(e)-a)}for(;m<=d;m++){p=-m*(m-r);c+=2;l=p*l+c;s=c+p/s;l=1/l;v*=l*s}return 1-v*t.exp(-e+r*t.log(e)-a)};n.factorialln=function factorialln(r){return r<0?NaN:n.gammaln(r+1)};n.factorial=function factorial(r){return r<0?NaN:n.gammafn(r+1)};n.combination=function combination(r,e){return r>170||e>170?t.exp(n.combinationln(r,e)):n.factorial(r)/n.factorial(e)/n.factorial(r-e)};n.combinationln=function combinationln(r,t){return n.factorialln(r)-n.factorialln(t)-n.factorialln(r-t)};n.permutation=function permutation(r,t){return n.factorial(r)/n.factorial(r-t)};n.betafn=function betafn(r,e){if(!(r<=0||e<=0))return r+e>170?t.exp(n.betaln(r,e)):n.gammafn(r)*n.gammafn(e)/n.gammafn(r+e)};n.betaln=function betaln(r,t){return n.gammaln(r)+n.gammaln(t)-n.gammaln(r+t)};n.betacf=function betacf(r,n,e){var a=1e-30;var o=1;var i=n+e;var u=n+1;var c=n-1;var s=1;var l=1-i*r/u;var v,m,d,p;t.abs(l)<a&&(l=a);l=1/l;p=l;for(;o<=100;o++){v=2*o;m=o*(e-o)*r/((c+v)*(n+v));l=1+m*l;t.abs(l)<a&&(l=a);s=1+m/s;t.abs(s)<a&&(s=a);l=1/l;p*=l*s;m=-(n+o)*(i+o)*r/((n+v)*(u+v));l=1+m*l;t.abs(l)<a&&(l=a);s=1+m/s;t.abs(s)<a&&(s=a);l=1/l;d=l*s;p*=d;if(t.abs(d-1)<3e-7)break}return p};n.gammapinv=function gammapinv(r,e){var a=0;var o=e-1;var i=1e-8;var u=n.gammaln(e);var c,s,l,v,m,d,p;if(r>=1)return t.max(100,e+100*t.sqrt(e));if(r<=0)return 0;if(e>1){d=t.log(o);p=t.exp(o*(d-1)-u);m=r<.5?r:1-r;l=t.sqrt(-2*t.log(m));c=(2.30753+.27061*l)/(1+l*(.99229+.04481*l))-l;r<.5&&(c=-c);c=t.max(.001,e*t.pow(1-1/(9*e)-c/(3*t.sqrt(e)),3))}else{l=1-e*(.253+.12*e);c=r<l?t.pow(r/l,1/e):1-t.log(1-(r-l)/(1-l))}for(;a<12;a++){if(c<=0)return 0;s=n.lowRegGamma(e,c)-r;l=e>1?p*t.exp(-(c-o)+o*(t.log(c)-d)):t.exp(-c+o*t.log(c)-u);v=s/l;c-=l=v/(1-.5*t.min(1,v*((e-1)/c-1)));c<=0&&(c=.5*(c+l));if(t.abs(l)<i*c)break}return c};n.erf=function erf(r){var n=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];var e=n.length-1;var a=false;var o=0;var i=0;var u,c,s,l;if(r<0){r=-r;a=true}u=2/(2+r);c=4*u-2;for(;e>0;e--){s=o;o=c*o-i+n[e];i=s}l=u*t.exp(-r*r+.5*(n[0]+c*o)-i);return a?l-1:1-l};n.erfc=function erfc(r){return 1-n.erf(r)};n.erfcinv=function erfcinv(r){var e=0;var a,o,i,u;if(r>=2)return-100;if(r<=0)return 100;u=r<1?r:2-r;i=t.sqrt(-2*t.log(u/2));a=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);for(;e<2;e++){o=n.erfc(a)-u;a+=o/(1.1283791670955126*t.exp(-a*a)-a*o)}return r<1?a:-a};n.ibetainv=function ibetainv(r,e,a){var o=1e-8;var i=e-1;var u=a-1;var c=0;var s,l,v,m,d,p,g,h,w,b,y;if(r<=0)return 0;if(r>=1)return 1;if(e>=1&&a>=1){v=r<.5?r:1-r;m=t.sqrt(-2*t.log(v));g=(2.30753+.27061*m)/(1+m*(.99229+.04481*m))-m;r<.5&&(g=-g);h=(g*g-3)/6;w=2/(1/(2*e-1)+1/(2*a-1));b=g*t.sqrt(h+w)/w-(1/(2*a-1)-1/(2*e-1))*(h+5/6-2/(3*w));g=e/(e+a*t.exp(2*b))}else{s=t.log(e/(e+a));l=t.log(a/(e+a));m=t.exp(e*s)/e;d=t.exp(a*l)/a;b=m+d;g=r<m/b?t.pow(e*b*r,1/e):1-t.pow(a*b*(1-r),1/a)}y=-n.gammaln(e)-n.gammaln(a)+n.gammaln(e+a);for(;c<10;c++){if(0===g||1===g)return g;p=n.ibeta(g,e,a)-r;m=t.exp(i*t.log(g)+u*t.log(1-g)+y);d=p/m;g-=m=d/(1-.5*t.min(1,d*(i/g-u/(1-g))));g<=0&&(g=.5*(g+m));g>=1&&(g=.5*(g+m+1));if(t.abs(m)<o*g&&c>0)break}return g};n.ibeta=function ibeta(r,e,a){var o=0===r||1===r?0:t.exp(n.gammaln(e+a)-n.gammaln(e)-n.gammaln(a)+e*t.log(r)+a*t.log(1-r));return!(r<0||r>1)&&(r<(e+1)/(e+a+2)?o*n.betacf(r,e,a)/e:1-o*n.betacf(1-r,a,e)/a)};n.randn=function randn(r,e){var a,o,i,u,c;e||(e=r);if(r)return n.create(r,e,(function(){return n.randn()}));do{a=n._random_fn();o=1.7156*(n._random_fn()-.5);i=a-.449871;u=t.abs(o)+.386595;c=i*i+u*(.196*u-.25472*i)}while(c>.27597&&(c>.27846||o*o>-4*t.log(a)*a*a));return o/a};n.randg=function randg(r,e,a){var o=r;var i,u,c,s,l,v;a||(a=e);r||(r=1);if(e){v=n.zeros(e,a);v.alter((function(){return n.randg(r)}));return v}r<1&&(r+=1);i=r-1/3;u=1/t.sqrt(9*i);do{do{l=n.randn();s=1+u*l}while(s<=0);s*=s*s;c=n._random_fn()}while(c>1-.331*t.pow(l,4)&&t.log(c)>.5*l*l+i*(1-s+t.log(s)));if(r==o)return i*s;do{c=n._random_fn()}while(0===c);return t.pow(c,1/o)*i*s};(function(t){for(var e=0;e<t.length;e++)(function(t){n.fn[t]=function(){return n(n.map(this||r,(function(r){return n[t](r)})))}})(t[e])})("gammaln gammafn factorial factorialln".split(" "));(function(r){for(var t=0;t<r.length;t++)(function(r){n.fn[r]=function(){return n(n[r].apply(null,arguments))}})(r[t])})("randn".split(" "))})(n,Math);(function(n,t){(function(t){for(var e=0;e<t.length;e++)(function(t){n[t]=function f(n,t,e){if(!((this||r)instanceof f))return new f(n,t,e);(this||r)._a=n;(this||r)._b=t;(this||r)._c=e;return this||r};n.fn[t]=function(e,a,o){var i=n[t](e,a,o);i.data=this||r;return i};n[t].prototype.sample=function(e){var a=(this||r)._a;var o=(this||r)._b;var i=(this||r)._c;return e?n.alter(e,(function(){return n[t].sample(a,o,i)})):n[t].sample(a,o,i)};(function(e){for(var a=0;a<e.length;a++)(function(e){n[t].prototype[e]=function(a){var o=(this||r)._a;var i=(this||r)._b;var u=(this||r)._c;a||0===a||(a=(this||r).data);return"number"!==typeof a?n.fn.map.call(a,(function(r){return n[t][e](r,o,i,u)})):n[t][e](a,o,i,u)}})(e[a])})("pdf cdf inv".split(" "));(function(e){for(var a=0;a<e.length;a++)(function(e){n[t].prototype[e]=function(){return n[t][e]((this||r)._a,(this||r)._b,(this||r)._c)}})(e[a])})("mean median mode variance".split(" "))})(t[e])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" "));n.extend(n.beta,{pdf:function pdf(r,e,a){return r>1||r<0?0:1==e&&1==a?1:e<512&&a<512?t.pow(r,e-1)*t.pow(1-r,a-1)/n.betafn(e,a):t.exp((e-1)*t.log(r)+(a-1)*t.log(1-r)-n.betaln(e,a))},cdf:function cdf(r,t,e){return r>1||r<0?1*(r>1):n.ibeta(r,t,e)},inv:function inv(r,t,e){return n.ibetainv(r,t,e)},mean:function mean(r,n){return r/(r+n)},median:function median(r,t){return n.ibetainv(.5,r,t)},mode:function mode(r,n){return(r-1)/(r+n-2)},sample:function sample(r,t){var e=n.randg(r);return e/(e+n.randg(t))},variance:function variance(r,n){return r*n/(t.pow(r+n,2)*(r+n+1))}});n.extend(n.centralF,{pdf:function pdf(r,e,a){var o,i,u;if(r<0)return 0;if(e<=2)return 0===r&&e<2?Infinity:0===r&&2===e?1:1/n.betafn(e/2,a/2)*t.pow(e/a,e/2)*t.pow(r,e/2-1)*t.pow(1+e/a*r,-(e+a)/2);o=e*r/(a+r*e);i=a/(a+r*e);u=e*i/2;return u*n.binomial.pdf((e-2)/2,(e+a-2)/2,o)},cdf:function cdf(r,t,e){return r<0?0:n.ibeta(t*r/(t*r+e),t/2,e/2)},inv:function inv(r,t,e){return e/(t*(1/n.ibetainv(r,t/2,e/2)-1))},mean:function mean(r,n){return n>2?n/(n-2):void 0},mode:function mode(r,n){return r>2?n*(r-2)/(r*(n+2)):void 0},sample:function sample(r,t){var e=2*n.randg(r/2);var a=2*n.randg(t/2);return e/r/(a/t)},variance:function variance(r,n){if(!(n<=4))return 2*n*n*(r+n-2)/(r*(n-2)*(n-2)*(n-4))}});n.extend(n.cauchy,{pdf:function pdf(r,n,e){return e<0?0:e/(t.pow(r-n,2)+t.pow(e,2))/t.PI},cdf:function cdf(r,n,e){return t.atan((r-n)/e)/t.PI+.5},inv:function(r,n,e){return n+e*t.tan(t.PI*(r-.5))},median:function median(r){return r},mode:function mode(r){return r},sample:function sample(r,e){return n.randn()*t.sqrt(1/(2*n.randg(.5)))*e+r}});n.extend(n.chisquare,{pdf:function pdf(r,e){return r<0?0:0===r&&2===e?.5:t.exp((e/2-1)*t.log(r)-r/2-e/2*t.log(2)-n.gammaln(e/2))},cdf:function cdf(r,t){return r<0?0:n.lowRegGamma(t/2,r/2)},inv:function(r,t){return 2*n.gammapinv(r,.5*t)},mean:function(r){return r},median:function median(r){return r*t.pow(1-2/(9*r),3)},mode:function mode(r){return r-2>0?r-2:0},sample:function sample(r){return 2*n.randg(r/2)},variance:function variance(r){return 2*r}});n.extend(n.exponential,{pdf:function pdf(r,n){return r<0?0:n*t.exp(-n*r)},cdf:function cdf(r,n){return r<0?0:1-t.exp(-n*r)},inv:function(r,n){return-t.log(1-r)/n},mean:function(r){return 1/r},median:function(r){return 1/r*t.log(2)},mode:function mode(){return 0},sample:function sample(r){return-1/r*t.log(n._random_fn())},variance:function(r){return t.pow(r,-2)}});n.extend(n.gamma,{pdf:function pdf(r,e,a){return r<0?0:0===r&&1===e?1/a:t.exp((e-1)*t.log(r)-r/a-n.gammaln(e)-e*t.log(a))},cdf:function cdf(r,t,e){return r<0?0:n.lowRegGamma(t,r/e)},inv:function(r,t,e){return n.gammapinv(r,t)*e},mean:function(r,n){return r*n},mode:function mode(r,n){if(r>1)return(r-1)*n},sample:function sample(r,t){return n.randg(r)*t},variance:function variance(r,n){return r*n*n}});n.extend(n.invgamma,{pdf:function pdf(r,e,a){return r<=0?0:t.exp(-(e+1)*t.log(r)-a/r-n.gammaln(e)+e*t.log(a))},cdf:function cdf(r,t,e){return r<=0?0:1-n.lowRegGamma(t,e/r)},inv:function(r,t,e){return e/n.gammapinv(1-r,t)},mean:function(r,n){return r>1?n/(r-1):void 0},mode:function mode(r,n){return n/(r+1)},sample:function sample(r,t){return t/n.randg(r)},variance:function variance(r,n){if(!(r<=2))return n*n/((r-1)*(r-1)*(r-2))}});n.extend(n.kumaraswamy,{pdf:function pdf(r,n,e){return 0===r&&1===n?e:1===r&&1===e?n:t.exp(t.log(n)+t.log(e)+(n-1)*t.log(r)+(e-1)*t.log(1-t.pow(r,n)))},cdf:function cdf(r,n,e){return r<0?0:r>1?1:1-t.pow(1-t.pow(r,n),e)},inv:function inv(r,n,e){return t.pow(1-t.pow(1-r,1/e),1/n)},mean:function(r,t){return t*n.gammafn(1+1/r)*n.gammafn(t)/n.gammafn(1+1/r+t)},median:function median(r,n){return t.pow(1-t.pow(2,-1/n),1/r)},mode:function mode(r,n){if(r>=1&&n>=1&&1!==r&&1!==n)return t.pow((r-1)/(r*n-1),1/r)},variance:function variance(){throw new Error("variance not yet implemented")}});n.extend(n.lognormal,{pdf:function pdf(r,n,e){return r<=0?0:t.exp(-t.log(r)-.5*t.log(2*t.PI)-t.log(e)-t.pow(t.log(r)-n,2)/(2*e*e))},cdf:function cdf(r,e,a){return r<0?0:.5+.5*n.erf((t.log(r)-e)/t.sqrt(2*a*a))},inv:function(r,e,a){return t.exp(-1.4142135623730951*a*n.erfcinv(2*r)+e)},mean:function mean(r,n){return t.exp(r+n*n/2)},median:function median(r){return t.exp(r)},mode:function mode(r,n){return t.exp(r-n*n)},sample:function sample(r,e){return t.exp(n.randn()*e+r)},variance:function variance(r,n){return(t.exp(n*n)-1)*t.exp(2*r+n*n)}});n.extend(n.noncentralt,{pdf:function pdf(r,e,a){var o=1e-14;return t.abs(a)<o?n.studentt.pdf(r,e):t.abs(r)<o?t.exp(n.gammaln((e+1)/2)-a*a/2-.5*t.log(t.PI*e)-n.gammaln(e/2)):e/r*(n.noncentralt.cdf(r*t.sqrt(1+2/e),e+2,a)-n.noncentralt.cdf(r,e,a))},cdf:function cdf(r,e,a){var o=1e-14;var i=200;if(t.abs(a)<o)return n.studentt.cdf(r,e);var u=false;if(r<0){u=true;a=-a}var c=n.normal.cdf(-a,0,1);var s=o+1;var l=s;var v=r*r/(r*r+e);var m=0;var d=t.exp(-a*a/2);var p=t.exp(-a*a/2-.5*t.log(2)-n.gammaln(1.5))*a;while(m<i||l>o||s>o){l=s;if(m>0){d*=a*a/(2*m);p*=a*a/(2*(m+.5))}s=d*n.beta.cdf(v,m+.5,e/2)+p*n.beta.cdf(v,m+1,e/2);c+=.5*s;m++}return u?1-c:c}});n.extend(n.normal,{pdf:function pdf(r,n,e){return t.exp(-.5*t.log(2*t.PI)-t.log(e)-t.pow(r-n,2)/(2*e*e))},cdf:function cdf(r,e,a){return.5*(1+n.erf((r-e)/t.sqrt(2*a*a)))},inv:function(r,t,e){return-1.4142135623730951*e*n.erfcinv(2*r)+t},mean:function(r){return r},median:function median(r){return r},mode:function(r){return r},sample:function sample(r,t){return n.randn()*t+r},variance:function(r,n){return n*n}});n.extend(n.pareto,{pdf:function pdf(r,n,e){return r<n?0:e*t.pow(n,e)/t.pow(r,e+1)},cdf:function cdf(r,n,e){return r<n?0:1-t.pow(n/r,e)},inv:function inv(r,n,e){return n/t.pow(1-r,1/e)},mean:function mean(r,n){if(!(n<=1))return n*t.pow(r,n)/(n-1)},median:function median(r,n){return r*(n*t.SQRT2)},mode:function mode(r){return r},variance:function(r,n){if(!(n<=2))return r*r*n/(t.pow(n-1,2)*(n-2))}});n.extend(n.studentt,{pdf:function pdf(r,e){e=e>1e100?1e100:e;return 1/(t.sqrt(e)*n.betafn(.5,e/2))*t.pow(1+r*r/e,-(e+1)/2)},cdf:function cdf(r,e){var a=e/2;return n.ibeta((r+t.sqrt(r*r+e))/(2*t.sqrt(r*r+e)),a,a)},inv:function(r,e){var a=n.ibetainv(2*t.min(r,1-r),.5*e,.5);a=t.sqrt(e*(1-a)/a);return r>.5?a:-a},mean:function mean(r){return r>1?0:void 0},median:function median(){return 0},mode:function mode(){return 0},sample:function sample(r){return n.randn()*t.sqrt(r/(2*n.randg(r/2)))},variance:function variance(r){return r>2?r/(r-2):r>1?Infinity:void 0}});n.extend(n.weibull,{pdf:function pdf(r,n,e){return r<0||n<0||e<0?0:e/n*t.pow(r/n,e-1)*t.exp(-t.pow(r/n,e))},cdf:function cdf(r,n,e){return r<0?0:1-t.exp(-t.pow(r/n,e))},inv:function(r,n,e){return n*t.pow(-t.log(1-r),1/e)},mean:function(r,t){return r*n.gammafn(1+1/t)},median:function median(r,n){return r*t.pow(t.log(2),1/n)},mode:function mode(r,n){return n<=1?0:r*t.pow((n-1)/n,1/n)},sample:function sample(r,e){return r*t.pow(-t.log(n._random_fn()),1/e)},variance:function variance(r,e){return r*r*n.gammafn(1+2/e)-t.pow(n.weibull.mean(r,e),2)}});n.extend(n.uniform,{pdf:function pdf(r,n,t){return r<n||r>t?0:1/(t-n)},cdf:function cdf(r,n,t){return r<n?0:r<t?(r-n)/(t-n):1},inv:function(r,n,t){return n+r*(t-n)},mean:function mean(r,n){return.5*(r+n)},median:function median(r,t){return n.mean(r,t)},mode:function mode(){throw new Error("mode is not yet implemented")},sample:function sample(r,t){return r/2+t/2+(t/2-r/2)*(2*n._random_fn()-1)},variance:function variance(r,n){return t.pow(n-r,2)/12}});function betinc(r,n,e,a){var o=0;var i=1;var u=1;var c=1;var s=0;var l=0;var v;while(t.abs((u-l)/u)>a){l=u;v=-(n+s)*(n+e+s)*r/(n+2*s)/(n+2*s+1);o=u+v*o;i=c+v*i;s+=1;v=s*(e-s)*r/(n+2*s-1)/(n+2*s);u=o+v*u;c=i+v*c;o/=c;i/=c;u/=c;c=1}return u/n}n.extend(n.binomial,{pdf:function pdf(r,e,a){return 0===a||1===a?e*a===r?1:0:n.combination(e,r)*t.pow(a,r)*t.pow(1-a,e-r)},cdf:function cdf(r,e,a){var o;var i=1e-10;if(r<0)return 0;if(r>=e)return 1;if(a<0||a>1||e<=0)return NaN;r=t.floor(r);var u=a;var c=r+1;var s=e-r;var l=c+s;var v=t.exp(n.gammaln(l)-n.gammaln(s)-n.gammaln(c)+c*t.log(u)+s*t.log(1-u));o=u<(c+1)/(l+2)?v*betinc(u,c,s,i):1-v*betinc(1-u,s,c,i);return t.round(1/i*(1-o))/(1/i)}});n.extend(n.negbin,{pdf:function pdf(r,e,a){return r===r>>>0&&(r<0?0:n.combination(r+e-1,e-1)*t.pow(1-a,r)*t.pow(a,e))},cdf:function cdf(r,t,e){var a=0,o=0;if(r<0)return 0;for(;o<=r;o++)a+=n.negbin.pdf(o,t,e);return a}});n.extend(n.hypgeom,{pdf:function pdf(r,e,a,o){if(r!==r|0)return false;if(r<0||r<a-(e-o))return 0;if(r>o||r>a)return 0;if(2*a>e)return 2*o>e?n.hypgeom.pdf(e-a-o+r,e,e-a,e-o):n.hypgeom.pdf(o-r,e,e-a,o);if(2*o>e)return n.hypgeom.pdf(a-r,e,a,e-o);if(a<o)return n.hypgeom.pdf(r,e,o,a);var i=1;var u=0;for(var c=0;c<r;c++){while(i>1&&u<o){i*=1-a/(e-u);u++}i*=(o-c)*(a-c)/((c+1)*(e-a-o+c+1))}for(;u<o;u++)i*=1-a/(e-u);return t.min(1,t.max(0,i))},cdf:function cdf(r,e,a,o){if(r<0||r<a-(e-o))return 0;if(r>=o||r>=a)return 1;if(2*a>e)return 2*o>e?n.hypgeom.cdf(e-a-o+r,e,e-a,e-o):1-n.hypgeom.cdf(o-r-1,e,e-a,o);if(2*o>e)return 1-n.hypgeom.cdf(a-r-1,e,a,e-o);if(a<o)return n.hypgeom.cdf(r,e,o,a);var i=1;var u=1;var c=0;for(var s=0;s<r;s++){while(i>1&&c<o){var l=1-a/(e-c);u*=l;i*=l;c++}u*=(o-s)*(a-s)/((s+1)*(e-a-o+s+1));i+=u}for(;c<o;c++)i*=1-a/(e-c);return t.min(1,t.max(0,i))}});n.extend(n.poisson,{pdf:function pdf(r,e){return e<0||r%1!==0||r<0?0:t.pow(e,r)*t.exp(-e)/n.factorial(r)},cdf:function cdf(r,t){var e=[],a=0;if(r<0)return 0;for(;a<=r;a++)e.push(n.poisson.pdf(a,t));return n.sum(e)},mean:function(r){return r},variance:function(r){return r},sampleSmall:function sampleSmall(r){var e=1,a=0,o=t.exp(-r);do{a++;e*=n._random_fn()}while(e>o);return a-1},sampleLarge:function sampleLarge(r){var e=r;var a;var o,i,u,c,s,l,v,m,d;u=t.sqrt(e);c=t.log(e);l=.931+2.53*u;s=.02483*l-.059;v=1.1239+1.1328/(l-3.4);m=.9277-3.6224/(l-2);while(1){o=t.random()-.5;i=t.random();d=.5-t.abs(o);a=t.floor((2*s/d+l)*o+e+.43);if(d>=.07&&i<=m)return a;if(!(a<0||d<.013&&i>d)&&t.log(i)+t.log(v)-t.log(s/(d*d)+l)<=a*c-e-n.loggam(a+1))return a}},sample:function sample(r){return r<10?this.sampleSmall(r):this.sampleLarge(r)}});n.extend(n.triangular,{pdf:function pdf(r,n,t,e){return t<=n||e<n||e>t?NaN:r<n||r>t?0:r<e?2*(r-n)/((t-n)*(e-n)):r===e?2/(t-n):2*(t-r)/((t-n)*(t-e))},cdf:function cdf(r,n,e,a){return e<=n||a<n||a>e?NaN:r<=n?0:r>=e?1:r<=a?t.pow(r-n,2)/((e-n)*(a-n)):1-t.pow(e-r,2)/((e-n)*(e-a))},inv:function inv(r,n,e,a){return e<=n||a<n||a>e?NaN:r<=(a-n)/(e-n)?n+(e-n)*t.sqrt(r*((a-n)/(e-n))):n+(e-n)*(1-t.sqrt((1-r)*(1-(a-n)/(e-n))))},mean:function mean(r,n,t){return(r+n+t)/3},median:function median(r,n,e){return e<=(r+n)/2?n-t.sqrt((n-r)*(n-e))/t.sqrt(2):e>(r+n)/2?r+t.sqrt((n-r)*(e-r))/t.sqrt(2):void 0},mode:function mode(r,n,t){return t},sample:function sample(r,e,a){var o=n._random_fn();return o<(a-r)/(e-r)?r+t.sqrt(o*(e-r)*(a-r)):e-t.sqrt((1-o)*(e-r)*(e-a))},variance:function variance(r,n,t){return(r*r+n*n+t*t-r*n-r*t-n*t)/18}});n.extend(n.arcsine,{pdf:function pdf(r,n,e){return e<=n?NaN:r<=n||r>=e?0:2/t.PI*t.pow(t.pow(e-n,2)-t.pow(2*r-n-e,2),-.5)},cdf:function cdf(r,n,e){return r<n?0:r<e?2/t.PI*t.asin(t.sqrt((r-n)/(e-n))):1},inv:function(r,n,e){return n+(.5-.5*t.cos(t.PI*r))*(e-n)},mean:function mean(r,n){return n<=r?NaN:(r+n)/2},median:function median(r,n){return n<=r?NaN:(r+n)/2},mode:function mode(){throw new Error("mode is not yet implemented")},sample:function sample(r,e){return(r+e)/2+(e-r)/2*t.sin(2*t.PI*n.uniform.sample(0,1))},variance:function variance(r,n){return n<=r?NaN:t.pow(n-r,2)/8}});function laplaceSign(r){return r/t.abs(r)}n.extend(n.laplace,{pdf:function pdf(r,n,e){return e<=0?0:t.exp(-t.abs(r-n)/e)/(2*e)},cdf:function cdf(r,n,e){return e<=0?0:r<n?.5*t.exp((r-n)/e):1-.5*t.exp(-(r-n)/e)},mean:function(r){return r},median:function(r){return r},mode:function(r){return r},variance:function(r,n){return 2*n*n},sample:function sample(r,e){var a=n._random_fn()-.5;return r-e*laplaceSign(a)*t.log(1-2*t.abs(a))}});function tukeyWprob(r,e,a){var o=12;var i=6;var u=-30;var c=-50;var s=60;var l=8;var v=3;var m=2;var d=3;var p=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689];var g=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277];var h=.5*r;if(h>=l)return 1;var w=2*n.normal.cdf(h,0,1,1,0)-1;w=w>=t.exp(c/a)?t.pow(w,a):0;var b;b=r>v?m:d;var y=h;var x=(l-h)/b;var S=y+x;var j=0;var q=a-1;for(var _=1;_<=b;_++){var A=0;var N=.5*(S+y);var k=.5*(S-y);for(var R=1;R<=o;R++){var E,I;if(i<R){E=o-R+1;I=p[E-1]}else{E=R;I=-p[E-1]}var P=k*I;var z=N+P;var M=z*z;if(M>s)break;var F=2*n.normal.cdf(z,0,1,1,0);var O=2*n.normal.cdf(z,r,1,1,0);var U=.5*F-.5*O;if(U>=t.exp(u/q)){U=g[E-1]*t.exp(-.5*M)*t.pow(U,q);A+=U}}A*=2*k*a/t.sqrt(2*t.PI);j+=A;y=S;S+=x}w+=j;if(w<=t.exp(u/e))return 0;w=t.pow(w,e);return w>=1?1:w}function tukeyQinv(r,n,e){var a=.322232421088;var o=.099348462606;var i=-1;var u=.588581570495;var c=-.342242088547;var s=.531103462366;var l=-.204231210125;var v=.10353775285;var m=-453642210148e-16;var d=.0038560700634;var p=.8832;var g=.2368;var h=1.214;var w=1.208;var b=1.4142;var y=120;var x=.5-.5*r;var S=t.sqrt(t.log(1/(x*x)));var j=S+((((S*m+l)*S+c)*S+i)*S+a)/((((S*d+v)*S+s)*S+u)*S+o);e<y&&(j+=(j*j*j+j)/e/4);var q=p-g*j;e<y&&(q+=-h/e+w*j/e);return j*(q*t.log(n-1)+b)}n.extend(n.tukey,{cdf:function cdf(r,e,a){var o=1;var i=e;var u=16;var c=8;var s=-30;var l=1e-14;var v=100;var m=800;var d=5e3;var p=25e3;var g=1;var h=.5;var w=.25;var b=.125;var y=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744];var x=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(a<2||o<1||i<2)return NaN;if(!Number.isFinite(r))return 1;if(a>p)return tukeyWprob(r,o,i);var S=.5*a;var j=S*t.log(a)-a*t.log(2)-n.gammaln(S);var q=S-1;var _=.25*a;var A;A=a<=v?g:a<=m?h:a<=d?w:b;j+=t.log(A);var N=0;for(var k=1;k<=50;k++){var R=0;var E=(2*k-1)*A;for(var I=1;I<=u;I++){var P,z;if(c<I){P=I-c-1;z=j+q*t.log(E+y[P]*A)-(y[P]*A+E)*_}else{P=I-1;z=j+q*t.log(E-y[P]*A)+(y[P]*A-E)*_}var M;if(z>=s){M=c<I?r*t.sqrt(.5*(y[P]*A+E)):r*t.sqrt(.5*(-y[P]*A+E));var F=tukeyWprob(M,o,i);var O=F*x[P]*t.exp(z);R+=O}}if(k*A>=1&&R<=l)break;N+=R}if(R>l)throw new Error("tukey.cdf failed to converge");N>1&&(N=1);return N},inv:function(r,e,a){var o=1;var i=e;var u=1e-4;var c=50;if(a<2||o<1||i<2)return NaN;if(r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return Infinity;var s=tukeyQinv(r,i,a);var l=n.tukey.cdf(s,e,a)-r;var v;v=l>0?t.max(0,s-1):s+1;var m=n.tukey.cdf(v,e,a)-r;var d;for(var p=1;p<c;p++){d=v-m*(v-s)/(m-l);l=m;s=v;if(d<0){d=0;m=-r}m=n.tukey.cdf(d,e,a)-r;v=d;var g=t.abs(v-s);if(g<u)return d}throw new Error("tukey.inv failed to converge")}})})(n,Math);(function(n,t){var e=Array.prototype.push;var a=n.utils.isArray;function isUsable(r){return a(r)||r instanceof n}n.extend({add:function add(r,t){if(isUsable(t)){isUsable(t[0])||(t=[t]);return n.map(r,(function(r,n,e){return r+t[n][e]}))}return n.map(r,(function(r){return r+t}))},subtract:function subtract(r,t){if(isUsable(t)){isUsable(t[0])||(t=[t]);return n.map(r,(function(r,n,e){return r-t[n][e]||0}))}return n.map(r,(function(r){return r-t}))},divide:function divide(r,t){if(isUsable(t)){isUsable(t[0])||(t=[t]);return n.multiply(r,n.inv(t))}return n.map(r,(function(r){return r/t}))},multiply:function multiply(r,t){var e,a,o,i,u,c,s,l;if(void 0===r.length&&void 0===t.length)return r*t;u=r.length,c=r[0].length,s=n.zeros(u,o=isUsable(t)?t[0].length:c),l=0;if(isUsable(t)){for(;l<o;l++)for(e=0;e<u;e++){i=0;for(a=0;a<c;a++)i+=r[e][a]*t[a][l];s[e][l]=i}return 1===u&&1===l?s[0][0]:s}return n.map(r,(function(r){return r*t}))},outer:function outer(r,t){return n.multiply(r.map((function(r){return[r]})),[t])},dot:function dot(r,t){isUsable(r[0])||(r=[r]);isUsable(t[0])||(t=[t]);var e,a,o=1===r[0].length&&1!==r.length?n.transpose(r):r,i=1===t[0].length&&1!==t.length?n.transpose(t):t,u=[],c=0,s=o.length,l=o[0].length;for(;c<s;c++){u[c]=[];e=0;for(a=0;a<l;a++)e+=o[c][a]*i[c][a];u[c]=e}return 1===u.length?u[0]:u},pow:function pow(r,e){return n.map(r,(function(r){return t.pow(r,e)}))},exp:function exp(r){return n.map(r,(function(r){return t.exp(r)}))},log:function exp(r){return n.map(r,(function(r){return t.log(r)}))},abs:function abs(r){return n.map(r,(function(r){return t.abs(r)}))},norm:function norm(r,n){var e=0,a=0;isNaN(n)&&(n=2);isUsable(r[0])&&(r=r[0]);for(;a<r.length;a++)e+=t.pow(t.abs(r[a]),n);return t.pow(e,1/n)},angle:function angle(r,e){return t.acos(n.dot(r,e)/(n.norm(r)*n.norm(e)))},aug:function aug(r,n){var t=[];var a;for(a=0;a<r.length;a++)t.push(r[a].slice());for(a=0;a<t.length;a++)e.apply(t[a],n[a]);return t},inv:function inv(r){var t=r.length;var e=r[0].length;var a=n.identity(t,e);var o=n.gauss_jordan(r,a);var i=[];var u=0;var c;for(;u<t;u++){i[u]=[];for(c=e;c<o[0].length;c++)i[u][c-e]=o[u][c]}return i},det:function det(r){if(2===r.length)return r[0][0]*r[1][1]-r[0][1]*r[1][0];var n=0;for(var t=0;t<r.length;t++){var e=[];for(var a=1;a<r.length;a++){e[a-1]=[];for(var o=0;o<r.length;o++)o<t?e[a-1][o]=r[a][o]:o>t&&(e[a-1][o-1]=r[a][o])}var i=t%2?-1:1;n+=det(e)*r[0][t]*i}return n},gauss_elimination:function gauss_elimination(r,e){var a,o,i,u,c=0,s=0,l=r.length,v=r[0].length,m=1,d=0,p=[];r=n.aug(r,e);a=r[0].length;for(c=0;c<l;c++){o=r[c][c];s=c;for(u=c+1;u<v;u++)if(o<t.abs(r[u][c])){o=r[u][c];s=u}if(s!=c)for(u=0;u<a;u++){i=r[c][u];r[c][u]=r[s][u];r[s][u]=i}for(s=c+1;s<l;s++){m=r[s][c]/r[c][c];for(u=c;u<a;u++)r[s][u]=r[s][u]-m*r[c][u]}}for(c=l-1;c>=0;c--){d=0;for(s=c+1;s<=l-1;s++)d+=p[s]*r[c][s];p[c]=(r[c][a-1]-d)/r[c][c]}return p},gauss_jordan:function gauss_jordan(r,e){var a=n.aug(r,e);var o=a.length;var i=a[0].length;var u=0;var c,s,l;for(s=0;s<o;s++){var v=s;for(l=s+1;l<o;l++)t.abs(a[l][s])>t.abs(a[v][s])&&(v=l);var m=a[s];a[s]=a[v];a[v]=m;for(l=s+1;l<o;l++){u=a[l][s]/a[s][s];for(c=s;c<i;c++)a[l][c]-=a[s][c]*u}}for(s=o-1;s>=0;s--){u=a[s][s];for(l=0;l<s;l++)for(c=i-1;c>s-1;c--)a[l][c]-=a[s][c]*a[l][s]/u;a[s][s]/=u;for(c=o;c<i;c++)a[s][c]/=u}return a},triaUpSolve:function triaUpSolve(r,t){var e=r[0].length;var a=n.zeros(1,e)[0];var o;var i=false;if(void 0!=t[0].length){t=t.map((function(r){return r[0]}));i=true}n.arange(e-1,-1,-1).forEach((function(i){o=n.arange(i+1,e).map((function(n){return a[n]*r[i][n]}));a[i]=(t[i]-n.sum(o))/r[i][i]}));return i?a.map((function(r){return[r]})):a},triaLowSolve:function triaLowSolve(r,t){var e=r[0].length;var a=n.zeros(1,e)[0];var o;var i=false;if(void 0!=t[0].length){t=t.map((function(r){return r[0]}));i=true}n.arange(e).forEach((function(e){o=n.arange(e).map((function(n){return r[e][n]*a[n]}));a[e]=(t[e]-n.sum(o))/r[e][e]}));return i?a.map((function(r){return[r]})):a},lu:function lu(r){var t=r.length;var e=n.identity(t);var a=n.zeros(r.length,r[0].length);var o;n.arange(t).forEach((function(n){a[0][n]=r[0][n]}));n.arange(1,t).forEach((function(i){n.arange(i).forEach((function(t){o=n.arange(t).map((function(r){return e[i][r]*a[r][t]}));e[i][t]=(r[i][t]-n.sum(o))/a[t][t]}));n.arange(i,t).forEach((function(t){o=n.arange(i).map((function(r){return e[i][r]*a[r][t]}));a[i][t]=r[o.length][t]-n.sum(o)}))}));return[e,a]},cholesky:function cholesky(r){var e=r.length;var a=n.zeros(r.length,r[0].length);var o;n.arange(e).forEach((function(i){o=n.arange(i).map((function(r){return t.pow(a[i][r],2)}));a[i][i]=t.sqrt(r[i][i]-n.sum(o));n.arange(i+1,e).forEach((function(t){o=n.arange(i).map((function(r){return a[i][r]*a[t][r]}));a[t][i]=(r[i][t]-n.sum(o))/a[i][i]}))}));return a},gauss_jacobi:function gauss_jacobi(r,e,a,o){var i=0;var u=0;var c=r.length;var s=[];var l=[];var v=[];var m,d,p,g;for(;i<c;i++){s[i]=[];l[i]=[];v[i]=[];for(u=0;u<c;u++)if(i>u){s[i][u]=r[i][u];l[i][u]=v[i][u]=0}else if(i<u){l[i][u]=r[i][u];s[i][u]=v[i][u]=0}else{v[i][u]=r[i][u];s[i][u]=l[i][u]=0}}p=n.multiply(n.multiply(n.inv(v),n.add(s,l)),-1);d=n.multiply(n.inv(v),e);m=a;g=n.add(n.multiply(p,a),d);i=2;while(t.abs(n.norm(n.subtract(g,m)))>o){m=g;g=n.add(n.multiply(p,m),d);i++}return g},gauss_seidel:function gauss_seidel(r,e,a,o){var i=0;var u=r.length;var c=[];var s=[];var l=[];var v,m,d,p,g;for(;i<u;i++){c[i]=[];s[i]=[];l[i]=[];for(v=0;v<u;v++)if(i>v){c[i][v]=r[i][v];s[i][v]=l[i][v]=0}else if(i<v){s[i][v]=r[i][v];c[i][v]=l[i][v]=0}else{l[i][v]=r[i][v];c[i][v]=s[i][v]=0}}p=n.multiply(n.multiply(n.inv(n.add(l,c)),s),-1);d=n.multiply(n.inv(n.add(l,c)),e);m=a;g=n.add(n.multiply(p,a),d);i=2;while(t.abs(n.norm(n.subtract(g,m)))>o){m=g;g=n.add(n.multiply(p,m),d);i+=1}return g},SOR:function SOR(r,e,a,o,i){var u=0;var c=r.length;var s=[];var l=[];var v=[];var m,d,p,g,h;for(;u<c;u++){s[u]=[];l[u]=[];v[u]=[];for(m=0;m<c;m++)if(u>m){s[u][m]=r[u][m];l[u][m]=v[u][m]=0}else if(u<m){l[u][m]=r[u][m];s[u][m]=v[u][m]=0}else{v[u][m]=r[u][m];s[u][m]=l[u][m]=0}}g=n.multiply(n.inv(n.add(v,n.multiply(s,i))),n.subtract(n.multiply(v,1-i),n.multiply(l,i)));p=n.multiply(n.multiply(n.inv(n.add(v,n.multiply(s,i))),e),i);d=a;h=n.add(n.multiply(g,a),p);u=2;while(t.abs(n.norm(n.subtract(h,d)))>o){d=h;h=n.add(n.multiply(g,d),p);u++}return h},householder:function householder(r){var e=r.length;var a=r[0].length;var o=0;var i=[];var u=[];var c,s,l,v,m;for(;o<e-1;o++){c=0;for(v=o+1;v<a;v++)c+=r[v][o]*r[v][o];m=r[o+1][o]>0?-1:1;c=m*t.sqrt(c);s=t.sqrt((c*c-r[o+1][o]*c)/2);i=n.zeros(e,1);i[o+1][0]=(r[o+1][o]-c)/(2*s);for(l=o+2;l<e;l++)i[l][0]=r[l][o]/(2*s);u=n.subtract(n.identity(e,a),n.multiply(n.multiply(i,n.transpose(i)),2));r=n.multiply(u,n.multiply(r,u))}return r},QR:function(){var r=n.sum;var e=n.arange;function qr2(a){var o=a.length;var i=a[0].length;var u=n.zeros(i,i);a=n.copy(a);var c,s,l;for(s=0;s<i;s++){u[s][s]=t.sqrt(r(e(o).map((function(r){return a[r][s]*a[r][s]}))));for(c=0;c<o;c++)a[c][s]=a[c][s]/u[s][s];for(l=s+1;l<i;l++){u[s][l]=r(e(o).map((function(r){return a[r][s]*a[r][l]})));for(c=0;c<o;c++)a[c][l]=a[c][l]-a[c][s]*u[s][l]}}return[a,u]}return qr2}(),lstsq:function(){function R_I(r){r=n.copy(r);var t=r.length;var e=n.identity(t);n.arange(t-1,-1,-1).forEach((function(t){n.sliceAssign(e,{row:t},n.divide(n.slice(e,{row:t}),r[t][t]));n.sliceAssign(r,{row:t},n.divide(n.slice(r,{row:t}),r[t][t]));n.arange(t).forEach((function(a){var o=n.multiply(r[a][t],-1);var i=n.slice(r,{row:a});var u=n.multiply(n.slice(r,{row:t}),o);n.sliceAssign(r,{row:a},n.add(i,u));var c=n.slice(e,{row:a});var s=n.multiply(n.slice(e,{row:t}),o);n.sliceAssign(e,{row:a},n.add(c,s))}))}));return e}function qr_solve(r,t){var e=false;if(void 0===t[0].length){t=t.map((function(r){return[r]}));e=true}var a=n.QR(r);var o=a[0];var i=a[1];var u=r[0].length;var c=n.slice(o,{col:{end:u}});var s=n.slice(i,{row:{end:u}});var l=R_I(s);var v=n.transpose(c);void 0===v[0].length&&(v=[v]);var m=n.multiply(n.multiply(l,v),t);void 0===m.length&&(m=[[m]]);return e?m.map((function(r){return r[0]})):m}return qr_solve}(),jacobi:function jacobi(r){var e=1;var a=r.length;var o=n.identity(a,a);var i=[];var u,c,s,l,v,m,d,p;while(1===e){m=r[0][1];l=0;v=1;for(c=0;c<a;c++)for(s=0;s<a;s++)if(c!=s&&m<t.abs(r[c][s])){m=t.abs(r[c][s]);l=c;v=s}d=r[l][l]===r[v][v]?r[l][v]>0?t.PI/4:-t.PI/4:t.atan(2*r[l][v]/(r[l][l]-r[v][v]))/2;p=n.identity(a,a);p[l][l]=t.cos(d);p[l][v]=-t.sin(d);p[v][l]=t.sin(d);p[v][v]=t.cos(d);o=n.multiply(o,p);u=n.multiply(n.multiply(n.inv(p),r),p);r=u;e=0;for(c=1;c<a;c++)for(s=1;s<a;s++)c!=s&&t.abs(r[c][s])>.001&&(e=1)}for(c=0;c<a;c++)i.push(r[c][c]);return[o,i]},rungekutta:function rungekutta(r,n,t,e,a,o){var i,u,c,s,l;if(2===o)while(e<=t){i=n*r(e,a);u=n*r(e+n,a+i);c=a+(i+u)/2;a=c;e+=n}if(4===o)while(e<=t){i=n*r(e,a);u=n*r(e+n/2,a+i/2);s=n*r(e+n/2,a+u/2);l=n*r(e+n,a+s);c=a+(i+2*u+2*s+l)/6;a=c;e+=n}return a},romberg:function romberg(r,n,e,a){var o=0;var i=(e-n)/2;var u=[];var c=[];var s=[];var l,v,m,d,p;while(o<a/2){p=r(n);for(m=n,d=0;m<=e;m+=i,d++)u[d]=m;l=u.length;for(m=1;m<l-1;m++)p+=(m%2!==0?4:2)*r(u[m]);p=i/3*(p+r(e));s[o]=p;i/=2;o++}v=s.length;l=1;while(1!==v){for(m=0;m<v-1;m++)c[m]=(t.pow(4,l)*s[m+1]-s[m])/(t.pow(4,l)-1);v=c.length;s=c;c=[];l++}return s},richardson:function richardson(r,n,e,a){function pos(r,n){var t=0;var e=r.length;var a;for(;t<e;t++)r[t]===n&&(a=t);return a}var o=t.abs(e-r[pos(r,e)+1]);var i=0;var u=[];var c=[];var s,l,v,m,d;while(a>=o){s=pos(r,e+a);l=pos(r,e);u[i]=(n[s]-2*n[l]+n[2*l-s])/(a*a);a/=2;i++}m=u.length;v=1;while(1!=m){for(d=0;d<m-1;d++)c[d]=(t.pow(4,v)*u[d+1]-u[d])/(t.pow(4,v)-1);m=c.length;u=c;c=[];v++}return u},simpson:function simpson(r,n,t,e){var a=(t-n)/e;var o=r(n);var i=[];var u=n;var c=0;var s=1;var l;for(;u<=t;u+=a,c++)i[c]=u;l=i.length;for(;s<l-1;s++)o+=(s%2!==0?4:2)*r(i[s]);return a/3*(o+r(t))},hermite:function hermite(r,n,t,e){var a=r.length;var o=0;var i=0;var u=[];var c=[];var s=[];var l=[];var v;for(;i<a;i++){u[i]=1;for(v=0;v<a;v++)i!=v&&(u[i]*=(e-r[v])/(r[i]-r[v]));c[i]=0;for(v=0;v<a;v++)i!=v&&(c[i]+=1/(r[i]-r[v]));s[i]=(1-2*(e-r[i])*c[i])*(u[i]*u[i]);l[i]=(e-r[i])*(u[i]*u[i]);o+=s[i]*n[i]+l[i]*t[i]}return o},lagrange:function lagrange(r,n,t){var e=0;var a=0;var o,i;var u=r.length;for(;a<u;a++){i=n[a];for(o=0;o<u;o++)a!=o&&(i*=(t-r[o])/(r[a]-r[o]));e+=i}return e},cubic_spline:function cubic_spline(r,t,e){var a=r.length;var o,i=0;var u=[];var c=[];var s=[];var l=[];var v=[];var m=[];var d=[];for(;i<a-1;i++)v[i]=r[i+1]-r[i];s[0]=0;for(i=1;i<a-1;i++)s[i]=3/v[i]*(t[i+1]-t[i])-3/v[i-1]*(t[i]-t[i-1]);for(i=1;i<a-1;i++){u[i]=[];c[i]=[];u[i][i-1]=v[i-1];u[i][i]=2*(v[i-1]+v[i]);u[i][i+1]=v[i];c[i][0]=s[i]}l=n.multiply(n.inv(u),c);for(o=0;o<a-1;o++){m[o]=(t[o+1]-t[o])/v[o]-v[o]*(l[o+1][0]+2*l[o][0])/3;d[o]=(l[o+1][0]-l[o][0])/(3*v[o])}for(o=0;o<a;o++)if(r[o]>e)break;o-=1;return t[o]+(e-r[o])*m[o]+n.sq(e-r[o])*l[o]+(e-r[o])*n.sq(e-r[o])*d[o]},gauss_quadrature:function gauss_quadrature(){throw new Error("gauss_quadrature not yet implemented")},PCA:function PCA(r){var t=r.length;var e=r[0].length;var a=0;var o,i;var u=[];var c=[];var s=[];var l=[];var v=[];var m=[];var d=[];var p=[];var g=[];var h=[];for(a=0;a<t;a++)u[a]=n.sum(r[a])/e;for(a=0;a<e;a++){d[a]=[];for(o=0;o<t;o++)d[a][o]=r[o][a]-u[o]}d=n.transpose(d);for(a=0;a<t;a++){p[a]=[];for(o=0;o<t;o++)p[a][o]=n.dot([d[a]],[d[o]])/(e-1)}s=n.jacobi(p);g=s[0];c=s[1];h=n.transpose(g);for(a=0;a<c.length;a++)for(o=a;o<c.length;o++)if(c[a]<c[o]){i=c[a];c[a]=c[o];c[o]=i;l=h[a];h[a]=h[o];h[o]=l}m=n.transpose(d);for(a=0;a<t;a++){v[a]=[];for(o=0;o<m.length;o++)v[a][o]=n.dot([h[a]],[m[o]])}return[r,c,h,v]}});(function(t){for(var e=0;e<t.length;e++)(function(t){n.fn[t]=function(e,a){var o=this||r;if(a){setTimeout((function(){a.call(o,n.fn[t].call(o,e))}),15);return this||r}return"number"===typeof n[t](this||r,e)?n[t](this||r,e):n(n[t](this||r,e))}})(t[e])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(n,Math);(function(n,t){var e=[].slice;var a=n.utils.isNumber;var o=n.utils.isArray;n.extend({zscore:function zscore(){var r=e.call(arguments);return a(r[1])?(r[0]-r[1])/r[2]:(r[0]-n.mean(r[1]))/n.stdev(r[1],r[2])},ztest:function ztest(){var r=e.call(arguments);var a;if(o(r[1])){a=n.zscore(r[0],r[1],r[3]);return 1===r[2]?n.normal.cdf(-t.abs(a),0,1):2*n.normal.cdf(-t.abs(a),0,1)}if(r.length>2){a=n.zscore(r[0],r[1],r[2]);return 1===r[3]?n.normal.cdf(-t.abs(a),0,1):2*n.normal.cdf(-t.abs(a),0,1)}a=r[0];return 1===r[1]?n.normal.cdf(-t.abs(a),0,1):2*n.normal.cdf(-t.abs(a),0,1)}});n.extend(n.fn,{zscore:function zscore(r,n){return(r-this.mean())/this.stdev(n)},ztest:function ztest(r,e,a){var o=t.abs(this.zscore(r,a));return 1===e?n.normal.cdf(-o,0,1):2*n.normal.cdf(-o,0,1)}});n.extend({tscore:function tscore(){var r=e.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/t.sqrt(r[3])):(r[0]-n.mean(r[1]))/(n.stdev(r[1],true)/t.sqrt(r[1].length))},ttest:function ttest(){var r=e.call(arguments);var o;if(5===r.length){o=t.abs(n.tscore(r[0],r[1],r[2],r[3]));return 1===r[4]?n.studentt.cdf(-o,r[3]-1):2*n.studentt.cdf(-o,r[3]-1)}if(a(r[1])){o=t.abs(r[0]);return 1==r[2]?n.studentt.cdf(-o,r[1]-1):2*n.studentt.cdf(-o,r[1]-1)}o=t.abs(n.tscore(r[0],r[1]));return 1==r[2]?n.studentt.cdf(-o,r[1].length-1):2*n.studentt.cdf(-o,r[1].length-1)}});n.extend(n.fn,{tscore:function tscore(r){return(r-this.mean())/(this.stdev(true)/t.sqrt(this.cols()))},ttest:function ttest(r,e){return 1===e?1-n.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):2*n.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)}});n.extend({anovafscore:function anovafscore(){var r,a,o,i,u,c,s,l,v=e.call(arguments);if(1===v.length){u=new Array(v[0].length);for(s=0;s<v[0].length;s++)u[s]=v[0][s];v=u}a=new Array;for(s=0;s<v.length;s++)a=a.concat(v[s]);o=n.mean(a);r=0;for(s=0;s<v.length;s++)r+=v[s].length*t.pow(n.mean(v[s])-o,2);r/=v.length-1;c=0;for(s=0;s<v.length;s++){i=n.mean(v[s]);for(l=0;l<v[s].length;l++)c+=t.pow(v[s][l]-i,2)}c/=a.length-v.length;return r/c},anovaftest:function anovaftest(){var r,t,o,i,u=e.call(arguments);if(a(u[0]))return 1-n.centralF.cdf(u[0],u[1],u[2]);var c=n.anovafscore(u);r=u.length-1;o=0;for(i=0;i<u.length;i++)o+=u[i].length;t=o-r-1;return 1-n.centralF.cdf(c,r,t)},ftest:function ftest(r,t,e){return 1-n.centralF.cdf(r,t,e)}});n.extend(n.fn,{anovafscore:function anovafscore(){return n.anovafscore(this.toArray())},anovaftes:function anovaftes(){var t=0;var e;for(e=0;e<(this||r).length;e++)t+=(this||r)[e].length;return n.ftest(this.anovafscore(),(this||r).length-1,t-(this||r).length)}});n.extend({qscore:function qscore(){var r=e.call(arguments);var o,i,u,c,s;if(a(r[0])){o=r[0];i=r[1];u=r[2];c=r[3];s=r[4]}else{o=n.mean(r[0]);i=n.mean(r[1]);u=r[0].length;c=r[1].length;s=r[2]}return t.abs(o-i)/(s*t.sqrt((1/u+1/c)/2))},qtest:function qtest(){var r=e.call(arguments);var t;if(3===r.length){t=r[0];r=r.slice(1)}else if(7===r.length){t=n.qscore(r[0],r[1],r[2],r[3],r[4]);r=r.slice(5)}else{t=n.qscore(r[0],r[1],r[2]);r=r.slice(3)}var a=r[0];var o=r[1];return 1-n.tukey.cdf(t,o,a-o)},tukeyhsd:function tukeyhsd(r){var t=n.pooledstdev(r);var e=r.map((function(r){return n.mean(r)}));var a=r.reduce((function(r,n){return r+n.length}),0);var o=[];for(var i=0;i<r.length;++i)for(var u=i+1;u<r.length;++u){var c=n.qtest(e[i],e[u],r[i].length,r[u].length,t,a,r.length);o.push([[i,u],c])}return o}});n.extend({normalci:function normalci(){var r,a=e.call(arguments),o=new Array(2);r=4===a.length?t.abs(n.normal.inv(a[1]/2,0,1)*a[2]/t.sqrt(a[3])):t.abs(n.normal.inv(a[1]/2,0,1)*n.stdev(a[2])/t.sqrt(a[2].length));o[0]=a[0]-r;o[1]=a[0]+r;return o},tci:function tci(){var r,a=e.call(arguments),o=new Array(2);r=4===a.length?t.abs(n.studentt.inv(a[1]/2,a[3]-1)*a[2]/t.sqrt(a[3])):t.abs(n.studentt.inv(a[1]/2,a[2].length-1)*n.stdev(a[2],true)/t.sqrt(a[2].length));o[0]=a[0]-r;o[1]=a[0]+r;return o},significant:function significant(r,n){return r<n}});n.extend(n.fn,{normalci:function normalci(r,t){return n.normalci(r,t,this.toArray())},tci:function tci(r,t){return n.tci(r,t,this.toArray())}});function differenceOfProportions(r,n,e,a){if(r>1||e>1||r<=0||e<=0)throw new Error("Proportions should be greater than 0 and less than 1");var o=(r*n+e*a)/(n+a);var i=t.sqrt(o*(1-o)*(1/n+1/a));return(r-e)/i}n.extend(n.fn,{oneSidedDifferenceOfProportions:function oneSidedDifferenceOfProportions(r,t,e,a){var o=differenceOfProportions(r,t,e,a);return n.ztest(o,1)},twoSidedDifferenceOfProportions:function twoSidedDifferenceOfProportions(r,t,e,a){var o=differenceOfProportions(r,t,e,a);return n.ztest(o,2)}})})(n,Math);n.models=function(){function sub_regress(r){var t=r[0].length;var e=n.arange(t).map((function(e){var a=n.arange(t).filter((function(r){return r!==e}));return ols(n.col(r,e).map((function(r){return r[0]})),n.col(r,a))}));return e}function ols(r,t){var e=r.length;var a=t[0].length-1;var o=e-a-1;var i=n.lstsq(t,r);var u=n.multiply(t,i.map((function(r){return[r]}))).map((function(r){return r[0]}));var c=n.subtract(r,u);var s=n.mean(r);var l=n.sum(u.map((function(r){return Math.pow(r-s,2)})));var v=n.sum(r.map((function(r,n){return Math.pow(r-u[n],2)})));var m=l+v;var d=l/m;return{exog:t,endog:r,nobs:e,df_model:a,df_resid:o,coef:i,predict:u,resid:c,ybar:s,SST:m,SSE:l,SSR:v,R2:d}}function t_test(r){var t=sub_regress(r.exog);var e=Math.sqrt(r.SSR/r.df_resid);var a=t.map((function(r){var n=r.SST;var t=r.R2;return e/Math.sqrt(n*(1-t))}));var o=r.coef.map((function(r,n){return(r-0)/a[n]}));var i=o.map((function(t){var e=n.studentt.cdf(t,r.df_resid);return 2*(e>.5?1-e:e)}));var u=n.studentt.inv(.975,r.df_resid);var c=r.coef.map((function(r,n){var t=u*a[n];return[r-t,r+t]}));return{se:a,t:o,p:i,sigmaHat:e,interval95:c}}function F_test(r){var t=r.R2/r.df_model/((1-r.R2)/r.df_resid);var fcdf=function(r,t,e){return n.beta.cdf(r/(e/t+r),t/2,e/2)};var e=1-fcdf(t,r.df_model,r.df_resid);return{F_statistic:t,pvalue:e}}function ols_wrap(r,n){var t=ols(r,n);var e=t_test(t);var a=F_test(t);var o=1-(1-t.R2)*((t.nobs-1)/t.df_resid);t.t=e;t.f=a;t.adjust_R2=o;return t}return{ols:ols_wrap}}();n.extend({buildxmatrix:function buildxmatrix(){var r=new Array(arguments.length);for(var t=0;t<arguments.length;t++){var e=[1];r[t]=e.concat(arguments[t])}return n(r)},builddxmatrix:function builddxmatrix(){var r=new Array(arguments[0].length);for(var t=0;t<arguments[0].length;t++){var e=[1];r[t]=e.concat(arguments[0][t])}return n(r)},buildjxmatrix:function buildjxmatrix(r){var t=new Array(r.length);for(var e=0;e<r.length;e++)t[e]=r[e];return n.builddxmatrix(t)},buildymatrix:function buildymatrix(r){return n(r).transpose()},buildjymatrix:function buildjymatrix(r){return r.transpose()},matrixmult:function matrixmult(r,t){var e,a,o,i,u;if(r.cols()==t.rows()){if(t.rows()>1){i=[];for(e=0;e<r.rows();e++){i[e]=[];for(a=0;a<t.cols();a++){u=0;for(o=0;o<r.cols();o++)u+=r.toArray()[e][o]*t.toArray()[o][a];i[e][a]=u}}return n(i)}i=[];for(e=0;e<r.rows();e++){i[e]=[];for(a=0;a<t.cols();a++){u=0;for(o=0;o<r.cols();o++)u+=r.toArray()[e][o]*t.toArray()[a];i[e][a]=u}}return n(i)}},regress:function regress(r,t){var e=n.xtranspxinv(r);var a=r.transpose();var o=n.matrixmult(n(e),a);return n.matrixmult(o,t)},regresst:function regresst(r,t,e){var a=n.regress(r,t);var o={};o.anova={};var i=n.jMatYBar(r,a);o.yBar=i;var u=t.mean();o.anova.residuals=n.residuals(t,i);o.anova.ssr=n.ssr(i,u);o.anova.msr=o.anova.ssr/(r[0].length-1);o.anova.sse=n.sse(t,i);o.anova.mse=o.anova.sse/(t.length-(r[0].length-1)-1);o.anova.sst=n.sst(t,u);o.anova.mst=o.anova.sst/(t.length-1);o.anova.r2=1-o.anova.sse/o.anova.sst;o.anova.r2<0&&(o.anova.r2=0);o.anova.fratio=o.anova.msr/o.anova.mse;o.anova.pvalue=n.anovaftest(o.anova.fratio,r[0].length-1,t.length-(r[0].length-1)-1);o.anova.rmse=Math.sqrt(o.anova.mse);o.anova.r2adj=1-o.anova.mse/o.anova.mst;o.anova.r2adj<0&&(o.anova.r2adj=0);o.stats=new Array(r[0].length);var c=n.xtranspxinv(r);var s,l,v;for(var m=0;m<a.length;m++){s=Math.sqrt(o.anova.mse*Math.abs(c[m][m]));l=Math.abs(a[m]/s);v=n.ttest(l,t.length-r[0].length-1,e);o.stats[m]=[a[m],s,l,v]}o.regress=a;return o},xtranspx:function xtranspx(r){return n.matrixmult(r.transpose(),r)},xtranspxinv:function xtranspxinv(r){var t=n.matrixmult(r.transpose(),r);var e=n.inv(t);return e},jMatYBar:function jMatYBar(r,t){var e=n.matrixmult(r,t);return new n(e)},residuals:function residuals(r,t){return n.matrixsubtract(r,t)},ssr:function ssr(r,n){var ssr=0;for(var t=0;t<r.length;t++)ssr+=Math.pow(r[t]-n,2);return ssr},sse:function sse(r,n){var sse=0;for(var t=0;t<r.length;t++)sse+=Math.pow(r[t]-n[t],2);return sse},sst:function sst(r,n){var sst=0;for(var t=0;t<r.length;t++)sst+=Math.pow(r[t]-n,2);return sst},matrixsubtract:function matrixsubtract(r,t){var e=new Array(r.length);for(var a=0;a<r.length;a++){e[a]=new Array(r[a].length);for(var o=0;o<r[a].length;o++)e[a][o]=r[a][o]-t[a][o]}return n(e)}});n.jStat=n;return n}));var t=n;export{t as default};

