import*as r from"jstat";import*as e from"bessel";var n={},t=false;function dew$f(){if(t)return n;t=true;n.nil=new Error("#NULL!");n.div0=new Error("#DIV/0!");n.value=new Error("#VALUE!");n.ref=new Error("#REF!");n.name=new Error("#NAME?");n.num=new Error("#NUM!");n.na=new Error("#N/A");n.error=new Error("#ERROR!");n.data=new Error("#GETTING_DATA");return n}var a={},u=false;var i="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$e(){if(u)return a;u=true;var r=dew$f();a.flattenShallow=function(r){return r&&r.reduce?r.reduce((function(r,e){var n=Array.isArray(r);var t=Array.isArray(e);if(n&&t)return r.concat(e);if(n){r.push(e);return r}return t?[r].concat(e):[r,e]})):r};a.isFlat=function(r){if(!r)return false;for(var e=0;e<r.length;++e)if(Array.isArray(r[e]))return false;return true};a.flatten=function(){var r=a.argsToArray.apply(null,arguments);while(!a.isFlat(r))r=a.flattenShallow(r);return r};a.argsToArray=function(r){var e=[];a.arrayEach(r,(function(r){e.push(r)}));return e};a.numbers=function(){var r=(this||i).flatten.apply(null,arguments);return r.filter((function(r){return"number"===typeof r}))};a.cleanFloat=function(r){var e=1e14;return Math.round(r*e)/e};a.parseBool=function(e){if("boolean"===typeof e)return e;if(e instanceof Error)return e;if("number"===typeof e)return 0!==e;if("string"===typeof e){var n=e.toUpperCase();if("TRUE"===n)return true;if("FALSE"===n)return false}return e instanceof Date&&!isNaN(e)||r.value};a.parseNumber=function(e){if(e instanceof Error)return e;if(void 0===e||null===e||""===e)return 0;"boolean"===typeof e&&(e=+e);return isNaN(e)?r.value:parseFloat(e)};a.parseString=function(r){return r instanceof Error?r:void 0===r||null===r?"":r.toString()};a.parseNumberArray=function(e){var n;if(!e||0===(n=e.length))return r.value;var t;while(n--){if(e[n]instanceof Error)return e[n];t=a.parseNumber(e[n]);if(t instanceof Error)return t;e[n]=t}return e};a.parseMatrix=function(e){if(!e||0===e.length)return r.value;var n;for(var t=0;t<e.length;t++){n=a.parseNumberArray(e[t]);e[t]=n;if(n instanceof Error)return n}return e};function serialNumberToDate(r){r<60&&(r+=1);var e=Math.floor(r-25569);var n=86400*e;var t=new Date(1e3*n);var a=r-Math.floor(r)+1e-7;var u=Math.floor(86400*a);var i=u%60;u-=i;var f=Math.floor(u/3600);var o=Math.floor(u/60)%60;var s=t.getDate();var l=t.getMonth();if(r>=60&&r<61){s=29;l=1}return new Date(t.getFullYear(),l,s,f,o,i)}a.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var n=parseFloat(e);return n<0||n>=2958466?r.num:serialNumberToDate(n)}if("string"===typeof e){e=new Date(e);if(!isNaN(e))return e}return r.value};a.parseDateArray=function(e){var n=e.length;var t;while(n--){t=this.parseDate(e[n]);if(t===r.value)return t;e[n]=t}return e};a.anyError=function(){for(var r=0;r<arguments.length;r++)if(arguments[r]instanceof Error)return arguments[r]};a.isDefined=function(r){return void 0!==r&&null!==r};a.anyIsError=function(){var r=arguments.length;while(r--)if(arguments[r]instanceof Error)return true;return false};a.anyIsString=function(){var r=arguments.length;while(r--)if("string"===typeof arguments[r])return true;return false};a.arrayValuesToNumbers=function(r){var e=r.length;var n;while(e--){n=r[e];if("number"!==typeof n)if(true!==n)if(false!==n){if("string"===typeof n){var t=this.parseNumber(n);t instanceof Error?r[e]=0:r[e]=t}}else r[e]=0;else r[e]=1}return r};a.rest=function(r,e){e=e||1;return r&&"function"===typeof r.slice?r.slice(e):r};a.initial=function(r,e){e=e||1;return r&&"function"===typeof r.slice?r.slice(0,r.length-e):r};a.arrayEach=function(r,e){var n=-1,t=r.length;while(++n<t)if(false===e(r[n],n,r))break;return r};a.transpose=function(e){return e?e[0].map((function(r,n){return e.map((function(r){return r[n]}))})):r.value};return a}var f={},o=false;function dew$d(){if(o)return f;o=true;var r=dew$e();var e=dew$f();f.ASC=function(){throw new Error("ASC is not implemented")};f.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")};f.CHAR=function(n){n=r.parseNumber(n);return 0===n?e.value:n instanceof Error?n:String.fromCharCode(n)};f.CLEAN=function(e){if(r.anyIsError(e))return e;e=e||"";var n=/[\0-\x1F]/g;return e.replace(n,"")};f.CODE=function(n){if(r.anyIsError(n))return n;n=n||"";var t=n.charCodeAt(0);isNaN(t)&&(t=e.value);return t};f.CONCATENATE=function(){var e=r.flatten(arguments);var n=r.anyError.apply(void 0,e);if(n)return n;var t=0;while((t=e.indexOf(true))>-1)e[t]="TRUE";var a=0;while((a=e.indexOf(false))>-1)e[a]="FALSE";return e.join("")};f.CONCAT=f.CONCATENATE;f.DBCS=function(){throw new Error("DBCS is not implemented")};f.DOLLAR=function(){throw new Error("DOLLAR is not implemented")};f.EXACT=function(n,t){if(2!==arguments.length)return e.na;var a=r.anyError(n,t);if(a)return a;n=r.parseString(n);t=r.parseString(t);return n===t};f.FIND=function(n,t,a){if(arguments.length<2)return e.na;n=r.parseString(n);t=r.parseString(t);a=void 0===a?0:a;var u=t.indexOf(n,a-1);return-1===u?e.value:u+1};f.FIXED=function(){throw new Error("FIXED is not implemented")};f.HTML2TEXT=function(e){if(r.anyIsError(e))return e;var n="";e&&(e instanceof Array?e.forEach((function(r){""!==n&&(n+="\n");n+=r.replace(/<(?:.|\n)*?>/gm,"")})):n=e.replace(/<(?:.|\n)*?>/gm,""));return n};f.LEFT=function(n,t){var a=r.anyError(n,t);if(a)return a;n=r.parseString(n);t=void 0===t?1:t;t=r.parseNumber(t);return t instanceof Error||"string"!==typeof n?e.value:n.substring(0,t)};f.LEN=function(n){if(0===arguments.length)return e.error;if(n instanceof Error)return n;if(Array.isArray(n))return e.value;var t=r.parseString(n);return t.length};f.LOWER=function(n){if(1!==arguments.length)return e.value;n=r.parseString(n);return r.anyIsError(n)?n:n.toLowerCase()};f.MID=function(n,t,a){if(void 0===t||null===t)return e.value;t=r.parseNumber(t);a=r.parseNumber(a);if(r.anyIsError(t,a)||"string"!==typeof n)return a;var u=t-1;var i=u+a;return n.substring(u,i)};f.NUMBERVALUE=function(r,e,n){e="undefined"===typeof e?".":e;n="undefined"===typeof n?",":n;return Number(r.replace(e,".").replace(n,""))};f.PRONETIC=function(){throw new Error("PRONETIC is not implemented")};f.PROPER=function(n){if(r.anyIsError(n))return n;if(isNaN(n)&&"number"===typeof n)return e.value;n=r.parseString(n);return n.replace(/\w\S*/g,(function(r){return r.charAt(0).toUpperCase()+r.substr(1).toLowerCase()}))};f.REGEXEXTRACT=function(r,n){if(arguments.length<2)return e.na;var t=r.match(new RegExp(n));return t?t[t.length>1?t.length-1:0]:null};f.REGEXMATCH=function(r,n,t){if(arguments.length<2)return e.na;var a=r.match(new RegExp(n));return t?a:!!a};f.REGEXREPLACE=function(r,n,t){return arguments.length<3?e.na:r.replace(new RegExp(n),t)};f.REPLACE=function(n,t,a,u){t=r.parseNumber(t);a=r.parseNumber(a);return r.anyIsError(t,a)||"string"!==typeof n||"string"!==typeof u?e.value:n.substr(0,t-1)+u+n.substr(t-1+a)};f.REPT=function(e,n){var t=r.anyError(e,n);if(t)return t;e=r.parseString(e);n=r.parseNumber(n);return n instanceof Error?n:new Array(n+1).join(e)};f.RIGHT=function(e,n){var t=r.anyError(e,n);if(t)return t;e=r.parseString(e);n=void 0===n?1:n;n=r.parseNumber(n);return n instanceof Error?n:e.substring(e.length-n)};f.SEARCH=function(r,n,t){var a;if("string"!==typeof r||"string"!==typeof n)return e.value;t=void 0===t?0:t;a=n.toLowerCase().indexOf(r.toLowerCase(),t-1)+1;return 0===a?e.value:a};f.SPLIT=function(r,e){return r.split(e)};f.SUBSTITUTE=function(r,n,t,a){if(arguments.length<3)return e.na;if(r&&n){if(void 0===a)return r.split(n).join(t);a=Math.floor(Number(a));if(Number.isNaN(a)||a<=0)return e.value;var u=0;var i=0;while(u>-1&&r.indexOf(n,u)>-1){u=r.indexOf(n,u+1);i++;if(u>-1&&i===a)return r.substring(0,u)+t+r.substring(u+n.length)}return r}return r};f.T=function(r){return r instanceof Error||"string"===typeof r?r:""};f.TEXT=function(){throw new Error("TEXT is not implemented")};f.TRIM=function(e){e=r.parseString(e);return e instanceof Error?e:e.replace(/\s+/g," ").trim()};f.UNICHAR=f.CHAR;f.UNICODE=f.CODE;f.UPPER=function(e){e=r.parseString(e);return e instanceof Error?e:e.toUpperCase()};f.VALUE=function(n){var t=r.anyError(n);if(t)return t;if("string"!==typeof n)return e.value;var a=/(%)$/.test(n)||/^(%)/.test(n);n=n.replace(/^[^0-9-]{0,3}/,"");n=n.replace(/[^0-9]{0,3}$/,"");n=n.replace(/[\ ,]/g,"");if(""===n)return e.value;var u=Number(n);if(isNaN(u))return e.value;u=u||0;a&&(u*=.01);return u};return f}var s={},l=false;function dew$c(){if(l)return s;l=true;var r="=";var e=[">",">=","<","<=","=","<>"];var n="operator";var t="literal";var a=[n,t];s.TOKEN_TYPE_OPERATOR=n;s.TOKEN_TYPE_LITERAL=t;
/**
   * Create token which describe passed symbol/value.
   *
   * @param {String} value Value/Symbol to describe.
   * @param {String} type Type of the token 'operator' or 'literal'.
   * @return {Object}
   */function createToken(r,e){if(-1===a.indexOf(e))throw new Error("Unsupported token type: "+e);return{value:r,type:e}}
/**
   * Tries to cast numeric values to their type passed as a string.
   *
   * @param {*} value
   * @return {*}
   */function castValueToCorrectType(r){if("string"!==typeof r)return r;/^\d+(\.\d+)?$/.test(r)&&(r=-1===r.indexOf(".")?parseInt(r,10):parseFloat(r));return r}
/**
   * Generate stream of tokens from passed expression.
   *
   * @param {String} expression
   * @return {String[]}
   */function tokenizeExpression(r){var e=r.length;var n=[];var t=0;var a="";var u="";while(t<e){var i=r.charAt(t);switch(i){case">":case"<":case"=":u+=i;if(a.length>0){n.push(a);a=""}break;default:if(u.length>0){n.push(u);u=""}a+=i;break}t++}a.length>0&&n.push(a);u.length>0&&n.push(u);return n}
/**
   * Analyze and convert tokens to an object which describes their meaning.
   *
   * @param {String[]} tokens
   * @return {Object[]}
   */
function analyzeTokens(a){var u="";var i=[];for(var f=0;f<a.length;f++){var o=a[f];0===f&&e.indexOf(o)>=0?i.push(createToken(o,n)):u+=o}u.length>0&&i.push(createToken(castValueToCorrectType(u),t));i.length>0&&i[0].type!==n&&i.unshift(createToken(r,n));return i}
/**
   * Compute/Evaluate an expression passed as an array of tokens.
   *
   * @param {Object[]} tokens
   * @return {Boolean}
   */
function computeExpression(r){var e=[];var a;for(var u=0;u<r.length;u++){var i=r[u];switch(i.type){case n:a=i.value;break;case t:e.push(i.value);break}}return evaluate(e,a)}
/**
   * Evaluate values based on passed math operator.
   *
   * @param {*} values
   * @param {String} operator
   * @return {Boolean}
   */
function evaluate(r,e){var n=false;switch(e){case">":n=r[0]>r[1];break;case">=":n=r[0]>=r[1];break;case"<":n=r[0]<r[1];break;case"<=":n=r[0]<=r[1];break;case"=":n=r[0]==r[1];break;case"<>":n=r[0]!=r[1];break}return n}s.parse=function(r){return analyzeTokens(tokenizeExpression(r))};s.createToken=createToken;s.compute=computeExpression;return s}var v={},c=false;function dew$b(){if(c)return v;c=true;var r=dew$e();var e=dew$f();v.UNIQUE=function(){var r=[];for(var e=0;e<arguments.length;++e){var n=false;var t=arguments[e];for(var a=0;a<r.length;++a){n=r[a]===t;if(n)break}n||r.push(t)}return r};v.FLATTEN=r.flatten;v.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};v.REFERENCE=function(r,n){if(!arguments.length)return e.error;try{var t=n.split(".");var a=r;for(var u=0;u<t.length;++u){var i=t[u];if("]"===i[i.length-1]){var f=i.indexOf("[");var o=i.substring(f+1,i.length-1);a=a[i.substring(0,f)][o]}else a=a[i]}return a}catch(r){}};v.JOIN=function(r,e){return r.join(e)};v.NUMBERS=function(){var e=r.flatten(arguments);return e.filter((function(r){return"number"===typeof r}))};return v}var E="default"in r?r.default:r;var p={},N=false;var m="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$a(){if(N)return p;N=true;var r=dew$8();var e=dew$d();var n=E;var t=dew$e();var a=dew$c();var u=dew$f();var i=dew$b();var f=2.5066282746310002;p.AVEDEV=function(){var r=t.flatten(arguments);var e=r.filter(t.isDefined);if(0===e.length)return u.num;var a=t.parseNumberArray(e);return a instanceof Error?a:n.sum(n(a).subtract(n.mean(a)).abs()[0])/a.length};p.AVERAGE=function(){var r=t.flatten(arguments);var e=r.filter(t.isDefined);if(0===e.length)return u.div0;var n=t.anyError.apply(void 0,e);if(n)return n;var a=t.numbers(e);var i=a.length;var f=0;var o=0;var s;for(var l=0;l<i;l++){f+=a[l];o+=1}s=f/o;isNaN(s)&&(s=u.num);return s};p.AVERAGEA=function(){var r=t.flatten(arguments);var e=r.filter(t.isDefined);if(0===e.length)return u.div0;var n=t.anyError.apply(void 0,e);if(n)return n;var a=e;var i=a.length;var f=0;var o=0;var s;for(var l=0;l<i;l++){var v=a[l];"number"===typeof v&&(f+=v);true===v&&f++;null!==v&&o++}s=f/o;isNaN(s)&&(s=u.num);return s};p.AVERAGEIF=function(r,e,n){if(arguments.length<=1)return u.na;n=n||r;var i=t.flatten(n);var f=i.filter(t.isDefined);n=t.parseNumberArray(f);r=t.flatten(r);if(n instanceof Error)return n;var o=0;var s=0;var l=void 0===e||"*"===e;var v=l?null:a.parse(e+"");for(var c=0;c<r.length;c++){var E=r[c];if(l){s+=n[c];o++}else{var p=[a.createToken(E,a.TOKEN_TYPE_LITERAL)].concat(v);if(a.compute(p)){s+=n[c];o++}}}return s/o};p.AVERAGEIFS=function(){var r=t.argsToArray(arguments);var e=(r.length-1)/2;var n=t.flatten(r[0]);var u=0;var i=0;for(var f=0;f<n.length;f++){var o=false;for(var s=0;s<e;s++){var l=r[2*s+1][f];var v=r[2*s+2];var c=void 0===v||"*"===v;var E=false;if(c)E=true;else{var p=a.parse(v+"");var N=[a.createToken(l,a.TOKEN_TYPE_LITERAL)].concat(p);E=a.compute(N)}if(!E){o=false;break}o=true}if(o){i+=n[f];u++}}var m=i/u;return isNaN(m)?0:m};p.BETA={};p.BETA.DIST=function(r,e,a,i,f,o){if(arguments.length<4)return u.value;f=void 0===f?0:f;o=void 0===o?1:o;r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);f=t.parseNumber(f);o=t.parseNumber(o);if(t.anyIsError(r,e,a,f,o))return u.value;r=(r-f)/(o-f);return i?n.beta.cdf(r,e,a):n.beta.pdf(r,e,a)};p.BETA.INV=function(r,e,a,i,f){i=void 0===i?0:i;f=void 0===f?1:f;r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);i=t.parseNumber(i);f=t.parseNumber(f);return t.anyIsError(r,e,a,i,f)?u.value:n.beta.inv(r,e,a)*(f-i)+i};p.BINOM={};p.BINOM.DIST=function(r,e,a,i){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);i=t.parseNumber(i);return t.anyIsError(r,e,a,i)?u.value:i?n.binomial.cdf(r,e,a):n.binomial.pdf(r,e,a)};p.BINOM.DIST.RANGE=function(e,n,a,i){i=void 0===i?a:i;e=t.parseNumber(e);n=t.parseNumber(n);a=t.parseNumber(a);i=t.parseNumber(i);if(t.anyIsError(e,n,a,i))return u.value;var f=0;for(var o=a;o<=i;o++)f+=r.COMBIN(e,o)*Math.pow(n,o)*Math.pow(1-n,e-o);return f};p.BINOM.INV=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);if(t.anyIsError(r,e,a))return u.value;var i=0;while(i<=r){if(n.binomial.cdf(i,r,e)>=a)return i;i++}};p.CHISQ={};p.CHISQ.DIST=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);return t.anyIsError(r,e)?u.value:a?n.chisquare.cdf(r,e):n.chisquare.pdf(r,e)};p.CHISQ.DIST.RT=function(r,e){return!r|!e?u.na:r<1||e>Math.pow(10,10)?u.num:"number"!==typeof r||"number"!==typeof e?u.value:1-n.chisquare.cdf(r,e)};p.CHISQ.INV=function(r,e){r=t.parseNumber(r);e=t.parseNumber(e);return t.anyIsError(r,e)?u.value:n.chisquare.inv(r,e)};p.CHISQ.INV.RT=function(r,e){return!r|!e?u.na:r<0||r>1||e<1||e>Math.pow(10,10)?u.num:"number"!==typeof r||"number"!==typeof e?u.value:n.chisquare.inv(1-r,e)};p.CHISQ.TEST=function(r,e){if(2!==arguments.length)return u.na;if(!(r instanceof Array)||!(e instanceof Array))return u.value;if(r.length!==e.length)return u.value;if(r[0]&&e[0]&&r[0].length!==e[0].length)return u.value;var n=r.length;var t,a,i;for(a=0;a<n;a++){if(!(r[a]instanceof Array)){t=r[a];r[a]=[];r[a].push(t)}if(!(e[a]instanceof Array)){t=e[a];e[a]=[];e[a].push(t)}}var f=r[0].length;var o=1===f?n-1:(n-1)*(f-1);var s=0;var l=Math.PI;for(a=0;a<n;a++)for(i=0;i<f;i++)s+=Math.pow(r[a][i]-e[a][i],2)/e[a][i];function ChiSq(r,e){var n=Math.exp(-.5*r);e%2===1&&(n*=Math.sqrt(2*r/l));var t=e;while(t>=2){n=n*r/t;t-=2}var a=n;var u=e;while(a>1e-10*n){u+=2;a=a*r/u;n+=a}return 1-n}return Math.round(1e6*ChiSq(s,o))/1e6};p.COLUMN=function(r,e){return 2!==arguments.length?u.na:e<0?u.num:r instanceof Array&&"number"===typeof e?0!==r.length?n.col(r,e):void 0:u.value};p.COLUMNS=function(r){return 1!==arguments.length?u.na:r instanceof Array?0===r.length?0:n.cols(r):u.value};p.CONFIDENCE={};p.CONFIDENCE.NORM=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:n.normalci(1,r,e,a)[1]-1};p.CONFIDENCE.T=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:n.tci(1,r,e,a)[1]-1};p.CORREL=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));return t.anyIsError(r,e)?u.value:n.corrcoeff(r,e)};p.COUNT=function(){var r=t.flatten(arguments);return t.numbers(r).length};p.COUNTA=function(){var r=t.flatten(arguments);return r.length-p.COUNTBLANK(r)};p.COUNTIN=function(r,e){var n=0;r=t.flatten(r);for(var a=0;a<r.length;a++)r[a]===e&&n++;return n};p.COUNTBLANK=function(){var r=t.flatten(arguments);var e=0;var n;for(var a=0;a<r.length;a++){n=r[a];void 0!==n&&null!==n&&""!==n||e++}return e};p.COUNTIF=function(r,e){r=t.flatten(r);var n=void 0===e||"*"===e;if(n)return r.length;var u=0;var i=a.parse(e+"");for(var f=0;f<r.length;f++){var o=r[f];var s=[a.createToken(o,a.TOKEN_TYPE_LITERAL)].concat(i);a.compute(s)&&u++}return u};p.COUNTIFS=function(){var r=t.argsToArray(arguments);var e=new Array(t.flatten(r[0]).length);for(var n=0;n<e.length;n++)e[n]=true;for(n=0;n<r.length;n+=2){var u=t.flatten(r[n]);var i=r[n+1];var f=void 0===i||"*"===i;if(!f){var o=a.parse(i+"");for(var s=0;s<u.length;s++){var l=u[s];var v=[a.createToken(l,a.TOKEN_TYPE_LITERAL)].concat(o);e[s]=e[s]&&a.compute(v)}}}var c=0;for(n=0;n<e.length;n++)e[n]&&c++;return c};p.COUNTUNIQUE=function(){return i.UNIQUE.apply(null,t.flatten(arguments)).length};p.COVARIANCE={};p.COVARIANCE.P=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;var a=n.mean(r);var i=n.mean(e);var f=0;var o=r.length;for(var s=0;s<o;s++)f+=(r[s]-a)*(e[s]-i);return f/o};p.COVARIANCE.S=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));return t.anyIsError(r,e)?u.value:n.covariance(r,e)};p.DEVSQ=function(){var r=t.parseNumberArray(t.flatten(arguments));if(r instanceof Error)return r;var e=n.mean(r);var a=0;for(var u=0;u<r.length;u++)a+=Math.pow(r[u]-e,2);return a};p.EXPON={};p.EXPON.DIST=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);return t.anyIsError(r,e)?u.value:a?n.exponential.cdf(r,e):n.exponential.pdf(r,e)};p.F={};p.F.DIST=function(r,e,a,i){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:i?n.centralF.cdf(r,e,a):n.centralF.pdf(r,e,a)};p.F.DIST.RT=function(r,e,t){return 3!==arguments.length?u.na:r<0||e<1||t<1?u.num:"number"!==typeof r||"number"!==typeof e||"number"!==typeof t?u.value:1-n.centralF.cdf(r,e,t)};p.F.INV=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:r<=0||r>1?u.num:n.centralF.inv(r,e,a)};p.F.INV.RT=function(r,e,t){return 3!==arguments.length?u.na:r<0||r>1||e<1||e>Math.pow(10,10)||t<1||t>Math.pow(10,10)?u.num:"number"!==typeof r||"number"!==typeof e||"number"!==typeof t?u.value:n.centralF.inv(1-r,e,t)};p.F.TEST=function(e,n){if(!e||!n)return u.na;if(!(e instanceof Array)||!(n instanceof Array))return u.na;if(e.length<2||n.length<2)return u.div0;var sumOfSquares=function(r,e){var n=0;for(var t=0;t<r.length;t++)n+=Math.pow(r[t]-e,2);return n};var t=r.SUM(e)/e.length;var a=r.SUM(n)/n.length;var i=sumOfSquares(e,t)/(e.length-1);var f=sumOfSquares(n,a)/(n.length-1);return i/f};p.FISHER=function(r){r=t.parseNumber(r);return r instanceof Error?r:Math.log((1+r)/(1-r))/2};p.FISHERINV=function(r){r=t.parseNumber(r);if(r instanceof Error)return r;var e=Math.exp(2*r);return(e-1)/(e+1)};p.FORECAST=function(r,e,a){r=t.parseNumber(r);e=t.parseNumberArray(t.flatten(e));a=t.parseNumberArray(t.flatten(a));if(t.anyIsError(r,e,a))return u.value;var i=n.mean(a);var f=n.mean(e);var o=a.length;var s=0;var l=0;for(var v=0;v<o;v++){s+=(a[v]-i)*(e[v]-f);l+=Math.pow(a[v]-i,2)}var c=s/l;var E=f-c*i;return E+c*r};p.FREQUENCY=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;var n=r.length;var a=e.length;var i=[];for(var f=0;f<=a;f++){i[f]=0;for(var o=0;o<n;o++)0===f?r[o]<=e[0]&&(i[0]+=1):f<a?r[o]>e[f-1]&&r[o]<=e[f]&&(i[f]+=1):f===a&&r[o]>e[a-1]&&(i[a]+=1)}return i};p.GAMMA=function(r){r=t.parseNumber(r);return r instanceof Error?r:0===r||parseInt(r,10)===r&&r<0?u.num:n.gammafn(r)};p.GAMMA.DIST=function(r,e,t,a){return 4!==arguments.length?u.na:r<0||e<=0||t<=0||"number"!==typeof r||"number"!==typeof e||"number"!==typeof t?u.value:a?n.gamma.cdf(r,e,t,true):n.gamma.pdf(r,e,t,false)};p.GAMMA.INV=function(r,e,t){return 3!==arguments.length?u.na:r<0||r>1||e<=0||t<=0?u.num:"number"!==typeof r||"number"!==typeof e||"number"!==typeof t?u.value:n.gamma.inv(r,e,t)};p.GAMMALN=function(r){r=t.parseNumber(r);return r instanceof Error?r:n.gammaln(r)};p.GAMMALN.PRECISE=function(r){return 1!==arguments.length?u.na:r<=0?u.num:"number"!==typeof r?u.value:n.gammaln(r)};p.GAUSS=function(r){r=t.parseNumber(r);return r instanceof Error?r:n.normal.cdf(r,0,1)-.5};p.GEOMEAN=function(){var r=t.parseNumberArray(t.flatten(arguments));return r instanceof Error?r:n.geomean(r)};p.GROWTH=function(r,e,n,a){r=t.parseNumberArray(r);if(r instanceof Error)return r;var i;if(void 0===e){e=[];for(i=1;i<=r.length;i++)e.push(i)}if(void 0===n){n=[];for(i=1;i<=r.length;i++)n.push(i)}e=t.parseNumberArray(e);n=t.parseNumberArray(n);if(t.anyIsError(e,n))return u.value;void 0===a&&(a=true);var f=r.length;var o=0;var s=0;var l=0;var v=0;for(i=0;i<f;i++){var c=e[i];var E=Math.log(r[i]);o+=c;s+=E;l+=c*E;v+=c*c}o/=f;s/=f;l/=f;v/=f;var p;var N;if(a){p=(l-o*s)/(v-o*o);N=s-p*o}else{p=l/v;N=0}var m=[];for(i=0;i<n.length;i++)m.push(Math.exp(N+p*n[i]));return m};p.HARMEAN=function(){var r=t.parseNumberArray(t.flatten(arguments));if(r instanceof Error)return r;var e=r.length;var n=0;for(var a=0;a<e;a++)n+=1/r[a];return e/n};p.HYPGEOM={};p.HYPGEOM.DIST=function(e,n,a,i,f){e=t.parseNumber(e);n=t.parseNumber(n);a=t.parseNumber(a);i=t.parseNumber(i);if(t.anyIsError(e,n,a,i))return u.value;function pdf(e,n,t,a){return r.COMBIN(t,e)*r.COMBIN(a-t,n-e)/r.COMBIN(a,n)}function cdf(r,e,n,t){var a=0;for(var u=0;u<=r;u++)a+=pdf(u,e,n,t);return a}return f?cdf(e,n,a,i):pdf(e,n,a,i)};p.INTERCEPT=function(r,e){r=t.parseNumberArray(r);e=t.parseNumberArray(e);return t.anyIsError(r,e)?u.value:r.length!==e.length?u.na:p.FORECAST(0,r,e)};p.KURT=function(){var r=t.parseNumberArray(t.flatten(arguments));if(r instanceof Error)return r;var e=n.mean(r);var a=r.length;var u=0;for(var i=0;i<a;i++)u+=Math.pow(r[i]-e,4);u/=Math.pow(n.stdev(r,true),4);return a*(a+1)/((a-1)*(a-2)*(a-3))*u-3*(a-1)*(a-1)/((a-2)*(a-3))};p.LARGE=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);return t.anyIsError(r,e)?r:e<0||r.length<e?u.value:r.sort((function(r,e){return e-r}))[e-1]};p.LINEST=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;var a=n.mean(r);var i=n.mean(e);var f=e.length;var o=0;var s=0;for(var l=0;l<f;l++){o+=(e[l]-i)*(r[l]-a);s+=Math.pow(e[l]-i,2)}var v=o/s;var c=a-v*i;return[v,c]};p.LOGEST=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;for(var n=0;n<r.length;n++)r[n]=Math.log(r[n]);var a=p.LINEST(r,e);a[0]=Math.round(1e6*Math.exp(a[0]))/1e6;a[1]=Math.round(1e6*Math.exp(a[1]))/1e6;return a};p.LOGNORM={};p.LOGNORM.DIST=function(r,e,a,i){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:i?n.lognormal.cdf(r,e,a):n.lognormal.pdf(r,e,a)};p.LOGNORM.INV=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:n.lognormal.inv(r,e,a)};p.MAX=function(){var r=t.flatten(arguments);var e=t.anyError.apply(void 0,r);if(e)return e;var n=t.numbers(r);return 0===n.length?0:Math.max.apply(Math,n)};p.MAXA=function(){var r=t.flatten(arguments);var e=t.anyError.apply(void 0,r);if(e)return e;var n=t.arrayValuesToNumbers(r);n=n.map((function(r){return void 0===r||null===r?0:r}));return 0===n.length?0:Math.max.apply(Math,n)};p.MEDIAN=function(){var r=t.flatten(arguments);var e=t.anyError.apply(void 0,r);if(e)return e;var a=t.arrayValuesToNumbers(r);var i=n.median(a);isNaN(i)&&(i=u.num);return i};p.MIN=function(){var r=t.flatten(arguments);var e=t.anyError.apply(void 0,r);if(e)return e;var n=t.numbers(r);return 0===n.length?0:Math.min.apply(Math,n)};p.MINA=function(){var r=t.flatten(arguments);var e=t.anyError.apply(void 0,r);if(e)return e;var n=t.arrayValuesToNumbers(r);n=n.map((function(r){return void 0===r||null===r?0:r}));return 0===n.length?0:Math.min.apply(Math,n)};p.MODE={};p.MODE.MULT=function(){var r=t.parseNumberArray(t.flatten(arguments));if(r instanceof Error)return r;var e=r.length;var n={};var a=[];var u=0;var i;for(var f=0;f<e;f++){i=r[f];n[i]=n[i]?n[i]+1:1;if(n[i]>u){u=n[i];a=[]}n[i]===u&&(a[a.length]=i)}return a};p.MODE.SNGL=function(){var r=t.parseNumberArray(t.flatten(arguments));return r instanceof Error?r:p.MODE.MULT(r).sort((function(r,e){return r-e}))[0]};p.NEGBINOM={};p.NEGBINOM.DIST=function(r,e,a,i){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:i?n.negbin.cdf(r,e,a):n.negbin.pdf(r,e,a)};p.NORM={};p.NORM.DIST=function(r,e,a,i){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:a<=0?u.num:i?n.normal.cdf(r,e,a):n.normal.pdf(r,e,a)};p.NORM.INV=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);a=t.parseNumber(a);return t.anyIsError(r,e,a)?u.value:n.normal.inv(r,e,a)};p.NORM.S={};p.NORM.S.DIST=function(r,e){r=t.parseNumber(r);return r instanceof Error?u.value:e?n.normal.cdf(r,0,1):n.normal.pdf(r,0,1)};p.NORM.S.INV=function(r){r=t.parseNumber(r);return r instanceof Error?u.value:n.normal.inv(r,0,1)};p.PEARSON=function(r,e){e=t.parseNumberArray(t.flatten(e));r=t.parseNumberArray(t.flatten(r));if(t.anyIsError(e,r))return u.value;var a=n.mean(r);var i=n.mean(e);var f=r.length;var o=0;var s=0;var l=0;for(var v=0;v<f;v++){o+=(r[v]-a)*(e[v]-i);s+=Math.pow(r[v]-a,2);l+=Math.pow(e[v]-i,2)}return o/Math.sqrt(s*l)};p.PERCENTILE={};p.PERCENTILE.EXC=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);if(t.anyIsError(r,e))return u.value;r=r.sort((function(r,e){return r-e}));var n=r.length;if(e<1/(n+1)||e>1-1/(n+1))return u.num;var a=e*(n+1)-1;var i=Math.floor(a);return t.cleanFloat(a===i?r[a]:r[i]+(a-i)*(r[i+1]-r[i]))};p.PERCENTILE.INC=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);if(t.anyIsError(r,e))return u.value;r=r.sort((function(r,e){return r-e}));var n=r.length;var a=e*(n-1);var i=Math.floor(a);return t.cleanFloat(a===i?r[a]:r[i]+(a-i)*(r[i+1]-r[i]))};p.PERCENTRANK={};p.PERCENTRANK.EXC=function(r,e,n){n=void 0===n?3:n;r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);n=t.parseNumber(n);if(t.anyIsError(r,e,n))return u.value;r=r.sort((function(r,e){return r-e}));var a=i.UNIQUE.apply(null,r);var f=r.length;var o=a.length;var s=Math.pow(10,n);var l=0;var v=false;var c=0;while(!v&&c<o){if(e===a[c]){l=(r.indexOf(a[c])+1)/(f+1);v=true}else if(e>=a[c]&&(e<a[c+1]||c===o-1)){l=(r.indexOf(a[c])+1+(e-a[c])/(a[c+1]-a[c]))/(f+1);v=true}c++}return Math.floor(l*s)/s};p.PERCENTRANK.INC=function(r,e,n){n=void 0===n?3:n;r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);n=t.parseNumber(n);if(t.anyIsError(r,e,n))return u.value;r=r.sort((function(r,e){return r-e}));var a=i.UNIQUE.apply(null,r);var f=r.length;var o=a.length;var s=Math.pow(10,n);var l=0;var v=false;var c=0;while(!v&&c<o){if(e===a[c]){l=r.indexOf(a[c])/(f-1);v=true}else if(e>=a[c]&&(e<a[c+1]||c===o-1)){l=(r.indexOf(a[c])+(e-a[c])/(a[c+1]-a[c]))/(f-1);v=true}c++}return Math.floor(l*s)/s};p.PERMUT=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?u.value:r.FACT(e)/r.FACT(e-n)};p.PERMUTATIONA=function(r,e){r=t.parseNumber(r);e=t.parseNumber(e);return t.anyIsError(r,e)?u.value:Math.pow(r,e)};p.PHI=function(r){r=t.parseNumber(r);return r instanceof Error?u.value:Math.exp(-.5*r*r)/f};p.POISSON={};p.POISSON.DIST=function(r,e,a){r=t.parseNumber(r);e=t.parseNumber(e);return t.anyIsError(r,e)?u.value:a?n.poisson.cdf(r,e):n.poisson.pdf(r,e)};p.PROB=function(r,e,n,a){if(void 0===n)return 0;a=void 0===a?n:a;r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));n=t.parseNumber(n);a=t.parseNumber(a);if(t.anyIsError(r,e,n,a))return u.value;if(n===a)return r.indexOf(n)>=0?e[r.indexOf(n)]:0;var i=r.sort((function(r,e){return r-e}));var f=i.length;var o=0;for(var s=0;s<f;s++)i[s]>=n&&i[s]<=a&&(o+=e[r.indexOf(i[s])]);return o};p.QUARTILE={};p.QUARTILE.EXC=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);if(t.anyIsError(r,e))return u.value;switch(e){case 1:return p.PERCENTILE.EXC(r,.25);case 2:return p.PERCENTILE.EXC(r,.5);case 3:return p.PERCENTILE.EXC(r,.75);default:return u.num}};p.QUARTILE.INC=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);if(t.anyIsError(r,e))return u.value;switch(e){case 1:return p.PERCENTILE.INC(r,.25);case 2:return p.PERCENTILE.INC(r,.5);case 3:return p.PERCENTILE.INC(r,.75);default:return u.num}};p.RANK={};p.RANK.AVG=function(r,e,n){r=t.parseNumber(r);e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;e=t.flatten(e);n=n||false;var a=n?function(r,e){return r-e}:function(r,e){return e-r};e=e.sort(a);var i=e.length;var f=0;for(var o=0;o<i;o++)e[o]===r&&f++;return f>1?(2*e.indexOf(r)+f+1)/2:e.indexOf(r)+1};p.RANK.EQ=function(r,e,n){r=t.parseNumber(r);e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;n=n||false;var a=n?function(r,e){return r-e}:function(r,e){return e-r};e=e.sort(a);return e.indexOf(r)+1};p.ROW=function(r,e){return 2!==arguments.length?u.na:e<0?u.num:r instanceof Array&&"number"===typeof e?0!==r.length?n.row(r,e):void 0:u.value};p.ROWS=function(r){return 1!==arguments.length?u.na:r instanceof Array?0===r.length?0:n.rows(r):u.value};p.RSQ=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));return t.anyIsError(r,e)?u.value:Math.pow(p.PEARSON(r,e),2)};p.SKEW=function(){var r=t.parseNumberArray(t.flatten(arguments));if(r instanceof Error)return r;var e=n.mean(r);var a=r.length;var u=0;for(var i=0;i<a;i++)u+=Math.pow(r[i]-e,3);return a*u/((a-1)*(a-2)*Math.pow(n.stdev(r,true),3))};p.SKEW.P=function(){var r=t.parseNumberArray(t.flatten(arguments));if(r instanceof Error)return r;var e=n.mean(r);var a=r.length;var u=0;var i=0;for(var f=0;f<a;f++){i+=Math.pow(r[f]-e,3);u+=Math.pow(r[f]-e,2)}i/=a;u/=a;return i/Math.pow(u,1.5)};p.SLOPE=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;var a=n.mean(e);var i=n.mean(r);var f=e.length;var o=0;var s=0;for(var l=0;l<f;l++){o+=(e[l]-a)*(r[l]-i);s+=Math.pow(e[l]-a,2)}return o/s};p.SMALL=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);return t.anyIsError(r,e)?r:r.sort((function(r,e){return r-e}))[e-1]};p.STANDARDIZE=function(r,e,n){r=t.parseNumber(r);e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(r,e,n)?u.value:(r-e)/n};p.STDEV={};p.STDEV.P=function(){var r=p.VAR.P.apply(this||m,arguments);var e=Math.sqrt(r);isNaN(e)&&(e=u.num);return e};p.STDEV.S=function(){var r=p.VAR.S.apply(this||m,arguments);var e=Math.sqrt(r);return e};p.STDEVA=function(){var r=p.VARA.apply(this||m,arguments);var e=Math.sqrt(r);return e};p.STDEVPA=function(){var r=p.VARPA.apply(this||m,arguments);var e=Math.sqrt(r);isNaN(e)&&(e=u.num);return e};p.STEYX=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;var a=n.mean(e);var i=n.mean(r);var f=e.length;var o=0;var s=0;var l=0;for(var v=0;v<f;v++){o+=Math.pow(r[v]-i,2);s+=(e[v]-a)*(r[v]-i);l+=Math.pow(e[v]-a,2)}return Math.sqrt((o-s*s/l)/(f-2))};p.TRANSPOSE=function(r){return r?n.transpose(r):u.na};p.T=e.T;p.T.DIST=function(r,e,n){return 1!==n&&2!==n?u.num:1===n?p.T.DIST.RT(r,e):p.T.DIST["2T"](r,e)};p.T.DIST["2T"]=function(r,e){return 2!==arguments.length?u.na:r<0||e<1?u.num:"number"!==typeof r||"number"!==typeof e?u.value:2*(1-n.studentt.cdf(r,e))};p.T.DIST.RT=function(r,e){return 2!==arguments.length?u.na:r<0||e<1?u.num:"number"!==typeof r||"number"!==typeof e?u.value:1-n.studentt.cdf(r,e)};p.T.INV=function(r,e){r=t.parseNumber(r);e=t.parseNumber(e);return t.anyIsError(r,e)?u.value:n.studentt.inv(r,e)};p.T.INV["2T"]=function(r,e){r=t.parseNumber(r);e=t.parseNumber(e);return r<=0||r>1||e<1?u.num:t.anyIsError(r,e)?u.value:Math.abs(n.studentt.inv(r/2,e))};p.T.TEST=function(r,e){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));if(t.anyIsError(r,e))return u.value;var a=n.mean(r);var i=n.mean(e);var f=0;var o=0;var s;for(s=0;s<r.length;s++)f+=Math.pow(r[s]-a,2);for(s=0;s<e.length;s++)o+=Math.pow(e[s]-i,2);f/=r.length-1;o/=e.length-1;var l=Math.abs(a-i)/Math.sqrt(f/r.length+o/e.length);return p.T.DIST["2T"](l,r.length+e.length-2)};p.TREND=function(r,e,n){r=t.parseNumberArray(t.flatten(r));e=t.parseNumberArray(t.flatten(e));n=t.parseNumberArray(t.flatten(n));if(t.anyIsError(r,e,n))return u.value;var a=p.LINEST(r,e);var i=a[0];var f=a[1];var o=[];n.forEach((function(r){o.push(i*r+f)}));return o};p.TRIMMEAN=function(e,a){e=t.parseNumberArray(t.flatten(e));a=t.parseNumber(a);if(t.anyIsError(e,a))return u.value;var i=r.FLOOR(e.length*a,2)/2;return n.mean(t.initial(t.rest(e.sort((function(r,e){return r-e})),i),i))};p.VAR={};p.VAR.P=function(){var r=t.numbers(t.flatten(arguments));var e=r.length;var n=0;var a=p.AVERAGE(r);var i;for(var f=0;f<e;f++)n+=Math.pow(r[f]-a,2);i=n/e;isNaN(i)&&(i=u.num);return i};p.VAR.S=function(){var r=t.numbers(t.flatten(arguments));var e=r.length;var n=0;var a=p.AVERAGE(r);for(var u=0;u<e;u++)n+=Math.pow(r[u]-a,2);return n/(e-1)};p.VARA=function(){var r=t.flatten(arguments);var e=r.length;var n=0;var a=0;var u=p.AVERAGEA(r);for(var i=0;i<e;i++){var f=r[i];n+="number"===typeof f?Math.pow(f-u,2):true===f?Math.pow(1-u,2):Math.pow(0-u,2);null!==f&&a++}return n/(a-1)};p.VARPA=function(){var r=t.flatten(arguments);var e=r.length;var n=0;var a=0;var i=p.AVERAGEA(r);var f;for(var o=0;o<e;o++){var s=r[o];n+="number"===typeof s?Math.pow(s-i,2):true===s?Math.pow(1-i,2):Math.pow(0-i,2);null!==s&&a++}f=n/a;isNaN(f)&&(f=u.num);return f};p.WEIBULL={};p.WEIBULL.DIST=function(r,e,n,a){r=t.parseNumber(r);e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(r,e,n)?u.value:a?1-Math.exp(-Math.pow(r/n,e)):Math.pow(r,e-1)*Math.exp(-Math.pow(r/n,e))*e/Math.pow(n,e)};p.Z={};p.Z.TEST=function(r,e,n){r=t.parseNumberArray(t.flatten(r));e=t.parseNumber(e);if(t.anyIsError(r,e))return u.value;n=n||p.STDEV.S(r);var a=r.length;return 1-p.NORM.S.DIST((p.AVERAGE(r)-e)/(n/Math.sqrt(a)),true)};return p}var h={},I=false;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$9(){if(I)return h;I=true;var r=dew$f();h.CELL=function(){throw new Error("CELL is not implemented")};h.ERROR={};h.ERROR.TYPE=function(e){switch(e){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na};h.INFO=function(){throw new Error("INFO is not implemented")};h.ISBLANK=function(r){return null===r};h.ISBINARY=function(r){return/^[01]{1,10}$/.test(r)};h.ISERR=function(e){return[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(e)>=0||"number"===typeof e&&(isNaN(e)||!isFinite(e))};h.ISERROR=function(e){return h.ISERR(e)||e===r.na};h.ISEVEN=function(r){return!(1&Math.floor(Math.abs(r)))};h.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")};h.ISLOGICAL=function(r){return true===r||false===r};h.ISNA=function(e){return e===r.na};h.ISNONTEXT=function(r){return"string"!==typeof r};h.ISNUMBER=function(r){return"number"===typeof r&&!isNaN(r)&&isFinite(r)};h.ISODD=function(r){return!!(1&Math.floor(Math.abs(r)))};h.ISREF=function(){throw new Error("ISREF is not implemented")};h.ISTEXT=function(r){return"string"===typeof r};h.N=function(r){return this.ISNUMBER(r)?r:r instanceof Date?r.getTime():true===r?1:false===r?0:this.ISERROR(r)?r:0};h.NA=function(){return r.na};h.SHEET=function(){throw new Error("SHEET is not implemented")};h.SHEETS=function(){throw new Error("SHEETS is not implemented")};h.TYPE=function(r){return this.ISNUMBER(r)?1:this.ISTEXT(r)?2:this.ISLOGICAL(r)?4:this.ISERROR(r)?16:Array.isArray(r)?64:void 0};return h}var g={},M=false;function dew$8(){if(M)return g;M=true;var r=dew$e();var e=dew$f();var n=dew$a();var t=dew$9();var a=dew$c();g.ABS=function(e){e=r.parseNumber(e);if(e instanceof Error)return e;var n=Math.abs(e);return n};g.ACOS=function(n){n=r.parseNumber(n);if(n instanceof Error)return n;var t=Math.acos(n);isNaN(t)&&(t=e.num);return t};g.ACOSH=function(n){n=r.parseNumber(n);if(n instanceof Error)return n;var t=Math.log(n+Math.sqrt(n*n-1));isNaN(t)&&(t=e.num);return t};g.ACOT=function(e){e=r.parseNumber(e);if(e instanceof Error)return e;var n=Math.atan(1/e);return n};g.ACOTH=function(n){n=r.parseNumber(n);if(n instanceof Error)return n;var t=.5*Math.log((n+1)/(n-1));isNaN(t)&&(t=e.num);return t};g.AGGREGATE=function(t,a,u,i){t=r.parseNumber(t);a=r.parseNumber(t);if(r.anyIsError(t,a))return e.value;switch(t){case 1:return n.AVERAGE(u);case 2:return n.COUNT(u);case 3:return n.COUNTA(u);case 4:return n.MAX(u);case 5:return n.MIN(u);case 6:return g.PRODUCT(u);case 7:return n.STDEV.S(u);case 8:return n.STDEV.P(u);case 9:return g.SUM(u);case 10:return n.VAR.S(u);case 11:return n.VAR.P(u);case 12:return n.MEDIAN(u);case 13:return n.MODE.SNGL(u);case 14:return n.LARGE(u,i);case 15:return n.SMALL(u,i);case 16:return n.PERCENTILE.INC(u,i);case 17:return n.QUARTILE.INC(u,i);case 18:return n.PERCENTILE.EXC(u,i);case 19:return n.QUARTILE.EXC(u,i)}};g.ARABIC=function(r){if(void 0===r||null===r)return 0;if(r instanceof Error)return r;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))return e.value;var n=0;r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(r){n+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}));return n};g.ASIN=function(n){n=r.parseNumber(n);if(n instanceof Error)return n;var t=Math.asin(n);isNaN(t)&&(t=e.num);return t};g.ASINH=function(e){e=r.parseNumber(e);return e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))};g.ATAN=function(e){e=r.parseNumber(e);return e instanceof Error?e:Math.atan(e)};g.ATAN2=function(e,n){e=r.parseNumber(e);n=r.parseNumber(n);var t=r.anyError(e,n);return t||Math.atan2(e,n)};g.ATANH=function(n){n=r.parseNumber(n);if(n instanceof Error)return n;var t=Math.log((1+n)/(1-n))/2;isNaN(t)&&(t=e.num);return t};g.BASE=function(n,t,a){n=r.parseNumber(n);t=r.parseNumber(t);a=r.parseNumber(a);var u=r.anyError(n,t,a);if(u)return u;if(0===t)return e.num;var i=n.toString(t);return new Array(Math.max(a+1-i.length,0)).join("0")+i};g.CEILING=function(e,n,t){e=r.parseNumber(e);n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(e,n,t);if(a)return a;if(0===n)return 0;n=Math.abs(n);var u=-Math.floor(Math.log(n)/Math.log(10));return e>=0?g.ROUND(Math.ceil(e/n)*n,u):0===t?-g.ROUND(Math.floor(Math.abs(e)/n)*n,u):-g.ROUND(Math.ceil(Math.abs(e)/n)*n,u)};g.CEILING.MATH=g.CEILING;g.CEILING.PRECISE=g.CEILING;g.COMBIN=function(n,t){n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||(n<t?e.num:g.FACT(n)/(g.FACT(t)*g.FACT(n-t)))};g.COMBINA=function(n,t){n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||(n<t?e.num:0===n&&0===t?1:g.COMBIN(n+t-1,n-1))};g.COS=function(e){e=r.parseNumber(e);return e instanceof Error?e:Math.cos(e)};g.COSH=function(e){e=r.parseNumber(e);return e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2};g.COT=function(n){n=r.parseNumber(n);return n instanceof Error?n:0===n?e.div0:1/Math.tan(n)};g.COTH=function(n){n=r.parseNumber(n);if(n instanceof Error)return n;if(0===n)return e.div0;var t=Math.exp(2*n);return(t+1)/(t-1)};g.CSC=function(n){n=r.parseNumber(n);return n instanceof Error?n:0===n?e.div0:1/Math.sin(n)};g.CSCH=function(n){n=r.parseNumber(n);return n instanceof Error?n:0===n?e.div0:2/(Math.exp(n)-Math.exp(-n))};g.DECIMAL=function(n,t){if(arguments.length<1)return e.value;n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||(0===t?e.num:parseInt(n,t))};g.DEGREES=function(e){e=r.parseNumber(e);return e instanceof Error?e:180*e/Math.PI};g.EVEN=function(e){e=r.parseNumber(e);return e instanceof Error?e:g.CEILING(e,-2,-1)};g.EXP=function(n){if(arguments.length<1)return e.na;if(arguments.length>1)return e.error;n=r.parseNumber(n);if(n instanceof Error)return n;n=Math.exp(n);return n};var u=[];g.FACT=function(e){e=r.parseNumber(e);if(e instanceof Error)return e;var n=Math.floor(e);if(0===n||1===n)return 1;if(u[n]>0)return u[n];u[n]=g.FACT(n-1)*n;return u[n]};g.FACTDOUBLE=function(e){e=r.parseNumber(e);if(e instanceof Error)return e;var n=Math.floor(e);return n<=0?1:n*g.FACTDOUBLE(n-2)};g.FLOOR=function(n,t){n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);if(a)return a;if(0===t)return 0;if(!(n>=0&&t>0)&&!(n<=0&&t<0))return e.num;t=Math.abs(t);var u=-Math.floor(Math.log(t)/Math.log(10));return n>=0?g.ROUND(Math.floor(n/t)*t,u):-g.ROUND(Math.ceil(Math.abs(n)/t),u)};g.FLOOR.MATH=function(e,n,t){if(n instanceof Error)return n;n=void 0===n?0:n;e=r.parseNumber(e);n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(e,n,t);if(a)return a;if(0===n)return 0;n=n?Math.abs(n):1;var u=-Math.floor(Math.log(n)/Math.log(10));return e>=0?g.ROUND(Math.floor(e/n)*n,u):0===t||void 0===t?-g.ROUND(Math.ceil(Math.abs(e)/n)*n,u):-g.ROUND(Math.floor(Math.abs(e)/n)*n,u)};g.FLOOR.PRECISE=g.FLOOR.MATH;g.GCD=function(){var e=r.parseNumberArray(r.flatten(arguments));if(e instanceof Error)return e;var n=e.length;var t=e[0];var a=t<0?-t:t;for(var u=1;u<n;u++){var i=e[u];var f=i<0?-i:i;while(a&&f)a>f?a%=f:f%=a;a+=f}return a};g.INT=function(e){e=r.parseNumber(e);return e instanceof Error?e:Math.floor(e)};g.ISO={CEILING:g.CEILING};g.LCM=function(){var e=r.parseNumberArray(r.flatten(arguments));if(e instanceof Error)return e;for(var n,t,a,u,i=1;void 0!==(a=e.pop());){if(0===a)return 0;while(a>1){if(a%2){for(n=3,t=Math.floor(Math.sqrt(a));n<=t&&a%n;n+=2);u=n<=t?n:a}else u=2;for(a/=u,i*=u,n=e.length;n;e[--n]%u===0&&1===(e[n]/=u)&&e.splice(n,1));}}return i};g.LN=function(n){n=r.parseNumber(n);return n instanceof Error?n:0===n?e.num:Math.log(n)};g.LN10=function(){return Math.log(10)};g.LN2=function(){return Math.log(2)};g.LOG10E=function(){return Math.LOG10E};g.LOG2E=function(){return Math.LOG2E};g.LOG=function(n,t){n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||(0===n||0===t?e.num:Math.log(n)/Math.log(t))};g.LOG10=function(n){n=r.parseNumber(n);return n instanceof Error?n:0===n?e.num:Math.log(n)/Math.log(10)};g.MOD=function(n,t){n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);if(a)return a;if(0===t)return e.div0;var u=Math.abs(n%t);u=n<0?t-u:u;return t>0?u:-u};g.MROUND=function(n,t){n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||(n*t===0?0:n*t<0?e.num:Math.round(n/t)*t)};g.MULTINOMIAL=function(){var e=r.parseNumberArray(r.flatten(arguments));if(e instanceof Error)return e;var n=0;var t=1;for(var a=0;a<e.length;a++){n+=e[a];t*=g.FACT(e[a])}return g.FACT(n)/t};g.ODD=function(e){e=r.parseNumber(e);if(e instanceof Error)return e;var n=Math.ceil(Math.abs(e));n=1&n?n:n+1;return e>=0?n:-n};g.PI=function(){return Math.PI};g.E=function(){return Math.E};g.POWER=function(n,t){n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);if(a)return a;if(0===n&&0===t)return e.num;var u=Math.pow(n,t);return isNaN(u)?e.num:u};g.PRODUCT=function(){var e=r.flatten(arguments);var n=e.filter((function(r){return void 0!==r&&null!==r}));if(0===n.length)return 0;var t=r.parseNumberArray(n);if(t instanceof Error)return t;var a=1;for(var u=0;u<t.length;u++)a*=t[u];return a};g.QUOTIENT=function(e,n){e=r.parseNumber(e);n=r.parseNumber(n);var t=r.anyError(e,n);return t||parseInt(e/n,10)};g.RADIANS=function(e){e=r.parseNumber(e);return e instanceof Error?e:e*Math.PI/180};g.RAND=function(){return Math.random()};g.RANDBETWEEN=function(e,n){e=r.parseNumber(e);n=r.parseNumber(n);var t=r.anyError(e,n);return t||e+Math.ceil((n-e+1)*Math.random())-1};g.ROMAN=function(e){e=r.parseNumber(e);if(e instanceof Error)return e;var n=String(e).split("");var t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];var a="";var u=3;while(u--)a=(t[+n.pop()+10*u]||"")+a;return new Array(+n.join("")+1).join("M")+a};g.ROUND=function(e,n){e=r.parseNumber(e);n=r.parseNumber(n);var t=r.anyError(e,n);return t||Math.round(e*Math.pow(10,n))/Math.pow(10,n)};g.ROUNDDOWN=function(e,n){e=r.parseNumber(e);n=r.parseNumber(n);var t=r.anyError(e,n);if(t)return t;var a=e>0?1:-1;return a*Math.floor(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)};g.ROUNDUP=function(e,n){e=r.parseNumber(e);n=r.parseNumber(n);var t=r.anyError(e,n);if(t)return t;var a=e>0?1:-1;return a*Math.ceil(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)};g.SEC=function(e){e=r.parseNumber(e);return e instanceof Error?e:1/Math.cos(e)};g.SECH=function(e){e=r.parseNumber(e);return e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))};g.SERIESSUM=function(n,t,a,u){n=r.parseNumber(n);t=r.parseNumber(t);a=r.parseNumber(a);u=r.parseNumberArray(u);if(r.anyIsError(n,t,a,u))return e.value;var i=u[0]*Math.pow(n,t);for(var f=1;f<u.length;f++)i+=u[f]*Math.pow(n,t+f*a);return i};g.SIGN=function(e){e=r.parseNumber(e);return e instanceof Error?e:e<0?-1:0===e?0:1};g.SIN=function(e){e=r.parseNumber(e);return e instanceof Error?e:Math.sin(e)};g.SINH=function(e){e=r.parseNumber(e);return e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2};g.SQRT=function(n){n=r.parseNumber(n);return n instanceof Error?n:n<0?e.num:Math.sqrt(n)};g.SQRTPI=function(e){e=r.parseNumber(e);return e instanceof Error?e:Math.sqrt(e*Math.PI)};g.SQRT1_2=function(){return 1/Math.sqrt(2)};g.SQRT2=function(){return Math.sqrt(2)};g.SUBTOTAL=function(e,t){e=r.parseNumber(e);if(e instanceof Error)return e;switch(e){case 1:return n.AVERAGE(t);case 2:return n.COUNT(t);case 3:return n.COUNTA(t);case 4:return n.MAX(t);case 5:return n.MIN(t);case 6:return g.PRODUCT(t);case 7:return n.STDEV.S(t);case 8:return n.STDEV.P(t);case 9:return g.SUM(t);case 10:return n.VAR.S(t);case 11:return n.VAR.P(t);case 101:return n.AVERAGE(t);case 102:return n.COUNT(t);case 103:return n.COUNTA(t);case 104:return n.MAX(t);case 105:return n.MIN(t);case 106:return g.PRODUCT(t);case 107:return n.STDEV.S(t);case 108:return n.STDEV.P(t);case 109:return g.SUM(t);case 110:return n.VAR.S(t);case 111:return n.VAR.P(t)}};g.ADD=function(n,t){if(2!==arguments.length)return e.na;n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||n+t};g.MINUS=function(n,t){if(2!==arguments.length)return e.na;n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||n-t};g.DIVIDE=function(n,t){if(2!==arguments.length)return e.na;n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||(0===t?e.div0:n/t)};g.MULTIPLY=function(n,t){if(2!==arguments.length)return e.na;n=r.parseNumber(n);t=r.parseNumber(t);var a=r.anyError(n,t);return a||n*t};g.GT=function(n,t){if(2!==arguments.length)return e.na;if(n instanceof Error)return n;if(t instanceof Error)return t;if(r.anyIsString(n,t)){n=r.parseString(n);t=r.parseString(t)}else{n=r.parseNumber(n);t=r.parseNumber(t)}var a=r.anyError(n,t);return a||n>t};g.GTE=function(n,t){if(2!==arguments.length)return e.na;if(r.anyIsString(n,t)){n=r.parseString(n);t=r.parseString(t)}else{n=r.parseNumber(n);t=r.parseNumber(t)}var a=r.anyError(n,t);return a||n>=t};g.LT=function(n,t){if(2!==arguments.length)return e.na;if(r.anyIsString(n,t)){n=r.parseString(n);t=r.parseString(t)}else{n=r.parseNumber(n);t=r.parseNumber(t)}var a=r.anyError(n,t);return a||n<t};g.LTE=function(n,t){if(2!==arguments.length)return e.na;if(r.anyIsString(n,t)){n=r.parseString(n);t=r.parseString(t)}else{n=r.parseNumber(n);t=r.parseNumber(t)}var a=r.anyError(n,t);return a||n<=t};g.EQ=function(r,n){if(2!==arguments.length)return e.na;if(r instanceof Error)return r;if(n instanceof Error)return n;null===r&&(r=void 0);null===n&&(n=void 0);return r===n};g.NE=function(r,n){if(2!==arguments.length)return e.na;if(r instanceof Error)return r;if(n instanceof Error)return n;null===r&&(r=void 0);null===n&&(n=void 0);return r!==n};g.POW=function(r,n){return 2!==arguments.length?e.na:g.POWER(r,n)};g.SUM=function(){var e=0;r.arrayEach(r.argsToArray(arguments),(function(r){if(e instanceof Error)return false;if(r instanceof Error)e=r;else if("number"===typeof r)e+=r;else if("string"===typeof r){var n=parseFloat(r);!isNaN(n)&&(e+=n)}else if(Array.isArray(r)){var t=g.SUM.apply(null,r);t instanceof Error?e=t:e+=t}}));return e};g.SUMIF=function(e,n,t){e=r.flatten(e);t=t?r.flatten(t):e;if(e instanceof Error)return e;if(void 0===n||null===n||n instanceof Error)return 0;var u=0;var i="*"===n;var f=i?null:a.parse(n+"");for(var o=0;o<e.length;o++){var s=e[o];var l=t[o];if(i)u+=s;else{var v=[a.createToken(s,a.TOKEN_TYPE_LITERAL)].concat(f);u+=a.compute(v)?l:0}}return u};g.SUMIFS=function(){var e=r.argsToArray(arguments);var n=r.parseNumberArray(r.flatten(e.shift()));if(n instanceof Error)return n;var t=e;var u=t.length/2;for(var i=0;i<u;i++)t[2*i]=r.flatten(t[2*i]);var f=0;for(i=0;i<n.length;i++){var o=false;for(var s=0;s<u;s++){var l=t[2*s][i];var v=t[2*s+1];var c=void 0===v||"*"===v;var E=false;if(c)E=true;else{var p=a.parse(v+"");var N=[a.createToken(l,a.TOKEN_TYPE_LITERAL)].concat(p);E=a.compute(N)}if(!E){o=false;break}o=true}o&&(f+=n[i])}return f};g.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return e.value;var n=arguments.length+1;var t=0;var a;var u;var i;var f;for(var o=0;o<arguments[0].length;o++)if(arguments[0][o]instanceof Array)for(var s=0;s<arguments[0][o].length;s++){a=1;for(u=1;u<n;u++){var l=arguments[u-1][o][s];if(l instanceof Error)return l;f=r.parseNumber(l);if(f instanceof Error)return f;a*=f}t+=a}else{a=1;for(u=1;u<n;u++){var v=arguments[u-1][o];if(v instanceof Error)return v;i=r.parseNumber(v);if(i instanceof Error)return i;a*=i}t+=a}return t};g.SUMSQ=function(){var e=r.parseNumberArray(r.flatten(arguments));if(e instanceof Error)return e;var n=0;var a=e.length;for(var u=0;u<a;u++)n+=t.ISNUMBER(e[u])?e[u]*e[u]:0;return n};g.SUMX2MY2=function(n,t){n=r.parseNumberArray(r.flatten(n));t=r.parseNumberArray(r.flatten(t));if(r.anyIsError(n,t))return e.value;var a=0;for(var u=0;u<n.length;u++)a+=n[u]*n[u]-t[u]*t[u];return a};g.SUMX2PY2=function(n,t){n=r.parseNumberArray(r.flatten(n));t=r.parseNumberArray(r.flatten(t));if(r.anyIsError(n,t))return e.value;var a=0;n=r.parseNumberArray(r.flatten(n));t=r.parseNumberArray(r.flatten(t));for(var u=0;u<n.length;u++)a+=n[u]*n[u]+t[u]*t[u];return a};g.SUMXMY2=function(n,t){n=r.parseNumberArray(r.flatten(n));t=r.parseNumberArray(r.flatten(t));if(r.anyIsError(n,t))return e.value;var a=0;n=r.flatten(n);t=r.flatten(t);for(var u=0;u<n.length;u++)a+=Math.pow(n[u]-t[u],2);return a};g.TAN=function(e){e=r.parseNumber(e);return e instanceof Error?e:Math.tan(e)};g.TANH=function(e){e=r.parseNumber(e);if(e instanceof Error)return e;var n=Math.exp(2*e);return(n-1)/(n+1)};g.TRUNC=function(e,n){e=r.parseNumber(e);n=r.parseNumber(n);var t=r.anyError(e,n);if(t)return t;var a=e>0?1:-1;return a*Math.floor(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)};return g}var b="default"in r?r.default:r;var A="default"in e?e.default:e;var y={},T=false;"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$7(){if(T)return y;T=true;var r=dew$f();var e=b;var n=dew$d();var t=dew$e();var a=A;function isValidBinaryNumber(r){return/^[01]{1,10}$/.test(r)}y.BESSELI=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:a.besseli(e,n)};y.BESSELJ=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:a.besselj(e,n)};y.BESSELK=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:a.besselk(e,n)};y.BESSELY=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:a.bessely(e,n)};y.BIN2DEC=function(e){if(!isValidBinaryNumber(e))return r.num;var n=parseInt(e,2);var t=e.toString();return 10===t.length&&"1"===t.substring(0,1)?parseInt(t.substring(1),2)-512:n};y.BIN2HEX=function(e,t){if(!isValidBinaryNumber(e))return r.num;var a=e.toString();if(10===a.length&&"1"===a.substring(0,1))return(0xfffffffe00+parseInt(a.substring(1),2)).toString(16);var u=parseInt(e,2).toString(16);if(void 0===t)return u;if(isNaN(t))return r.value;if(t<0)return r.num;t=Math.floor(t);return t>=u.length?n.REPT("0",t-u.length)+u:r.num};y.BIN2OCT=function(e,t){if(!isValidBinaryNumber(e))return r.num;var a=e.toString();if(10===a.length&&"1"===a.substring(0,1))return(1073741312+parseInt(a.substring(1),2)).toString(8);var u=parseInt(e,2).toString(8);if(void 0===t)return u;if(isNaN(t))return r.value;if(t<0)return r.num;t=Math.floor(t);return t>=u.length?n.REPT("0",t-u.length)+u:r.num};y.BITAND=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?r.num:e&n};y.BITLSHIFT=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(n)>53?r.num:n>=0?e<<n:e>>-n};y.BITOR=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?r.num:e|n};y.BITRSHIFT=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(n)>53?r.num:n>=0?e>>n:e<<-n};y.BITXOR=function(e,n){e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?r.num:e^n};y.COMPLEX=function(e,n,a){e=t.parseNumber(e);n=t.parseNumber(n);if(t.anyIsError(e,n))return e;a=void 0===a?"i":a;if("i"!==a&&"j"!==a)return r.value;if(0===e&&0===n)return 0;if(0===e)return 1===n?a:n.toString()+a;if(0===n)return e.toString();var u=n>0?"+":"";return e.toString()+u+(1===n?a:n.toString()+a)};y.CONVERT=function(e,n,a){e=t.parseNumber(e);if(e instanceof Error)return e;var u=[["a.u. of action","?",null,"action",false,false,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",false,false,160217653141414e-33],["a.u. of energy","Eh",null,"energy",false,false,435974417757576e-32],["a.u. of length","a?",null,"length",false,false,529177210818182e-25],["a.u. of mass","m?",null,"mass",false,false,910938261616162e-45],["a.u. of time","?/Eh",null,"time",false,false,241888432650516e-31],["admiralty knot","admkn",null,"speed",false,true,.514773333],["ampere","A",null,"electric_current",true,false,1],["ampere per meter","A/m",null,"magnetic_field_intensity",true,false,1],["ngstrm","",["ang"],"length",false,true,1e-10],["are","ar",null,"area",false,true,100],["astronomical unit","ua",null,"length",false,false,149597870691667e-25],["bar","bar",null,"pressure",false,false,1e5],["barn","b",null,"area",false,false,1e-28],["becquerel","Bq",null,"radioactivity",true,false,1],["bit","bit",["b"],"information",false,true,1],["btu","BTU",["btu"],"energy",false,true,1055.05585262],["byte","byte",null,"information",false,true,8],["candela","cd",null,"luminous_intensity",true,false,1],["candela per square metre","cd/m?",null,"luminance",true,false,1],["coulomb","C",null,"electric_charge",true,false,1],["cubic ngstrm","ang3",["ang^3"],"volume",false,true,1e-30],["cubic foot","ft3",["ft^3"],"volume",false,true,.028316846592],["cubic inch","in3",["in^3"],"volume",false,true,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",false,true,846786664623715e-61],["cubic metre","m?",null,"volume",true,true,1],["cubic mile","mi3",["mi^3"],"volume",false,true,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",false,true,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",false,true,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",false,true,.764554857984],["cup","cup",null,"volume",false,true,.0002365882365],["dalton","Da",["u"],"mass",false,false,166053886282828e-41],["day","d",["day"],"time",false,true,86400],["degree","",null,"angle",false,false,.0174532925199433],["degrees Rankine","Rank",null,"temperature",false,true,.555555555555556],["dyne","dyn",["dy"],"force",false,true,1e-5],["electronvolt","eV",["ev"],"energy",false,true,1.60217656514141],["ell","ell",null,"length",false,true,1.143],["erg","erg",["e"],"energy",false,true,1e-7],["farad","F",null,"electric_capacitance",true,false,1],["fluid ounce","oz",null,"volume",false,true,295735295625e-16],["foot","ft",null,"length",false,true,.3048],["foot-pound","flb",null,"energy",false,true,1.3558179483314],["gal","Gal",null,"acceleration",false,false,.01],["gallon","gal",null,"volume",false,true,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",false,true,1],["grain","grain",null,"mass",false,true,647989e-10],["gram","g",null,"mass",false,true,.001],["gray","Gy",null,"absorbed_dose",true,false,1],["gross registered ton","GRT",["regton"],"volume",false,true,2.8316846592],["hectare","ha",null,"area",false,true,1e4],["henry","H",null,"inductance",true,false,1],["hertz","Hz",null,"frequency",true,false,1],["horsepower","HP",["h"],"power",false,true,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",false,true,2684519.538],["hour","h",["hr"],"time",false,true,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",false,true,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",false,true,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",false,true,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",false,true,1016.046909],["inch","in",null,"length",false,true,.0254],["international acre","uk_acre",null,"area",false,true,4046.8564224],["IT calorie","cal",null,"energy",false,true,4.1868],["joule","J",null,"energy",true,true,1],["katal","kat",null,"catalytic_activity",true,false,1],["kelvin","K",["kel"],"temperature",true,true,1],["kilogram","kg",null,"mass",true,true,1],["knot","kn",null,"speed",false,true,.514444444444444],["light-year","ly",null,"length",false,true,9460730472580800],["litre","L",["l","lt"],"volume",false,true,.001],["lumen","lm",null,"luminous_flux",true,false,1],["lux","lx",null,"illuminance",true,false,1],["maxwell","Mx",null,"magnetic_flux",false,false,1e-18],["measurement ton","MTON",null,"volume",false,true,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",false,true,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",true,true,1],["meter per second squared","m?s??",null,"acceleration",true,false,1],["parsec","pc",["parsec"],"length",false,true,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",true,false,1],["metre","m",null,"length",true,true,1],["miles per hour","mph",null,"speed",false,true,.44704],["millimetre of mercury","mmHg",null,"pressure",false,false,133.322],["minute","?",null,"angle",false,false,.000290888208665722],["minute","min",["mn"],"time",false,true,60],["modern teaspoon","tspm",null,"volume",false,true,5e-6],["mole","mol",null,"amount_of_substance",true,false,1],["morgen","Morgen",null,"area",false,true,2500],["n.u. of action","?",null,"action",false,false,105457168181818e-48],["n.u. of mass","m?",null,"mass",false,false,910938261616162e-45],["n.u. of speed","c?",null,"speed",false,false,299792458],["n.u. of time","?/(me?c??)",null,"time",false,false,128808866778687e-35],["nautical mile","M",["Nmi"],"length",false,true,1852],["newton","N",null,"force",true,true,1],["rsted","Oe ",null,"magnetic_field_intensity",false,false,79.5774715459477],["ohm","",null,"electric_resistance",true,false,1],["ounce mass","ozm",null,"mass",false,true,.028349523125],["pascal","Pa",null,"pressure",true,false,1],["pascal second","Pa?s",null,"dynamic_viscosity",true,false,1],["pferdestrke","PS",null,"power",false,true,735.49875],["phot","ph",null,"illuminance",false,false,1e-4],["pica (1/6 inch)","pica",null,"length",false,true,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",false,true,.00423333333333333],["poise","P",null,"dynamic_viscosity",false,false,.1],["pond","pond",null,"force",false,true,.00980665],["pound force","lbf",null,"force",false,true,4.4482216152605],["pound mass","lbm",null,"mass",false,true,.45359237],["quart","qt",null,"volume",false,true,.000946352946],["radian","rad",null,"angle",true,false,1],["second","?",null,"angle",false,false,484813681109536e-20],["second","s",["sec"],"time",true,true,1],["short hundredweight","cwt",["shweight"],"mass",false,true,45.359237],["siemens","S",null,"electrical_conductance",true,false,1],["sievert","Sv",null,"equivalent_dose",true,false,1],["slug","sg",null,"mass",false,true,14.59390294],["square ngstrm","ang2",["ang^2"],"area",false,true,1e-20],["square foot","ft2",["ft^2"],"area",false,true,.09290304],["square inch","in2",["in^2"],"area",false,true,64516e-8],["square light-year","ly2",["ly^2"],"area",false,true,895054210748189e17],["square meter","m?",null,"area",true,true,1],["square mile","mi2",["mi^2"],"area",false,true,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",false,true,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",false,true,1792111111111e-17],["square yard","yd2",["yd^2"],"area",false,true,.83612736],["statute mile","mi",null,"length",false,true,1609.344],["steradian","sr",null,"solid_angle",true,false,1],["stilb","sb",null,"luminance",false,false,1e-4],["stokes","St",null,"kinematic_viscosity",false,false,1e-4],["stone","stone",null,"mass",false,true,6.35029318],["tablespoon","tbs",null,"volume",false,true,147868e-10],["teaspoon","tsp",null,"volume",false,true,492892e-11],["tesla","T",null,"magnetic_flux_density",true,true,1],["thermodynamic calorie","c",null,"energy",false,true,4.184],["ton","ton",null,"mass",false,true,907.18474],["tonne","t",null,"mass",false,false,1e3],["U.K. pint","uk_pt",null,"volume",false,true,.00056826125],["U.S. bushel","bushel",null,"volume",false,true,.03523907],["U.S. oil barrel","barrel",null,"volume",false,true,.158987295],["U.S. pint","pt",["us_pt"],"volume",false,true,.000473176473],["U.S. survey mile","survey_mi",null,"length",false,true,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",false,true,4046.87261],["volt","V",null,"voltage",true,false,1],["watt","W",null,"power",true,true,1],["watt-hour","Wh",["wh"],"energy",false,true,3600],["weber","Wb",null,"magnetic_flux",true,false,1],["yard","yd",null,"length",false,true,.9144],["year","yr",null,"time",false,true,31557600]];var i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]};var f={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};var o=null;var s=null;var l=n;var v=a;var c=1;var E=1;var p;for(var N=0;N<u.length;N++){p=null===u[N][2]?[]:u[N][2];(u[N][1]===l||p.indexOf(l)>=0)&&(o=u[N]);(u[N][1]===v||p.indexOf(v)>=0)&&(s=u[N])}if(null===o){var m=i[n.substring(0,2)];var h=f[n.substring(0,1)];"da"===n.substring(0,2)&&(h=["dekao",10,"da"]);if(m){c=m[2];l=n.substring(2)}else if(h){c=h[1];l=n.substring(h[2].length)}for(var I=0;I<u.length;I++){p=null===u[I][2]?[]:u[I][2];(u[I][1]===l||p.indexOf(l)>=0)&&(o=u[I])}}if(null===s){var g=i[a.substring(0,2)];var M=f[a.substring(0,1)];"da"===a.substring(0,2)&&(M=["dekao",10,"da"]);if(g){E=g[2];v=a.substring(2)}else if(M){E=M[1];v=a.substring(M[2].length)}for(var b=0;b<u.length;b++){p=null===u[b][2]?[]:u[b][2];(u[b][1]===v||p.indexOf(v)>=0)&&(s=u[b])}}return null===o||null===s||o[3]!==s[3]?r.na:e*o[6]*c/(s[6]*E)};y.DEC2BIN=function(e,a){e=t.parseNumber(e);if(e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return r.num;if(e<0)return"1"+n.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var u=parseInt(e,10).toString(2);if("undefined"===typeof a)return u;if(isNaN(a))return r.value;if(a<0)return r.num;a=Math.floor(a);return a>=u.length?n.REPT("0",a-u.length)+u:r.num};y.DEC2HEX=function(e,a){e=t.parseNumber(e);if(e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return r.num;if(e<0)return(1099511627776+e).toString(16);var u=parseInt(e,10).toString(16);if("undefined"===typeof a)return u;if(isNaN(a))return r.value;if(a<0)return r.num;a=Math.floor(a);return a>=u.length?n.REPT("0",a-u.length)+u:r.num};y.DEC2OCT=function(e,a){e=t.parseNumber(e);if(e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return r.num;if(e<0)return(1073741824+e).toString(8);var u=parseInt(e,10).toString(8);if("undefined"===typeof a)return u;if(isNaN(a))return r.value;if(a<0)return r.num;a=Math.floor(a);return a>=u.length?n.REPT("0",a-u.length)+u:r.num};y.DELTA=function(e,n){n=void 0===n?0:n;e=t.parseNumber(e);n=t.parseNumber(n);return t.anyIsError(e,n)?r.value:e===n?1:0};y.ERF=function(n,a){a=void 0===a?0:a;n=t.parseNumber(n);a=t.parseNumber(a);return t.anyIsError(n,a)?r.value:e.erf(n)};y.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")};y.ERFC=function(n){return isNaN(n)?r.value:e.erfc(n)};y.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")};y.GESTEP=function(r,e){e=e||0;r=t.parseNumber(r);return t.anyIsError(e,r)?r:r>=e?1:0};y.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return r.num;var a=10===e.length&&"f"===e.substring(0,1).toLowerCase();var u=a?parseInt(e,16)-1099511627776:parseInt(e,16);if(u<-512||u>511)return r.num;if(a)return"1"+n.REPT("0",9-(512+u).toString(2).length)+(512+u).toString(2);var i=u.toString(2);if(void 0===t)return i;if(isNaN(t))return r.value;if(t<0)return r.num;t=Math.floor(t);return t>=i.length?n.REPT("0",t-i.length)+i:r.num};y.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return r.num;var n=parseInt(e,16);return n>=549755813888?n-1099511627776:n};y.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return r.num;var a=parseInt(e,16);if(a>536870911&&a<0xffe0000000)return r.num;if(a>=0xffe0000000)return(a-0xffc0000000).toString(8);var u=a.toString(8);if(void 0===t)return u;if(isNaN(t))return r.value;if(t<0)return r.num;t=Math.floor(t);return t>=u.length?n.REPT("0",t-u.length)+u:r.num};y.IMABS=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.value:Math.sqrt(Math.pow(n,2)+Math.pow(a,2))};y.IMAGINARY=function(e){if(void 0===e||true===e||false===e)return r.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;e+="";e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var n=e.indexOf("+");var t=e.indexOf("-");0===n&&(n=e.indexOf("+",1));0===t&&(t=e.indexOf("-",1));var a=e.substring(e.length-1,e.length);var u="i"===a||"j"===a;return n>=0||t>=0?u?n>=0?isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?r.num:Number(e.substring(n+1,e.length-1)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?r.num:-Number(e.substring(t+1,e.length-1)):r.num:u?isNaN(e.substring(0,e.length-1))?r.num:e.substring(0,e.length-1):isNaN(e)?r.num:0};y.IMARGUMENT=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.value:0===n&&0===a?r.div0:0===n&&a>0?Math.PI/2:0===n&&a<0?-Math.PI/2:0===a&&n>0?0:0===a&&n<0?-Math.PI:n>0?Math.atan(a/n):n<0&&a>=0?Math.atan(a/n)+Math.PI:Math.atan(a/n)-Math.PI};y.IMCONJUGATE=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return 0!==a?y.COMPLEX(n,-a,u):e};y.IMCOS=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return y.COMPLEX(Math.cos(n)*(Math.exp(a)+Math.exp(-a))/2,-Math.sin(n)*(Math.exp(a)-Math.exp(-a))/2,u)};y.IMCOSH=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return y.COMPLEX(Math.cos(a)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(a)*(Math.exp(n)-Math.exp(-n))/2,u)};y.IMCOT=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.value:y.IMDIV(y.IMCOS(e),y.IMSIN(e))};y.IMDIV=function(e,n){var a=y.IMREAL(e);var u=y.IMAGINARY(e);var i=y.IMREAL(n);var f=y.IMAGINARY(n);if(t.anyIsError(a,u,i,f))return r.value;var o=e.substring(e.length-1);var s=n.substring(n.length-1);var l="i";("j"===o||"j"===s)&&(l="j");if(0===i&&0===f)return r.num;var v=i*i+f*f;return y.COMPLEX((a*i+u*f)/v,(u*i-a*f)/v,l)};y.IMEXP=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";var i=Math.exp(n);return y.COMPLEX(i*Math.cos(a),i*Math.sin(a),u)};y.IMLN=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return y.COMPLEX(Math.log(Math.sqrt(n*n+a*a)),Math.atan(a/n),u)};y.IMLOG10=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return y.COMPLEX(Math.log(Math.sqrt(n*n+a*a))/Math.log(10),Math.atan(a/n)/Math.log(10),u)};y.IMLOG2=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return y.COMPLEX(Math.log(Math.sqrt(n*n+a*a))/Math.log(2),Math.atan(a/n)/Math.log(2),u)};y.IMPOWER=function(e,n){n=t.parseNumber(n);var a=y.IMREAL(e);var u=y.IMAGINARY(e);if(t.anyIsError(n,a,u))return r.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var f=Math.pow(y.IMABS(e),n);var o=y.IMARGUMENT(e);return y.COMPLEX(f*Math.cos(n*o),f*Math.sin(n*o),i)};y.IMPRODUCT=function(){var e=arguments[0];if(!arguments.length)return r.value;for(var n=1;n<arguments.length;n++){var a=y.IMREAL(e);var u=y.IMAGINARY(e);var i=y.IMREAL(arguments[n]);var f=y.IMAGINARY(arguments[n]);if(t.anyIsError(a,u,i,f))return r.value;e=y.COMPLEX(a*i-u*f,a*f+u*i)}return e};y.IMREAL=function(e){if(void 0===e||true===e||false===e)return r.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;e+="";var n=e.indexOf("+");var t=e.indexOf("-");0===n&&(n=e.indexOf("+",1));0===t&&(t=e.indexOf("-",1));var a=e.substring(e.length-1,e.length);var u="i"===a||"j"===a;return n>=0||t>=0?u?n>=0?isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?r.num:Number(e.substring(0,n)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?r.num:Number(e.substring(0,t)):r.num:u?isNaN(e.substring(0,e.length-1))?r.num:0:isNaN(e)?r.num:e};y.IMSEC=function(e){if(true===e||false===e)return r.value;var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.value:y.IMDIV("1",y.IMCOS(e))};y.IMSECH=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.value:y.IMDIV("1",y.IMCOSH(e))};y.IMSIN=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return y.COMPLEX(Math.sin(n)*(Math.exp(a)+Math.exp(-a))/2,Math.cos(n)*(Math.exp(a)-Math.exp(-a))/2,u)};y.IMSINH=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";return y.COMPLEX(Math.cos(a)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(a)*(Math.exp(n)+Math.exp(-n))/2,u)};y.IMSQRT=function(e){var n=y.IMREAL(e);var a=y.IMAGINARY(e);if(t.anyIsError(n,a))return r.value;var u=e.substring(e.length-1);u="i"===u||"j"===u?u:"i";var i=Math.sqrt(y.IMABS(e));var f=y.IMARGUMENT(e);return y.COMPLEX(i*Math.cos(f/2),i*Math.sin(f/2),u)};y.IMCSC=function(e){if(true===e||false===e)return r.value;var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.num:y.IMDIV("1",y.IMSIN(e))};y.IMCSCH=function(e){if(true===e||false===e)return r.value;var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.num:y.IMDIV("1",y.IMSINH(e))};y.IMSUB=function(e,n){var a=this.IMREAL(e);var u=this.IMAGINARY(e);var i=this.IMREAL(n);var f=this.IMAGINARY(n);if(t.anyIsError(a,u,i,f))return r.value;var o=e.substring(e.length-1);var s=n.substring(n.length-1);var l="i";("j"===o||"j"===s)&&(l="j");return this.COMPLEX(a-i,u-f,l)};y.IMSUM=function(){if(!arguments.length)return r.value;var e=t.flatten(arguments);var n=e[0];for(var a=1;a<e.length;a++){var u=this.IMREAL(n);var i=this.IMAGINARY(n);var f=this.IMREAL(e[a]);var o=this.IMAGINARY(e[a]);if(t.anyIsError(u,i,f,o))return r.value;n=this.COMPLEX(u+f,i+o)}return n};y.IMTAN=function(e){if(true===e||false===e)return r.value;var n=y.IMREAL(e);var a=y.IMAGINARY(e);return t.anyIsError(n,a)?r.value:this.IMDIV(this.IMSIN(e),this.IMCOS(e))};y.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return r.num;var a=10===e.length&&"7"===e.substring(0,1);var u=a?parseInt(e,8)-1073741824:parseInt(e,8);if(u<-512||u>511)return r.num;if(a)return"1"+n.REPT("0",9-(512+u).toString(2).length)+(512+u).toString(2);var i=u.toString(2);if("undefined"===typeof t)return i;if(isNaN(t))return r.value;if(t<0)return r.num;t=Math.floor(t);return t>=i.length?n.REPT("0",t-i.length)+i:r.num};y.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return r.num;var n=parseInt(e,8);return n>=536870912?n-1073741824:n};y.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return r.num;var a=parseInt(e,8);if(a>=536870912)return"ff"+(a+3221225472).toString(16);var u=a.toString(16);if(void 0===t)return u;if(isNaN(t))return r.value;if(t<0)return r.num;t=Math.floor(t);return t>=u.length?n.REPT("0",t-u.length)+u:r.num};return y}var d={},R=false;var D="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;function dew$6(){if(R)return d;R=true;var r=dew$f();var e=dew$e();var n=new Date(Date.UTC(1900,0,1));var t=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0];var a=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];var u=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];d.DATE=function(n,t,a){var u;n=e.parseNumber(n);t=e.parseNumber(t);a=e.parseNumber(a);if(e.anyIsError(n,t,a))u=r.value;else{u=new Date(n,t-1,a);u.getFullYear()<0&&(u=r.num)}return u};d.DATEDIF=function(r,n,t){t=t.toUpperCase();r=e.parseDate(r);n=e.parseDate(n);var a=r.getFullYear();var u=r.getMonth();var i=r.getDate();var f=n.getFullYear();var o=n.getMonth();var s=n.getDate();var l;switch(t){case"Y":l=Math.floor(d.YEARFRAC(r,n));break;case"D":l=d.DAYS(n,r);break;case"M":l=o-u+12*(f-a);s<i&&l--;break;case"MD":if(i<=s)l=s-i;else{if(0===o){r.setFullYear(f-1);r.setMonth(12)}else{r.setFullYear(f);r.setMonth(o-1)}l=d.DAYS(n,r)}break;case"YM":l=o-u+12*(f-a);s<i&&l--;l%=12;break;case"YD":o>u||o===u&&s<i?r.setFullYear(f):r.setFullYear(f-1);l=d.DAYS(n,r);break}return l};d.DATEVALUE=function(e){if("string"!==typeof e)return r.value;var n=Date.parse(e);return isNaN(n)?r.value:new Date(e)};d.DAY=function(r){var n=e.parseDate(r);return n instanceof Error?n:n.getDate()};function startOfDay(r){var e=new Date(r);e.setHours(0,0,0,0);return e}d.DAYS=function(r,n){r=e.parseDate(r);n=e.parseDate(n);return r instanceof Error?r:n instanceof Error?n:serial(startOfDay(r))-serial(startOfDay(n))};d.DAYS360=function(r,n,t){t=e.parseBool(t||"false");r=e.parseDate(r);n=e.parseDate(n);if(r instanceof Error)return r;if(n instanceof Error)return n;if(t instanceof Error)return t;var a=r.getMonth();var u=n.getMonth();var i,f;if(t){i=31===r.getDate()?30:r.getDate();f=31===n.getDate()?30:n.getDate()}else{var o=new Date(r.getFullYear(),a+1,0).getDate();var s=new Date(n.getFullYear(),u+1,0).getDate();i=r.getDate()===o?30:r.getDate();if(n.getDate()===s)if(i<30){u++;f=1}else f=30;else f=n.getDate()}return 360*(n.getFullYear()-r.getFullYear())+30*(u-a)+(f-i)};d.EDATE=function(n,t){n=e.parseDate(n);if(n instanceof Error)return n;if(isNaN(t))return r.value;t=parseInt(t,10);n.setMonth(n.getMonth()+t);return n};d.EOMONTH=function(n,t){n=e.parseDate(n);if(n instanceof Error)return n;if(isNaN(t))return r.value;t=parseInt(t,10);return new Date(n.getFullYear(),n.getMonth()+t+1,0)};d.HOUR=function(r){r=e.parseDate(r);return r instanceof Error?r:r.getHours()};d.INTERVAL=function(e){if("number"!==typeof e&&"string"!==typeof e)return r.value;e=parseInt(e,10);var n=Math.floor(e/94608e4);e%=94608e4;var t=Math.floor(e/2592e3);e%=2592e3;var a=Math.floor(e/86400);e%=86400;var u=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);e%=60;var f=e;n=n>0?n+"Y":"";t=t>0?t+"M":"";a=a>0?a+"D":"";u=u>0?u+"H":"";i=i>0?i+"M":"";f=f>0?f+"S":"";return"P"+n+t+a+"T"+u+i+f};d.ISOWEEKNUM=function(r){r=e.parseDate(r);if(r instanceof Error)return r;r=startOfDay(r);r.setDate(r.getDate()+4-(r.getDay()||7));var n=new Date(r.getFullYear(),0,1);return Math.ceil(((r-n)/864e5+1)/7)};d.MINUTE=function(r){r=e.parseDate(r);return r instanceof Error?r:r.getMinutes()};d.MONTH=function(r){r=e.parseDate(r);return r instanceof Error?r:r.getMonth()+1};d.NETWORKDAYS=function(r,e,n){return(this||D).NETWORKDAYS.INTL(r,e,1,n)};d.NETWORKDAYS.INTL=function(n,t,a,i){n=e.parseDate(n);if(n instanceof Error)return n;t=e.parseDate(t);if(t instanceof Error)return t;var f=false;var o=[];var s=[1,2,3,4,5,6,0];var l=new RegExp("^[0|1]{7}$");if(void 0===a)a=u[1];else if("string"===typeof a&&l.test(a)){f=true;a=a.split("");for(v=0;v<a.length;v++)"1"===a[v]&&o.push(s[v])}else a=u[a];if(!(a instanceof Array))return r.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var v=0;v<i.length;v++){var c=e.parseDate(i[v]);if(c instanceof Error)return c;i[v]=c}var E=Math.round((t-n)/864e5)+1;var p=E;var N=n;for(v=0;v<E;v++){var m=(new Date).getTimezoneOffset()>0?N.getUTCDay():N.getDay();var h=f?o.includes(m):m===a[0]||m===a[1];for(var I=0;I<i.length;I++){var g=i[I];if(g.getDate()===N.getDate()&&g.getMonth()===N.getMonth()&&g.getFullYear()===N.getFullYear()){h=true;break}}h&&p--;N.setDate(N.getDate()+1)}return p};d.NOW=function(){return new Date};d.SECOND=function(r){r=e.parseDate(r);return r instanceof Error?r:r.getSeconds()};d.TIME=function(n,t,a){n=e.parseNumber(n);t=e.parseNumber(t);a=e.parseNumber(a);return e.anyIsError(n,t,a)?r.value:n<0||t<0||a<0?r.num:(3600*n+60*t+a)/86400};d.TIMEVALUE=function(r){r=e.parseDate(r);return r instanceof Error?r:(3600*r.getHours()+60*r.getMinutes()+r.getSeconds())/86400};d.TODAY=function(){return startOfDay(new Date)};d.WEEKDAY=function(r,n){r=e.parseDate(r);if(r instanceof Error)return r;void 0===n&&(n=1);var t=r.getDay();return a[n][t]};d.WEEKNUM=function(r,n){r=e.parseDate(r);if(r instanceof Error)return r;void 0===n&&(n=1);if(21===n)return this.ISOWEEKNUM(r);var a=t[n];var u=new Date(r.getFullYear(),0,1);var i=u.getDay()<a?1:0;u-=24*Math.abs(u.getDay()-a)*60*60*1e3;return Math.floor((r-u)/864e5/7+1)+i};d.WORKDAY=function(r,e,n){return(this||D).WORKDAY.INTL(r,e,1,n)};d.WORKDAY.INTL=function(n,t,a,i){n=e.parseDate(n);if(n instanceof Error)return n;t=e.parseNumber(t);if(t instanceof Error)return t;if(t<0)return r.num;a=void 0===a?u[1]:u[a];if(!(a instanceof Array))return r.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var f=0;f<i.length;f++){var o=e.parseDate(i[f]);if(o instanceof Error)return o;i[f]=o}var s=0;while(s<t){n.setDate(n.getDate()+1);var l=n.getDay();if(l!==a[0]&&l!==a[1]){for(var v=0;v<i.length;v++){var c=i[v];if(c.getDate()===n.getDate()&&c.getMonth()===n.getMonth()&&c.getFullYear()===n.getFullYear()){s--;break}}s++}}return n};d.YEAR=function(r){r=e.parseDate(r);return r instanceof Error?r:r.getFullYear()};function isLeapYear(r){return 1===new Date(r,1,29).getMonth()}function daysBetween(r,e){return Math.ceil((e-r)/1e3/60/60/24)}d.YEARFRAC=function(r,n,t){r=e.parseDate(r);if(r instanceof Error)return r;n=e.parseDate(n);if(n instanceof Error)return n;t=t||0;var a=r.getDate();var u=r.getMonth()+1;var i=r.getFullYear();var f=n.getDate();var o=n.getMonth()+1;var s=n.getFullYear();switch(t){case 0:if(31===a&&31===f){a=30;f=30}else 31===a?a=30:30===a&&31===f&&(f=30);return(f+30*o+360*s-(a+30*u+360*i))/360;case 1:var feb29Between=function(r,e){var n=r.getFullYear();var t=new Date(n,2,1);if(isLeapYear(n)&&r<t&&e>=t)return true;var a=e.getFullYear();var u=new Date(a,2,1);return isLeapYear(a)&&e>=u&&r<u};var l=365;if(i===s||i+1===s&&(u>o||u===o&&a>=f)){(i===s&&isLeapYear(i)||feb29Between(r,n)||1===o&&29===f)&&(l=366);return daysBetween(r,n)/l}var v=s-i+1;var c=(new Date(s+1,0,1)-new Date(i,0,1))/1e3/60/60/24;var E=c/v;return daysBetween(r,n)/E;case 2:return daysBetween(r,n)/360;case 3:return daysBetween(r,n)/365;case 4:return(f+30*o+360*s-(a+30*u+360*i))/360}};function serial(r){var e=r>-22038912e5?2:1;return Math.ceil((r-n)/864e5)+e}return d}var S={},O=false;function dew$5(){if(O)return S;O=true;var r=dew$8();var e=dew$a();var n=dew$7();var t=dew$6();function set(r,e){if(e)for(var n in e)r[n]=e[n];return r}S.BETADIST=e.BETA.DIST;S.BETAINV=e.BETA.INV;S.BINOMDIST=e.BINOM.DIST;S.CEILING=S.ISOCEILING=set(r.CEILING.MATH,r.CEILING);S.CEILINGMATH=r.CEILING.MATH;S.CEILINGPRECISE=r.CEILING.PRECISE;S.CHIDIST=e.CHISQ.DIST;S.CHIDISTRT=e.CHISQ.DIST.RT;S.CHIINV=e.CHISQ.INV;S.CHIINVRT=e.CHISQ.INV.RT;S.CHITEST=e.CHISQ.TEST;S.CONFIDENCE=set(e.CONFIDENCE.NORM,e.CONFIDENCE);S.COVAR=e.COVARIANCE.P;S.COVARIANCEP=e.COVARIANCE.P;S.COVARIANCES=e.COVARIANCE.S;S.CRITBINOM=e.BINOM.INV;S.EXPONDIST=e.EXPON.DIST;S.ERFCPRECISE=n.ERFC.PRECISE;S.ERFPRECISE=n.ERF.PRECISE;S.FDIST=e.F.DIST;S.FDISTRT=e.F.DIST.RT;S.FINVRT=e.F.INV.RT;S.FINV=e.F.INV;S.FLOOR=set(r.FLOOR.MATH,r.FLOOR);S.FLOORMATH=r.FLOOR.MATH;S.FLOORPRECISE=r.FLOOR.PRECISE;S.FTEST=e.F.TEST;S.GAMMADIST=e.GAMMA.DIST;S.GAMMAINV=e.GAMMA.INV;S.GAMMALNPRECISE=e.GAMMALN.PRECISE;S.HYPGEOMDIST=e.HYPGEOM.DIST;S.LOGINV=e.LOGNORM.INV;S.LOGNORMINV=e.LOGNORM.INV;S.LOGNORMDIST=e.LOGNORM.DIST;S.MODE=set(e.MODE.SNGL,e.MODE);S.MODEMULT=e.MODE.MULT;S.MODESNGL=e.MODE.SNGL;S.NEGBINOMDIST=e.NEGBINOM.DIST;S.NETWORKDAYSINTL=t.NETWORKDAYS.INTL;S.NORMDIST=e.NORM.DIST;S.NORMINV=e.NORM.INV;S.NORMSDIST=e.NORM.S.DIST;S.NORMSINV=e.NORM.S.INV;S.PERCENTILE=set(e.PERCENTILE.EXC,e.PERCENTILE);S.PERCENTILEEXC=e.PERCENTILE.EXC;S.PERCENTILEINC=e.PERCENTILE.INC;S.PERCENTRANK=set(e.PERCENTRANK.INC,e.PERCENTRANK);S.PERCENTRANKEXC=e.PERCENTRANK.EXC;S.PERCENTRANKINC=e.PERCENTRANK.INC;S.POISSON=set(e.POISSON.DIST,e.POISSON);S.POISSONDIST=e.POISSON.DIST;S.QUARTILE=set(e.QUARTILE.INC,e.QUARTILE);S.QUARTILEEXC=e.QUARTILE.EXC;S.QUARTILEINC=e.QUARTILE.INC;S.RANK=set(e.RANK.EQ,e.RANK);S.RANKAVG=e.RANK.AVG;S.RANKEQ=e.RANK.EQ;S.SKEWP=e.SKEW.P;S.STDEV=set(e.STDEV.S,e.STDEV);S.STDEVP=e.STDEV.P;S.STDEVS=e.STDEV.S;S.TDIST=e.T.DIST;S.TDISTRT=e.T.DIST.RT;S.TINV=e.T.INV;S.TTEST=e.T.TEST;S.VAR=set(e.VAR.S,e.VAR);S.VARP=e.VAR.P;S.VARS=e.VAR.S;S.WEIBULL=set(e.WEIBULL.DIST,e.WEIBULL);S.WEIBULLDIST=e.WEIBULL.DIST;S.WORKDAYINTL=t.WORKDAY.INTL;S.ZTEST=e.Z.TEST;return S}var C={},w=false;function dew$4(){if(w)return C;w=true;var r=dew$f();var e=dew$a();var n=dew$8();var t=dew$e();var a=dew$c();function compact(r){var e=[];t.arrayEach(r,(function(r){r&&e.push(r)}));return e}C.FINDFIELD=function(e,n){var a=null;t.arrayEach(e,(function(r,e){if(r[0]===n){a=e;return false}}));return null==a?r.value:a};function findResultIndex(r,e){var n={};for(var t=1;t<r[0].length;++t)n[t]=true;var u=e[0].length;for(t=1;t<e.length;++t)e[t].length>u&&(u=e[t].length);for(var i=1;i<r.length;++i)for(var f=1;f<r[i].length;++f){var o=false;var s=false;for(var l=0;l<e.length;++l){var v=e[l];if(!(v.length<u)){var c=v[0];if(r[i][0]===c){s=true;for(var E=1;E<v.length;++E)if(!o){var p=void 0===v[E]||"*"===v[E];if(p)o=true;else{var N=a.parse(v[E]+"");var m=[a.createToken(r[i][f],a.TOKEN_TYPE_LITERAL)].concat(N);o=a.compute(m)}}}}}s&&(n[f]=n[f]&&o)}var h=[];for(var I=0;I<r[0].length;++I)n[I]&&h.push(I-1);return h}C.DAVERAGE=function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;var u=findResultIndex(e,a);var i=[];if("string"===typeof n){var f=C.FINDFIELD(e,n);i=t.rest(e[f])}else i=t.rest(e[n]);var o=0;t.arrayEach(u,(function(r){o+=i[r]}));return 0===u.length?r.div0:o/u.length};C.DCOUNT=function(n,a,u){if(isNaN(a)&&"string"!==typeof a)return r.value;var i=findResultIndex(n,u);var f=[];if("string"===typeof a){var o=C.FINDFIELD(n,a);f=t.rest(n[o])}else f=t.rest(n[a]);var s=[];t.arrayEach(i,(function(r){s.push(f[r])}));return e.COUNT(s)};C.DCOUNTA=function(n,a,u){if(isNaN(a)&&"string"!==typeof a)return r.value;var i=findResultIndex(n,u);var f=[];if("string"===typeof a){var o=C.FINDFIELD(n,a);f=t.rest(n[o])}else f=t.rest(n[a]);var s=[];t.arrayEach(i,(function(r){s.push(f[r])}));return e.COUNTA(s)};C.DGET=function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;var u=findResultIndex(e,a);var i=[];if("string"===typeof n){var f=C.FINDFIELD(e,n);i=t.rest(e[f])}else i=t.rest(e[n]);return 0===u.length?r.value:u.length>1?r.num:i[u[0]]};C.DMAX=function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;var u=findResultIndex(e,a);var i=[];if("string"===typeof n){var f=C.FINDFIELD(e,n);i=t.rest(e[f])}else i=t.rest(e[n]);var o=i[u[0]];t.arrayEach(u,(function(r){o<i[r]&&(o=i[r])}));return o};C.DMIN=function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;var u=findResultIndex(e,a);var i=[];if("string"===typeof n){var f=C.FINDFIELD(e,n);i=t.rest(e[f])}else i=t.rest(e[n]);var o=i[u[0]];t.arrayEach(u,(function(r){o>i[r]&&(o=i[r])}));return o};C.DPRODUCT=function(e,n,a){if(isNaN(n)&&"string"!==typeof n)return r.value;var u=findResultIndex(e,a);var i=[];if("string"===typeof n){var f=C.FINDFIELD(e,n);i=t.rest(e[f])}else i=t.rest(e[n]);var o=[];t.arrayEach(u,(function(r){o.push(i[r])}));o=compact(o);var s=1;t.arrayEach(o,(function(r){s*=r}));return s};C.DSTDEV=function(n,a,u){if(isNaN(a)&&"string"!==typeof a)return r.value;var i=findResultIndex(n,u);var f=[];if("string"===typeof a){var o=C.FINDFIELD(n,a);f=t.rest(n[o])}else f=t.rest(n[a]);var s=[];t.arrayEach(i,(function(r){s.push(f[r])}));s=compact(s);return e.STDEV.S(s)};C.DSTDEVP=function(n,a,u){if(isNaN(a)&&"string"!==typeof a)return r.value;var i=findResultIndex(n,u);var f=[];if("string"===typeof a){var o=C.FINDFIELD(n,a);f=t.rest(n[o])}else f=t.rest(n[a]);var s=[];t.arrayEach(i,(function(r){s.push(f[r])}));s=compact(s);return e.STDEV.P(s)};C.DSUM=function(e,a,u){if(isNaN(a)&&"string"!==typeof a)return r.value;var i=findResultIndex(e,u);var f=[];if("string"===typeof a){var o=C.FINDFIELD(e,a);f=t.rest(e[o])}else f=t.rest(e[a]);var s=[];t.arrayEach(i,(function(r){s.push(f[r])}));return n.SUM(s)};C.DVAR=function(n,a,u){if(isNaN(a)&&"string"!==typeof a)return r.value;var i=findResultIndex(n,u);var f=[];if("string"===typeof a){var o=C.FINDFIELD(n,a);f=t.rest(n[o])}else f=t.rest(n[a]);var s=[];t.arrayEach(i,(function(r){s.push(f[r])}));return e.VAR.S(s)};C.DVARP=function(n,a,u){if(isNaN(a)&&"string"!==typeof a)return r.value;var i=findResultIndex(n,u);var f=[];if("string"===typeof a){var o=C.FINDFIELD(n,a);f=t.rest(n[o])}else f=t.rest(n[a]);var s=[];t.arrayEach(i,(function(r){s.push(f[r])}));return e.VAR.P(s)};return C}var L={},P=false;function dew$3(){if(P)return L;P=true;var r=dew$f();var e=dew$e();var n=dew$9();L.AND=function(){var n=e.flatten(arguments);var t=r.value;for(var a=0;a<n.length;a++){if(n[a]instanceof Error)return n[a];if(void 0!==n[a]&&null!==n[a]&&"string"!==typeof n[a]){t===r.value&&(t=true);n[a]||(t=false)}}return t};L.CHOOSE=function(){if(arguments.length<2)return r.na;var e=arguments[0];return e<1||e>254||arguments.length<e+1?r.value:arguments[e]};L.FALSE=function(){return false};L.IF=function(r,e,n){if(r instanceof Error)return r;e=!(arguments.length>=2)||e;void 0!==e&&null!==e||(e=0);n=3===arguments.length&&n;void 0!==n&&null!==n||(n=0);return r?e:n};L.IFS=function(){for(var e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return r.na};L.IFERROR=function(r,e){return n.ISERROR(r)?e:r};L.IFNA=function(e,n){return e===r.na?n:e};L.NOT=function(e){return"string"===typeof e?r.value:e instanceof Error?e:!e};L.OR=function(){var n=e.flatten(arguments);var t=r.value;for(var a=0;a<n.length;a++){if(n[a]instanceof Error)return n[a];if(void 0!==n[a]&&null!==n[a]&&"string"!==typeof n[a]){t===r.value&&(t=false);n[a]&&(t=true)}}return t};L.TRUE=function(){return true};L.XOR=function(){var n=e.flatten(arguments);var t=r.value;for(var a=0;a<n.length;a++){if(n[a]instanceof Error)return n[a];if(void 0!==n[a]&&null!==n[a]&&"string"!==typeof n[a]){t===r.value&&(t=0);n[a]&&t++}}return t===r.value?t:!!(1&Math.floor(Math.abs(t)))};L.SWITCH=function(){var e;if(arguments.length>0){var n=arguments[0];var t=arguments.length-1;var a=Math.floor(t/2);var u=false;var i=t%2!==0;var f=t%2===0?null:arguments[arguments.length-1];if(a)for(var o=0;o<a;o++)if(n===arguments[2*o+1]){e=arguments[2*o+2];u=true;break}u||(e=i?f:r.na)}else e=r.value;return e};return L}var F={},U=false;function dew$2(){if(U)return F;U=true;var r=dew$f();var e=dew$6();var n=dew$e();function validDate(r){return r&&r.getTime&&!isNaN(r.getTime())}function ensureDate(r){return r instanceof Date?r:new Date(r)}F.ACCRINT=function(n,t,a,u,i,f,o){n=ensureDate(n);t=ensureDate(t);a=ensureDate(a);if(!validDate(n)||!validDate(t)||!validDate(a))return r.value;if(u<=0||i<=0)return r.num;if(-1===[1,2,4].indexOf(f))return r.num;if(-1===[0,1,2,3,4].indexOf(o))return r.num;if(a<=n)return r.num;i=i||0;o=o||0;return i*u*e.YEARFRAC(n,a,o)};F.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")};F.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")};F.AMORLINC=function(){throw new Error("AMORLINC is not implemented")};F.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")};F.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")};F.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")};F.COUPNCD=function(){throw new Error("COUPNCD is not implemented")};F.COUPNUM=function(){throw new Error("COUPNUM is not implemented")};F.COUPPCD=function(){throw new Error("COUPPCD is not implemented")};F.CUMIPMT=function(e,t,a,u,i,f){e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);if(n.anyIsError(e,t,a))return r.value;if(e<=0||t<=0||a<=0)return r.num;if(u<1||i<1||u>i)return r.num;if(0!==f&&1!==f)return r.num;var o=F.PMT(e,t,a,0,f);var s=0;if(1===u){0===f&&(s=-a);u++}for(var l=u;l<=i;l++)s+=1===f?F.FV(e,l-2,o,a,1)-o:F.FV(e,l-1,o,a,0);s*=e;return s};F.CUMPRINC=function(e,t,a,u,i,f){e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);if(n.anyIsError(e,t,a))return r.value;if(e<=0||t<=0||a<=0)return r.num;if(u<1||i<1||u>i)return r.num;if(0!==f&&1!==f)return r.num;var o=F.PMT(e,t,a,0,f);var s=0;if(1===u){s=0===f?o+a*e:o;u++}for(var l=u;l<=i;l++)s+=f>0?o-(F.FV(e,l-2,o,a,1)-o)*e:o-F.FV(e,l-1,o,a,0)*e;return s};F.DB=function(e,t,a,u,i){i=void 0===i?12:i;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);if(n.anyIsError(e,t,a,u,i))return r.value;if(e<0||t<0||a<0||u<0)return r.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i))return r.num;if(u>a)return r.num;if(t>=e)return 0;var f=(1-Math.pow(t/e,1/a)).toFixed(3);var o=e*f*i/12;var s=o;var l=0;var v=u===a?a-1:u;for(var c=2;c<=v;c++){l=(e-s)*f;s+=l}return 1===u?o:u===a?(e-s)*f:l};F.DDB=function(e,t,a,u,i){i=void 0===i?2:i;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);if(n.anyIsError(e,t,a,u,i))return r.value;if(e<0||t<0||a<0||u<0||i<=0)return r.num;if(u>a)return r.num;if(t>=e)return 0;var f=0;var o=0;for(var s=1;s<=u;s++){o=Math.min(i/a*(e-f),e-t-f);f+=o}return o};F.DISC=function(){throw new Error("DISC is not implemented")};F.DOLLARDE=function(e,t){e=n.parseNumber(e);t=n.parseNumber(t);if(n.anyIsError(e,t))return r.value;if(t<0)return r.num;if(t>=0&&t<1)return r.div0;t=parseInt(t,10);var a=parseInt(e,10);a+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var u=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);a=Math.round(a*u)/u;return a};F.DOLLARFR=function(e,t){e=n.parseNumber(e);t=n.parseNumber(t);if(n.anyIsError(e,t))return r.value;if(t<0)return r.num;if(t>=0&&t<1)return r.div0;t=parseInt(t,10);var a=parseInt(e,10);a+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t;return a};F.DURATION=function(){throw new Error("DURATION is not implemented")};F.EFFECT=function(e,t){e=n.parseNumber(e);t=n.parseNumber(t);if(n.anyIsError(e,t))return r.value;if(e<=0||t<1)return r.num;t=parseInt(t,10);return Math.pow(1+e/t,t)-1};F.FV=function(e,t,a,u,i){u=u||0;i=i||0;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);if(n.anyIsError(e,t,a,u,i))return r.value;var f;if(0===e)f=u+a*t;else{var o=Math.pow(1+e,t);f=1===i?u*o+a*(1+e)*(o-1)/e:u*o+a*(o-1)/e}return-f};F.FVSCHEDULE=function(e,t){e=n.parseNumber(e);t=n.parseNumberArray(n.flatten(t));if(n.anyIsError(e,t))return r.value;var a=t.length;var u=e;for(var i=0;i<a;i++)u*=1+t[i];return u};F.INTRATE=function(){throw new Error("INTRATE is not implemented")};F.IPMT=function(e,t,a,u,i,f){i=i||0;f=f||0;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);f=n.parseNumber(f);if(n.anyIsError(e,t,a,u,i,f))return r.value;var o=F.PMT(e,a,u,i,f);var s;s=1===t?1===f?0:-u:1===f?F.FV(e,t-2,o,u,1)-o:F.FV(e,t-1,o,u,0);return s*e};F.IRR=function(e,t){t=t||0;e=n.parseNumberArray(n.flatten(e));t=n.parseNumber(t);if(n.anyIsError(e,t))return r.value;var irrResult=function(r,e,n){var t=n+1;var a=r[0];for(var u=1;u<r.length;u++)a+=r[u]/Math.pow(t,(e[u]-e[0])/365);return a};var irrResultDeriv=function(r,e,n){var t=n+1;var a=0;for(var u=1;u<r.length;u++){var i=(e[u]-e[0])/365;a-=i*r[u]/Math.pow(t,i+1)}return a};var a=[];var u=false;var i=false;for(var f=0;f<e.length;f++){a[f]=0===f?0:a[f-1]+365;e[f]>0&&(u=true);e[f]<0&&(i=true)}if(!u||!i)return r.num;t=void 0===t?.1:t;var o=t;var s=1e-10;var l,v,c;var E=true;do{c=irrResult(e,a,o);l=o-c/irrResultDeriv(e,a,o);v=Math.abs(l-o);o=l;E=v>s&&Math.abs(c)>s}while(E);return o};F.ISPMT=function(e,t,a,u){e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);return n.anyIsError(e,t,a,u)?r.value:u*e*(t/a-1)};F.MDURATION=function(){throw new Error("MDURATION is not implemented")};F.MIRR=function(e,t,a){e=n.parseNumberArray(n.flatten(e));t=n.parseNumber(t);a=n.parseNumber(a);if(n.anyIsError(e,t,a))return r.value;var u=e.length;var i=[];var f=[];for(var o=0;o<u;o++)e[o]<0?i.push(e[o]):f.push(e[o]);var s=-F.NPV(a,f)*Math.pow(1+a,u-1);var l=F.NPV(t,i)*(1+t);return Math.pow(s/l,1/(u-1))-1};F.NOMINAL=function(e,t){e=n.parseNumber(e);t=n.parseNumber(t);if(n.anyIsError(e,t))return r.value;if(e<=0||t<1)return r.num;t=parseInt(t,10);return(Math.pow(e+1,1/t)-1)*t};F.NPER=function(e,t,a,u,i){i=void 0===i?0:i;u=void 0===u?0:u;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);if(n.anyIsError(e,t,a,u,i))return r.value;if(0===e)return-(a+u)/t;var f=t*(1+e*i)-u*e;var o=a*e+t*(1+e*i);return Math.log(f/o)/Math.log(1+e)};F.NPV=function(){var r=n.parseNumberArray(n.flatten(arguments));if(r instanceof Error)return r;var e=r[0];var t=0;for(var a=1;a<r.length;a++)t+=r[a]/Math.pow(1+e,a);return t};F.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")};F.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")};F.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")};F.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")};F.PDURATION=function(e,t,a){e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);return n.anyIsError(e,t,a)?r.value:e<=0?r.num:(Math.log(a)-Math.log(t))/Math.log(1+e)};F.PMT=function(e,t,a,u,i){u=u||0;i=i||0;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);if(n.anyIsError(e,t,a,u,i))return r.value;var f;if(0===e)f=(a+u)/t;else{var o=Math.pow(1+e,t);f=1===i?(u*e/(o-1)+a*e/(1-1/o))/(1+e):u*e/(o-1)+a*e/(1-1/o)}return-f};F.PPMT=function(e,t,a,u,i,f){i=i||0;f=f||0;e=n.parseNumber(e);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);f=n.parseNumber(f);return n.anyIsError(e,a,u,i,f)?r.value:F.PMT(e,a,u,i,f)-F.IPMT(e,t,a,u,i,f)};F.PRICE=function(){throw new Error("PRICE is not implemented")};F.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")};F.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")};F.PV=function(e,t,a,u,i){u=u||0;i=i||0;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);return n.anyIsError(e,t,a,u,i)?r.value:0===e?-a*t-u:((1-Math.pow(1+e,t))/e*a*(1+e*i)-u)/Math.pow(1+e,t)};F.RATE=function(e,t,a,u,i,f){f=void 0===f?.01:f;u=void 0===u?0:u;i=void 0===i?0:i;e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);i=n.parseNumber(i);f=n.parseNumber(f);if(n.anyIsError(e,t,a,u,i,f))return r.value;var o=1e-10;var s=20;var l=f;i=i?1:0;for(var v=0;v<s;v++){if(l<=-1)return r.num;var c,E;if(Math.abs(l)<o)c=a*(1+e*l)+t*(1+l*i)*e+u;else{E=Math.pow(1+l,e);c=a*E+t*(1/l+i)*(E-1)+u}if(Math.abs(c)<o)return l;var p;if(Math.abs(l)<o)p=a*e+t*i*e;else{E=Math.pow(1+l,e);var N=e*Math.pow(1+l,e-1);p=a*N+t*(1/l+i)*N+t*(-1/(l*l))*(E-1)}l-=c/p}return l};F.RECEIVED=function(){throw new Error("RECEIVED is not implemented")};F.RRI=function(e,t,a){e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);return n.anyIsError(e,t,a)?r.value:0===e||0===t?r.num:Math.pow(a/t,1/e)-1};F.SLN=function(e,t,a){e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);return n.anyIsError(e,t,a)?r.value:0===a?r.num:(e-t)/a};F.SYD=function(e,t,a,u){e=n.parseNumber(e);t=n.parseNumber(t);a=n.parseNumber(a);u=n.parseNumber(u);if(n.anyIsError(e,t,a,u))return r.value;if(0===a)return r.num;if(u<1||u>a)return r.num;u=parseInt(u,10);return(e-t)*(a-u+1)*2/(a*(a+1))};F.TBILLEQ=function(t,a,u){t=n.parseDate(t);a=n.parseDate(a);u=n.parseNumber(u);return n.anyIsError(t,a,u)?r.value:u<=0||t>a||a-t>31536e6?r.num:365*u/(360-u*e.DAYS360(t,a,false))};F.TBILLPRICE=function(t,a,u){t=n.parseDate(t);a=n.parseDate(a);u=n.parseNumber(u);return n.anyIsError(t,a,u)?r.value:u<=0||t>a||a-t>31536e6?r.num:100*(1-u*e.DAYS360(t,a,false)/360)};F.TBILLYIELD=function(t,a,u){t=n.parseDate(t);a=n.parseDate(a);u=n.parseNumber(u);return n.anyIsError(t,a,u)?r.value:u<=0||t>a||a-t>31536e6?r.num:360*(100-u)/(u*e.DAYS360(t,a,false))};F.VDB=function(){throw new Error("VDB is not implemented")};F.XIRR=function(t,a,u){t=n.parseNumberArray(n.flatten(t));a=n.parseDateArray(n.flatten(a));u=n.parseNumber(u);if(n.anyIsError(t,a,u))return r.value;var irrResult=function(r,n,t){var a=t+1;var u=r[0];for(var i=1;i<r.length;i++)u+=r[i]/Math.pow(a,e.DAYS(n[i],n[0])/365);return u};var irrResultDeriv=function(r,n,t){var a=t+1;var u=0;for(var i=1;i<r.length;i++){var f=e.DAYS(n[i],n[0])/365;u-=f*r[i]/Math.pow(a,f+1)}return u};var i=false;var f=false;for(var o=0;o<t.length;o++){t[o]>0&&(i=true);t[o]<0&&(f=true)}if(!i||!f)return r.num;u=u||.1;var s=u;var l=1e-10;var v,c,E;var p=true;do{E=irrResult(t,a,s);v=s-E/irrResultDeriv(t,a,s);c=Math.abs(v-s);s=v;p=c>l&&Math.abs(E)>l}while(p);return s};F.XNPV=function(t,a,u){t=n.parseNumber(t);a=n.parseNumberArray(n.flatten(a));u=n.parseDateArray(n.flatten(u));if(n.anyIsError(t,a,u))return r.value;var i=0;for(var f=0;f<a.length;f++)i+=a[f]/Math.pow(1+t,e.DAYS(u[f],u[0])/365);return i};F.YIELD=function(){throw new Error("YIELD is not implemented")};F.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")};F.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")};return F}var V={},G=false;function dew$1(){if(G)return V;G=true;var r=dew$f();var e=dew$e();V.MATCH=function(n,t,a){if(!n&&!t)return r.na;2===arguments.length&&(a=1);if(!(t instanceof Array))return r.na;t=e.flatten(t);if(-1!==a&&0!==a&&1!==a)return r.na;var u;var i;for(var f=0;f<t.length;f++)if(1===a){if(t[f]===n)return f+1;if(t[f]<n)if(i){if(t[f]>i){u=f+1;i=t[f]}}else{u=f+1;i=t[f]}}else if(0===a){if("string"===typeof n){n=n.replace(/\?/g,".");if(t[f].toLowerCase().match(n.toLowerCase()))return f+1}else if(t[f]===n)return f+1}else if(-1===a){if(t[f]===n)return f+1;if(t[f]>n)if(i){if(t[f]<i){u=f+1;i=t[f]}}else{u=f+1;i=t[f]}}return u||r.na};V.VLOOKUP=function(e,n,t,a){if(!n||!t)return r.na;a=!(0===a||false===a);var u=r.na;var i="number"===typeof e;var f=false;for(var o=0;o<n.length;o++){var s=n[o];if(s[0]===e){u=t<s.length+1?s[t-1]:r.ref;break}!f&&(i&&a&&s[0]<=e||a&&"string"===typeof s[0]&&s[0].localeCompare(e)<0)&&(u=t<s.length+1?s[t-1]:r.ref);i&&s[0]>e&&(f=true)}return u};V.HLOOKUP=function(r,n,t,a){return V.VLOOKUP(r,e.transpose(n),t,a)};V.LOOKUP=function(n,t,a){t=e.flatten(t);a=e.flatten(a);var u="number"===typeof n;var i=r.na;for(var f=0;f<t.length;f++){if(t[f]===n)return a[f];if(u&&t[f]<=n||"string"===typeof t[f]&&t[f].localeCompare(n)<0)i=a[f];else if(u&&t[f]>n)return i}return i};V.INDEX=function(n,t,a){var u=e.anyError(n,t,a);if(u)return u;if(!Array.isArray(n))return r.value;var i=n.length>0&&!Array.isArray(n[0]);if(i&&!a){a=t;t=1}else{a=a||1;t=t||1}return a<0||t<0?r.value:i&&1===t&&a<=n.length?n[a-1]:t<=n.length&&a<=n[t-1].length?n[t-1][a-1]:r.ref};return V}var Y={},x=false;function dew(){if(x)return Y;x=true;var r=[dew$5(),dew$4(),dew$7(),dew$3(),dew$8(),dew$d(),dew$6(),dew$2(),dew$9(),dew$1(),dew$a(),dew$b()];for(var e in r){var n=r[e];for(var t in n)Y[t]=Y[t]||n[t]}Y.utils={errors:dew$f()};return Y}const B=dew();var X=B.utils;export{B as default,X as utils};

